8bb578c0fc729f83a5471beb17e8ccc6
"use strict";

/* istanbul ignore next */
function cov_ovr9nr576() {
  var path = "/Users/sachin/Documents/md-sports-/src/app/api/products/[id]/history/route.ts";
  var hash = "a65412145e69e781e8a37176eac932fc8249e17c";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/sachin/Documents/md-sports-/src/app/api/products/[id]/history/route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 19
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 38
        }
      },
      "4": {
        start: {
          line: 12,
          column: 30
        },
        end: {
          line: 12,
          column: 92
        }
      },
      "5": {
        start: {
          line: 14,
          column: 4
        },
        end: {
          line: 16,
          column: 6
        }
      },
      "6": {
        start: {
          line: 19,
          column: 4
        },
        end: {
          line: 260,
          column: 5
        }
      },
      "7": {
        start: {
          line: 20,
          column: 26
        },
        end: {
          line: 20,
          column: 45
        }
      },
      "8": {
        start: {
          line: 21,
          column: 8
        },
        end: {
          line: 28,
          column: 9
        }
      },
      "9": {
        start: {
          line: 22,
          column: 12
        },
        end: {
          line: 27,
          column: 15
        }
      },
      "10": {
        start: {
          line: 29,
          column: 33
        },
        end: {
          line: 29,
          column: 53
        }
      },
      "11": {
        start: {
          line: 30,
          column: 32
        },
        end: {
          line: 30,
          column: 62
        }
      },
      "12": {
        start: {
          line: 31,
          column: 31
        },
        end: {
          line: 31,
          column: 60
        }
      },
      "13": {
        start: {
          line: 32,
          column: 29
        },
        end: {
          line: 32,
          column: 56
        }
      },
      "14": {
        start: {
          line: 33,
          column: 33
        },
        end: {
          line: 33,
          column: 82
        }
      },
      "15": {
        start: {
          line: 34,
          column: 26
        },
        end: {
          line: 34,
          column: 74
        }
      },
      "16": {
        start: {
          line: 35,
          column: 24
        },
        end: {
          line: 35,
          column: 68
        }
      },
      "17": {
        start: {
          line: 37,
          column: 27
        },
        end: {
          line: 37,
          column: 29
        }
      },
      "18": {
        start: {
          line: 38,
          column: 8
        },
        end: {
          line: 38,
          column: 50
        }
      },
      "19": {
        start: {
          line: 38,
          column: 23
        },
        end: {
          line: 38,
          column: 50
        }
      },
      "20": {
        start: {
          line: 39,
          column: 8
        },
        end: {
          line: 44,
          column: 9
        }
      },
      "21": {
        start: {
          line: 41,
          column: 36
        },
        end: {
          line: 41,
          column: 53
        }
      },
      "22": {
        start: {
          line: 42,
          column: 12
        },
        end: {
          line: 42,
          column: 54
        }
      },
      "23": {
        start: {
          line: 43,
          column: 12
        },
        end: {
          line: 43,
          column: 45
        }
      },
      "24": {
        start: {
          line: 45,
          column: 26
        },
        end: {
          line: 45,
          column: 28
        }
      },
      "25": {
        start: {
          line: 47,
          column: 26
        },
        end: {
          line: 65,
          column: 10
        }
      },
      "26": {
        start: {
          line: 66,
          column: 8
        },
        end: {
          line: 83,
          column: 11
        }
      },
      "27": {
        start: {
          line: 67,
          column: 12
        },
        end: {
          line: 82,
          column: 15
        }
      },
      "28": {
        start: {
          line: 85,
          column: 22
        },
        end: {
          line: 104,
          column: 10
        }
      },
      "29": {
        start: {
          line: 105,
          column: 8
        },
        end: {
          line: 124,
          column: 11
        }
      },
      "30": {
        start: {
          line: 106,
          column: 12
        },
        end: {
          line: 123,
          column: 15
        }
      },
      "31": {
        start: {
          line: 126,
          column: 26
        },
        end: {
          line: 147,
          column: 10
        }
      },
      "32": {
        start: {
          line: 148,
          column: 8
        },
        end: {
          line: 184,
          column: 11
        }
      },
      "33": {
        start: {
          line: 151,
          column: 12
        },
        end: {
          line: 168,
          column: 15
        }
      },
      "34": {
        start: {
          line: 170,
          column: 12
        },
        end: {
          line: 183,
          column: 15
        }
      },
      "35": {
        start: {
          line: 186,
          column: 26
        },
        end: {
          line: 211,
          column: 10
        }
      },
      "36": {
        start: {
          line: 212,
          column: 8
        },
        end: {
          line: 241,
          column: 11
        }
      },
      "37": {
        start: {
          line: 213,
          column: 28
        },
        end: {
          line: 213,
          column: 35
        }
      },
      "38": {
        start: {
          line: 214,
          column: 35
        },
        end: {
          line: 214,
          column: 75
        }
      },
      "39": {
        start: {
          line: 215,
          column: 36
        },
        end: {
          line: 215,
          column: 45
        }
      },
      "40": {
        start: {
          line: 216,
          column: 32
        },
        end: {
          line: 216,
          column: 43
        }
      },
      "41": {
        start: {
          line: 218,
          column: 12
        },
        end: {
          line: 229,
          column: 13
        }
      },
      "42": {
        start: {
          line: 219,
          column: 16
        },
        end: {
          line: 219,
          column: 45
        }
      },
      "43": {
        start: {
          line: 220,
          column: 32
        },
        end: {
          line: 220,
          column: 138
        }
      },
      "44": {
        start: {
          line: 220,
          column: 80
        },
        end: {
          line: 220,
          column: 126
        }
      },
      "45": {
        start: {
          line: 221,
          column: 16
        },
        end: {
          line: 221,
          column: 74
        }
      },
      "46": {
        start: {
          line: 222,
          column: 16
        },
        end: {
          line: 222,
          column: 44
        }
      },
      "47": {
        start: {
          line: 223,
          column: 19
        },
        end: {
          line: 229,
          column: 13
        }
      },
      "48": {
        start: {
          line: 224,
          column: 16
        },
        end: {
          line: 224,
          column: 42
        }
      },
      "49": {
        start: {
          line: 225,
          column: 35
        },
        end: {
          line: 225,
          column: 46
        }
      },
      "50": {
        start: {
          line: 226,
          column: 16
        },
        end: {
          line: 226,
          column: 61
        }
      },
      "51": {
        start: {
          line: 227,
          column: 16
        },
        end: {
          line: 227,
          column: 110
        }
      },
      "52": {
        start: {
          line: 228,
          column: 16
        },
        end: {
          line: 228,
          column: 43
        }
      },
      "53": {
        start: {
          line: 230,
          column: 12
        },
        end: {
          line: 240,
          column: 15
        }
      },
      "54": {
        start: {
          line: 243,
          column: 31
        },
        end: {
          line: 243,
          column: 137
        }
      },
      "55": {
        start: {
          line: 243,
          column: 87
        },
        end: {
          line: 243,
          column: 124
        }
      },
      "56": {
        start: {
          line: 245,
          column: 8
        },
        end: {
          line: 245,
          column: 83
        }
      },
      "57": {
        start: {
          line: 245,
          column: 36
        },
        end: {
          line: 245,
          column: 81
        }
      },
      "58": {
        start: {
          line: 246,
          column: 8
        },
        end: {
          line: 249,
          column: 11
        }
      },
      "59": {
        start: {
          line: 251,
          column: 8
        },
        end: {
          line: 251,
          column: 92
        }
      },
      "60": {
        start: {
          line: 252,
          column: 24
        },
        end: {
          line: 252,
          column: 92
        }
      },
      "61": {
        start: {
          line: 253,
          column: 8
        },
        end: {
          line: 259,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "_interop_require_default",
        decl: {
          start: {
            line: 13,
            column: 9
          },
          end: {
            line: 13,
            column: 33
          }
        },
        loc: {
          start: {
            line: 13,
            column: 39
          },
          end: {
            line: 17,
            column: 1
          }
        },
        line: 13
      },
      "2": {
        name: "GET",
        decl: {
          start: {
            line: 18,
            column: 15
          },
          end: {
            line: 18,
            column: 18
          }
        },
        loc: {
          start: {
            line: 18,
            column: 40
          },
          end: {
            line: 261,
            column: 1
          }
        },
        line: 18
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 66,
            column: 26
          },
          end: {
            line: 66,
            column: 27
          }
        },
        loc: {
          start: {
            line: 66,
            column: 34
          },
          end: {
            line: 83,
            column: 9
          }
        },
        line: 66
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 105,
            column: 22
          },
          end: {
            line: 105,
            column: 23
          }
        },
        loc: {
          start: {
            line: 105,
            column: 30
          },
          end: {
            line: 124,
            column: 9
          }
        },
        line: 105
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 148,
            column: 26
          },
          end: {
            line: 148,
            column: 27
          }
        },
        loc: {
          start: {
            line: 148,
            column: 34
          },
          end: {
            line: 184,
            column: 9
          }
        },
        line: 148
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 212,
            column: 26
          },
          end: {
            line: 212,
            column: 27
          }
        },
        loc: {
          start: {
            line: 212,
            column: 33
          },
          end: {
            line: 241,
            column: 9
          }
        },
        line: 212
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 220,
            column: 64
          },
          end: {
            line: 220,
            column: 65
          }
        },
        loc: {
          start: {
            line: 220,
            column: 80
          },
          end: {
            line: 220,
            column: 126
          }
        },
        line: 220
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 243,
            column: 78
          },
          end: {
            line: 243,
            column: 79
          }
        },
        loc: {
          start: {
            line: 243,
            column: 87
          },
          end: {
            line: 243,
            column: 124
          }
        },
        line: 243
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 245,
            column: 28
          },
          end: {
            line: 245,
            column: 29
          }
        },
        loc: {
          start: {
            line: 245,
            column: 36
          },
          end: {
            line: 245,
            column: 81
          }
        },
        line: 245
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 14,
            column: 11
          },
          end: {
            line: 16,
            column: 5
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 14,
            column: 35
          },
          end: {
            line: 14,
            column: 38
          }
        }, {
          start: {
            line: 14,
            column: 41
          },
          end: {
            line: 16,
            column: 5
          }
        }],
        line: 14
      },
      "1": {
        loc: {
          start: {
            line: 14,
            column: 11
          },
          end: {
            line: 14,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 14,
            column: 11
          },
          end: {
            line: 14,
            column: 14
          }
        }, {
          start: {
            line: 14,
            column: 18
          },
          end: {
            line: 14,
            column: 32
          }
        }],
        line: 14
      },
      "2": {
        loc: {
          start: {
            line: 21,
            column: 8
          },
          end: {
            line: 28,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 21,
            column: 8
          },
          end: {
            line: 28,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 21
      },
      "3": {
        loc: {
          start: {
            line: 33,
            column: 33
          },
          end: {
            line: 33,
            column: 82
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 33,
            column: 51
          },
          end: {
            line: 33,
            column: 77
          }
        }, {
          start: {
            line: 33,
            column: 80
          },
          end: {
            line: 33,
            column: 82
          }
        }],
        line: 33
      },
      "4": {
        loc: {
          start: {
            line: 34,
            column: 26
          },
          end: {
            line: 34,
            column: 74
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 34,
            column: 43
          },
          end: {
            line: 34,
            column: 67
          }
        }, {
          start: {
            line: 34,
            column: 70
          },
          end: {
            line: 34,
            column: 74
          }
        }],
        line: 34
      },
      "5": {
        loc: {
          start: {
            line: 35,
            column: 24
          },
          end: {
            line: 35,
            column: 68
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 35,
            column: 39
          },
          end: {
            line: 35,
            column: 61
          }
        }, {
          start: {
            line: 35,
            column: 64
          },
          end: {
            line: 35,
            column: 68
          }
        }],
        line: 35
      },
      "6": {
        loc: {
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 38,
            column: 50
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 38,
            column: 50
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 38
      },
      "7": {
        loc: {
          start: {
            line: 39,
            column: 8
          },
          end: {
            line: 44,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 39,
            column: 8
          },
          end: {
            line: 44,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 39
      },
      "8": {
        loc: {
          start: {
            line: 51,
            column: 31
          },
          end: {
            line: 51,
            column: 90
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 51,
            column: 68
          },
          end: {
            line: 51,
            column: 78
          }
        }, {
          start: {
            line: 51,
            column: 81
          },
          end: {
            line: 51,
            column: 90
          }
        }],
        line: 51
      },
      "9": {
        loc: {
          start: {
            line: 89,
            column: 31
          },
          end: {
            line: 89,
            column: 90
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 89,
            column: 68
          },
          end: {
            line: 89,
            column: 78
          }
        }, {
          start: {
            line: 89,
            column: 81
          },
          end: {
            line: 89,
            column: 90
          }
        }],
        line: 89
      },
      "10": {
        loc: {
          start: {
            line: 111,
            column: 24
          },
          end: {
            line: 111,
            column: 56
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 111,
            column: 24
          },
          end: {
            line: 111,
            column: 43
          }
        }, {
          start: {
            line: 111,
            column: 47
          },
          end: {
            line: 111,
            column: 56
          }
        }],
        line: 111
      },
      "11": {
        loc: {
          start: {
            line: 112,
            column: 26
          },
          end: {
            line: 112,
            column: 62
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 112,
            column: 26
          },
          end: {
            line: 112,
            column: 49
          }
        }, {
          start: {
            line: 112,
            column: 53
          },
          end: {
            line: 112,
            column: 62
          }
        }],
        line: 112
      },
      "12": {
        loc: {
          start: {
            line: 130,
            column: 31
          },
          end: {
            line: 130,
            column: 90
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 130,
            column: 68
          },
          end: {
            line: 130,
            column: 78
          }
        }, {
          start: {
            line: 130,
            column: 81
          },
          end: {
            line: 130,
            column: 90
          }
        }],
        line: 130
      },
      "13": {
        loc: {
          start: {
            line: 205,
            column: 27
          },
          end: {
            line: 205,
            column: 86
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 205,
            column: 64
          },
          end: {
            line: 205,
            column: 74
          }
        }, {
          start: {
            line: 205,
            column: 77
          },
          end: {
            line: 205,
            column: 86
          }
        }],
        line: 205
      },
      "14": {
        loc: {
          start: {
            line: 218,
            column: 12
          },
          end: {
            line: 229,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 218,
            column: 12
          },
          end: {
            line: 229,
            column: 13
          }
        }, {
          start: {
            line: 223,
            column: 19
          },
          end: {
            line: 229,
            column: 13
          }
        }],
        line: 218
      },
      "15": {
        loc: {
          start: {
            line: 218,
            column: 16
          },
          end: {
            line: 218,
            column: 106
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 218,
            column: 16
          },
          end: {
            line: 218,
            column: 47
          }
        }, {
          start: {
            line: 218,
            column: 51
          },
          end: {
            line: 218,
            column: 82
          }
        }, {
          start: {
            line: 218,
            column: 86
          },
          end: {
            line: 218,
            column: 106
          }
        }],
        line: 218
      },
      "16": {
        loc: {
          start: {
            line: 223,
            column: 19
          },
          end: {
            line: 229,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 223,
            column: 19
          },
          end: {
            line: 229,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 223
      },
      "17": {
        loc: {
          start: {
            line: 223,
            column: 23
          },
          end: {
            line: 223,
            column: 112
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 223,
            column: 23
          },
          end: {
            line: 223,
            column: 53
          }
        }, {
          start: {
            line: 223,
            column: 57
          },
          end: {
            line: 223,
            column: 88
          }
        }, {
          start: {
            line: 223,
            column: 92
          },
          end: {
            line: 223,
            column: 112
          }
        }],
        line: 223
      },
      "18": {
        loc: {
          start: {
            line: 226,
            column: 36
          },
          end: {
            line: 226,
            column: 60
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 226,
            column: 36
          },
          end: {
            line: 226,
            column: 55
          }
        }, {
          start: {
            line: 226,
            column: 59
          },
          end: {
            line: 226,
            column: 60
          }
        }],
        line: 226
      },
      "19": {
        loc: {
          start: {
            line: 235,
            column: 24
          },
          end: {
            line: 235,
            column: 56
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 235,
            column: 24
          },
          end: {
            line: 235,
            column: 43
          }
        }, {
          start: {
            line: 235,
            column: 47
          },
          end: {
            line: 235,
            column: 56
          }
        }],
        line: 235
      },
      "20": {
        loc: {
          start: {
            line: 236,
            column: 24
          },
          end: {
            line: 236,
            column: 47
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 236,
            column: 24
          },
          end: {
            line: 236,
            column: 34
          }
        }, {
          start: {
            line: 236,
            column: 38
          },
          end: {
            line: 236,
            column: 47
          }
        }],
        line: 236
      },
      "21": {
        loc: {
          start: {
            line: 243,
            column: 31
          },
          end: {
            line: 243,
            column: 137
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 243,
            column: 61
          },
          end: {
            line: 243,
            column: 125
          }
        }, {
          start: {
            line: 243,
            column: 128
          },
          end: {
            line: 243,
            column: 137
          }
        }],
        line: 243
      },
      "22": {
        loc: {
          start: {
            line: 252,
            column: 24
          },
          end: {
            line: 252,
            column: 92
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 252,
            column: 49
          },
          end: {
            line: 252,
            column: 62
          }
        }, {
          start: {
            line: 252,
            column: 65
          },
          end: {
            line: 252,
            column: 92
          }
        }],
        line: 252
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0],
      "15": [0, 0, 0],
      "16": [0, 0],
      "17": [0, 0, 0],
      "18": [0, 0],
      "19": [0, 0],
      "20": [0, 0],
      "21": [0, 0],
      "22": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/Users/sachin/Documents/md-sports-/src/app/api/products/[id]/history/route.ts"],
      sourcesContent: ["import { NextRequest, NextResponse } from 'next/server';\nimport prisma from '@/lib/prisma';\n\ninterface ProductHistoryEvent {\n    timestamp: Date;\n    type: string;\n    description: string;\n    quantityChange?: number;\n    shopId?: number;\n    shopName?: string;\n    userId?: number;\n    userName?: string;\n    relatedDocumentId?: string;\n    details?: any;\n}\n\nexport async function GET(\n    request: NextRequest,\n    { params }: { params: { id: string } }\n) {\n    try {\n        const productId = parseInt(params.id);\n        if (isNaN(productId)) {\n            return NextResponse.json({ success: false, message: 'Invalid product ID' }, { status: 400 });\n        }\n\n        const { searchParams } = new URL(request.url);\n        const eventTypesParam = searchParams.get('eventTypes');\n        const startDateParam = searchParams.get('startDate');\n        const endDateParam = searchParams.get('endDate');\n\n        const filterEventTypes = eventTypesParam ? eventTypesParam.split(',') : [];\n        const startDate = startDateParam ? new Date(startDateParam) : null;\n        const endDate = endDateParam ? new Date(endDateParam) : null;\n\n        // Construct date filter for Prisma\n        const dateFilter: any = {};\n        if (startDate) dateFilter.gte = startDate;\n        if (endDate) {\n            // Adjust endDate to include the whole day\n            const adjustedEndDate = new Date(endDate);\n            adjustedEndDate.setHours(23, 59, 59, 999);\n            dateFilter.lte = adjustedEndDate;\n        }\n\n        const allEvents: ProductHistoryEvent[] = [];\n\n        // 1. Fetch Purchases\n        const purchases = await prisma.purchaseInvoiceItem.findMany({\n            where: {\n                productId,\n                purchaseInvoice: {\n                    createdAt: Object.keys(dateFilter).length > 0 ? dateFilter : undefined\n                }\n            },\n            include: {\n                purchaseInvoice: { include: { supplier: true } },\n                product: true // To get product name if needed for description, though we have productId\n            },\n            orderBy: { createdAt: 'desc' }\n        });\n\n        purchases.forEach(item => {\n            allEvents.push({\n                timestamp: item.purchaseInvoice.createdAt, // Or item.createdAt if more specific\n                type: 'Purchase',\n                description: `Purchased ${item.quantity} units from ${item.purchaseInvoice.supplier.name}. Price: Rs. ${item.price.toFixed(2)} each.`,\n                quantityChange: item.quantity,\n                relatedDocumentId: `Purchase Invoice #${item.purchaseInvoice.invoiceNumber}`,\n                // shopId: item.purchaseInvoice.shopId, // If PurchaseInvoice has a shopId\n                // userName: // If PurchaseInvoice has a creator/userId\n                details: {\n                    supplier: item.purchaseInvoice.supplier.name,\n                    invoiceNumber: item.purchaseInvoice.invoiceNumber,\n                    quantity: item.quantity,\n                    price: item.price,\n                    total: item.total,\n                }\n            });\n        });\n\n        // 2. Fetch Sales\n        const sales = await prisma.invoiceItem.findMany({\n            where: {\n                productId,\n                invoice: {\n                    createdAt: Object.keys(dateFilter).length > 0 ? dateFilter : undefined\n                }\n            },\n            include: {\n                invoice: { include: { customer: true, shop: true } }, // Assuming Invoice has shop\n                product: true\n            },\n            orderBy: { createdAt: 'desc' }\n        });\n\n        sales.forEach(item => {\n            allEvents.push({\n                timestamp: item.invoice.createdAt, // Or item.createdAt\n                type: 'Sale',\n                description: `Sold ${item.quantity} units to ${item.invoice.customer.name}.Price: Rs.${item.price.toFixed(2)} each.`,\n                quantityChange: -item.quantity, // Negative for sale\n                shopId: item.invoice.shopId || undefined,\n                shopName: item.invoice.shop?.name || undefined,\n                relatedDocumentId: `Sales Invoice #${item.invoice.invoiceNumber}`,\n                // userName: item.invoice.userId // If Invoice has a creator/userId\n                details: {\n                    customer: item.invoice.customer.name,\n                    invoiceNumber: item.invoice.invoiceNumber,\n                    quantity: item.quantity,\n                    price: item.price,\n                    total: item.total,\n                    shop: item.invoice.shop?.name,\n                }\n            });\n        });\n\n        // 3. Fetch Transfers\n        const transfers = await prisma.transferItem.findMany({\n            where: {\n                productId,\n                transfer: {\n                    createdAt: Object.keys(dateFilter).length > 0 ? dateFilter : undefined\n                }\n            },\n            include: {\n                transfer: { include: { fromShop: true, toShop: true, fromUser: true, toUser: true } },\n                product: true\n            },\n            orderBy: { createdAt: 'desc' }\n        });\n\n        transfers.forEach(item => {\n            // Create two events for each transfer: one for 'out' and one for 'in'\n            // Transfer Out\n            allEvents.push({\n                timestamp: item.transfer.createdAt,\n                type: 'Transfer Out',\n                description: `Transferred ${item.quantity} units from ${item.transfer.fromShop.name} to ${item.transfer.toShop.name}.`,\n                quantityChange: -item.quantity,\n                shopId: item.transfer.fromShopId,\n                shopName: item.transfer.fromShop.name,\n                userId: item.transfer.fromUserId, // User initiating transfer\n                userName: item.transfer.fromUser.name,\n                relatedDocumentId: `Transfer ID #${item.transfer.id}`,\n                details: {\n                    fromShop: item.transfer.fromShop.name,\n                    toShop: item.transfer.toShop.name,\n                    quantity: item.quantity,\n                    status: item.transfer.status,\n                    notes: item.transfer.notes\n                }\n            });\n            // Transfer In\n            allEvents.push({\n                timestamp: item.transfer.createdAt, // Could be a slightly later time if transfer has receivedAt\n                type: 'Transfer In',\n                description: `Received ${item.quantity} units at ${item.transfer.toShop.name} from ${item.transfer.fromShop.name}.`,\n                quantityChange: item.quantity,\n                shopId: item.transfer.toShopId,\n                shopName: item.transfer.toShop.name,\n                userId: item.transfer.toUserId, // User receiving/confirming transfer\n                userName: item.transfer.toUser.name,\n                relatedDocumentId: `Transfer ID #${item.transfer.id}`,\n                details: { ...allEvents[allEvents.length - 1].details } // same details as out\n            });\n        });\n\n        // 4. Fetch Audit Logs (Product Updates and Stock Additions)\n        const auditLogs = await prisma.auditLog.findMany({\n            where: {\n                OR: [\n                    { entity: 'Product', entityId: productId, action: 'UPDATE_PRODUCT' },\n                    { entity: 'InventoryItem', details: { path: ['productId'], equals: productId }, action: 'ADD_INVENTORY' },\n                    // Add more specific audit actions if needed, e.g., for manual adjustments\n                ],\n                createdAt: Object.keys(dateFilter).length > 0 ? dateFilter : undefined\n            },\n            // include: { user: true }, // Temporarily removed due to missing explicit relation\n            orderBy: { createdAt: 'desc' }\n        });\n\n        auditLogs.forEach(log => {\n            let eventType = 'Audit';\n            let eventDescription = `Action: ${log.action} on ${log.entity}`;\n            let quantityChangeVal: number | undefined = undefined;\n            let detailsObject = log.details;\n            // let userNameVal: string | undefined = undefined; // Temporarily remove user name\n\n            if (log.action === 'UPDATE_PRODUCT' && typeof log.details === 'object' && log.details !== null) {\n                eventType = 'Product Update';\n                const changes = Object.entries(log.details as Record<string, { old: any, new: any }>)\n                    .map(([key, value]) => `  - ${key}: '${value.old}' -> '${value.new}'`)\n                    .join('\\n');\n                eventDescription = `Product details updated:\\n${changes}`;\n                detailsObject = log.details; // Already an object\n            } else if (log.action === 'ADD_INVENTORY' && typeof log.details === 'object' && log.details !== null) {\n                eventType = 'Stock Added';\n                const detailJson = log.details as any; // Already parsed by Prisma if jsonb\n                quantityChangeVal = detailJson.quantity || 0;\n                eventDescription = `Added ${quantityChangeVal} units directly. Shop ID: ${detailJson.shopId}`;\n                detailsObject = detailJson;\n            }\n\n            allEvents.push({\n                timestamp: log.createdAt,\n                type: eventType,\n                description: eventDescription,\n                quantityChange: quantityChangeVal,\n                shopId: (log.details as any)?.shopId || undefined,\n                userId: log.userId || undefined,\n                // userName: userNameVal, // Temporarily remove user name\n                relatedDocumentId: `Audit ID #${log.id}`,\n                details: detailsObject\n            });\n        });\n\n        // Filter by event types if provided\n        const filteredEvents = filterEventTypes.length > 0\n            ? allEvents.filter(event => filterEventTypes.includes(event.type))\n            : allEvents;\n\n        // Sort all collected events by timestamp in descending order\n        filteredEvents.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n\n        return NextResponse.json({ success: true, data: filteredEvents });\n\n    } catch (error) {\n        console.error(`Error fetching product history for product ID ${params.id}:`, error);\n        const message = error instanceof Error ? error.message : 'An unknown error occurred';\n        return NextResponse.json({ success: false, message: 'Failed to fetch product history', details: message }, { status: 500 });\n    }\n} "],
      names: ["GET", "request", "params", "productId", "parseInt", "id", "isNaN", "NextResponse", "json", "success", "message", "status", "searchParams", "URL", "url", "eventTypesParam", "get", "startDateParam", "endDateParam", "filterEventTypes", "split", "startDate", "Date", "endDate", "dateFilter", "gte", "adjustedEndDate", "setHours", "lte", "allEvents", "purchases", "prisma", "purchaseInvoiceItem", "findMany", "where", "purchaseInvoice", "createdAt", "Object", "keys", "length", "undefined", "include", "supplier", "product", "orderBy", "forEach", "item", "push", "timestamp", "type", "description", "quantity", "name", "price", "toFixed", "quantityChange", "relatedDocumentId", "invoiceNumber", "details", "total", "sales", "invoiceItem", "invoice", "customer", "shop", "shopId", "shopName", "transfers", "transferItem", "transfer", "fromShop", "toShop", "fromUser", "toUser", "fromShopId", "userId", "fromUserId", "userName", "notes", "toShopId", "toUserId", "auditLogs", "auditLog", "OR", "entity", "entityId", "action", "path", "equals", "log", "eventType", "eventDescription", "quantityChangeVal", "detailsObject", "changes", "entries", "map", "key", "value", "old", "new", "join", "detailJson", "filteredEvents", "filter", "event", "includes", "sort", "a", "b", "getTime", "data", "error", "console", "Error"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "a65412145e69e781e8a37176eac932fc8249e17c"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_ovr9nr576 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_ovr9nr576();
cov_ovr9nr576().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_ovr9nr576().s[1]++;
Object.defineProperty(exports, "GET", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_ovr9nr576().f[0]++;
    cov_ovr9nr576().s[2]++;
    return GET;
  }
});
const _server =
/* istanbul ignore next */
(cov_ovr9nr576().s[3]++, require("next/server"));
const _prisma =
/* istanbul ignore next */
(/*#__PURE__*/cov_ovr9nr576().s[4]++, _interop_require_default(require("../../../../../lib/prisma")));
function _interop_require_default(obj) {
  /* istanbul ignore next */
  cov_ovr9nr576().f[1]++;
  cov_ovr9nr576().s[5]++;
  return /* istanbul ignore next */(cov_ovr9nr576().b[1][0]++, obj) &&
  /* istanbul ignore next */
  (cov_ovr9nr576().b[1][1]++, obj.__esModule) ?
  /* istanbul ignore next */
  (cov_ovr9nr576().b[0][0]++, obj) :
  /* istanbul ignore next */
  (cov_ovr9nr576().b[0][1]++, {
    default: obj
  });
}
async function GET(request, {
  params
}) {
  /* istanbul ignore next */
  cov_ovr9nr576().f[2]++;
  cov_ovr9nr576().s[6]++;
  try {
    const productId =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[7]++, parseInt(params.id));
    /* istanbul ignore next */
    cov_ovr9nr576().s[8]++;
    if (isNaN(productId)) {
      /* istanbul ignore next */
      cov_ovr9nr576().b[2][0]++;
      cov_ovr9nr576().s[9]++;
      return _server.NextResponse.json({
        success: false,
        message: "Invalid product ID"
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_ovr9nr576().b[2][1]++;
    }
    const {
      searchParams
    } =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[10]++, new URL(request.url));
    const eventTypesParam =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[11]++, searchParams.get("eventTypes"));
    const startDateParam =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[12]++, searchParams.get("startDate"));
    const endDateParam =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[13]++, searchParams.get("endDate"));
    const filterEventTypes =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[14]++, eventTypesParam ?
    /* istanbul ignore next */
    (cov_ovr9nr576().b[3][0]++, eventTypesParam.split(",")) :
    /* istanbul ignore next */
    (cov_ovr9nr576().b[3][1]++, []));
    const startDate =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[15]++, startDateParam ?
    /* istanbul ignore next */
    (cov_ovr9nr576().b[4][0]++, new Date(startDateParam)) :
    /* istanbul ignore next */
    (cov_ovr9nr576().b[4][1]++, null));
    const endDate =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[16]++, endDateParam ?
    /* istanbul ignore next */
    (cov_ovr9nr576().b[5][0]++, new Date(endDateParam)) :
    /* istanbul ignore next */
    (cov_ovr9nr576().b[5][1]++, null));
    // Construct date filter for Prisma
    const dateFilter =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[17]++, {});
    /* istanbul ignore next */
    cov_ovr9nr576().s[18]++;
    if (startDate) {
      /* istanbul ignore next */
      cov_ovr9nr576().b[6][0]++;
      cov_ovr9nr576().s[19]++;
      dateFilter.gte = startDate;
    } else
    /* istanbul ignore next */
    {
      cov_ovr9nr576().b[6][1]++;
    }
    cov_ovr9nr576().s[20]++;
    if (endDate) {
      /* istanbul ignore next */
      cov_ovr9nr576().b[7][0]++;
      // Adjust endDate to include the whole day
      const adjustedEndDate =
      /* istanbul ignore next */
      (cov_ovr9nr576().s[21]++, new Date(endDate));
      /* istanbul ignore next */
      cov_ovr9nr576().s[22]++;
      adjustedEndDate.setHours(23, 59, 59, 999);
      /* istanbul ignore next */
      cov_ovr9nr576().s[23]++;
      dateFilter.lte = adjustedEndDate;
    } else
    /* istanbul ignore next */
    {
      cov_ovr9nr576().b[7][1]++;
    }
    const allEvents =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[24]++, []);
    // 1. Fetch Purchases
    const purchases =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[25]++, await _prisma.default.purchaseInvoiceItem.findMany({
      where: {
        productId,
        purchaseInvoice: {
          createdAt: Object.keys(dateFilter).length > 0 ?
          /* istanbul ignore next */
          (cov_ovr9nr576().b[8][0]++, dateFilter) :
          /* istanbul ignore next */
          (cov_ovr9nr576().b[8][1]++, undefined)
        }
      },
      include: {
        purchaseInvoice: {
          include: {
            supplier: true
          }
        },
        product: true // To get product name if needed for description, though we have productId
      },
      orderBy: {
        createdAt: "desc"
      }
    }));
    /* istanbul ignore next */
    cov_ovr9nr576().s[26]++;
    purchases.forEach(item => {
      /* istanbul ignore next */
      cov_ovr9nr576().f[3]++;
      cov_ovr9nr576().s[27]++;
      allEvents.push({
        timestamp: item.purchaseInvoice.createdAt,
        type: "Purchase",
        description: `Purchased ${item.quantity} units from ${item.purchaseInvoice.supplier.name}. Price: Rs. ${item.price.toFixed(2)} each.`,
        quantityChange: item.quantity,
        relatedDocumentId: `Purchase Invoice #${item.purchaseInvoice.invoiceNumber}`,
        // shopId: item.purchaseInvoice.shopId, // If PurchaseInvoice has a shopId
        // userName: // If PurchaseInvoice has a creator/userId
        details: {
          supplier: item.purchaseInvoice.supplier.name,
          invoiceNumber: item.purchaseInvoice.invoiceNumber,
          quantity: item.quantity,
          price: item.price,
          total: item.total
        }
      });
    });
    // 2. Fetch Sales
    const sales =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[28]++, await _prisma.default.invoiceItem.findMany({
      where: {
        productId,
        invoice: {
          createdAt: Object.keys(dateFilter).length > 0 ?
          /* istanbul ignore next */
          (cov_ovr9nr576().b[9][0]++, dateFilter) :
          /* istanbul ignore next */
          (cov_ovr9nr576().b[9][1]++, undefined)
        }
      },
      include: {
        invoice: {
          include: {
            customer: true,
            shop: true
          }
        },
        product: true
      },
      orderBy: {
        createdAt: "desc"
      }
    }));
    /* istanbul ignore next */
    cov_ovr9nr576().s[29]++;
    sales.forEach(item => {
      /* istanbul ignore next */
      cov_ovr9nr576().f[4]++;
      cov_ovr9nr576().s[30]++;
      allEvents.push({
        timestamp: item.invoice.createdAt,
        type: "Sale",
        description: `Sold ${item.quantity} units to ${item.invoice.customer.name}.Price: Rs.${item.price.toFixed(2)} each.`,
        quantityChange: -item.quantity,
        shopId:
        /* istanbul ignore next */
        (cov_ovr9nr576().b[10][0]++, item.invoice.shopId) ||
        /* istanbul ignore next */
        (cov_ovr9nr576().b[10][1]++, undefined),
        shopName:
        /* istanbul ignore next */
        (cov_ovr9nr576().b[11][0]++, item.invoice.shop?.name) ||
        /* istanbul ignore next */
        (cov_ovr9nr576().b[11][1]++, undefined),
        relatedDocumentId: `Sales Invoice #${item.invoice.invoiceNumber}`,
        // userName: item.invoice.userId // If Invoice has a creator/userId
        details: {
          customer: item.invoice.customer.name,
          invoiceNumber: item.invoice.invoiceNumber,
          quantity: item.quantity,
          price: item.price,
          total: item.total,
          shop: item.invoice.shop?.name
        }
      });
    });
    // 3. Fetch Transfers
    const transfers =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[31]++, await _prisma.default.transferItem.findMany({
      where: {
        productId,
        transfer: {
          createdAt: Object.keys(dateFilter).length > 0 ?
          /* istanbul ignore next */
          (cov_ovr9nr576().b[12][0]++, dateFilter) :
          /* istanbul ignore next */
          (cov_ovr9nr576().b[12][1]++, undefined)
        }
      },
      include: {
        transfer: {
          include: {
            fromShop: true,
            toShop: true,
            fromUser: true,
            toUser: true
          }
        },
        product: true
      },
      orderBy: {
        createdAt: "desc"
      }
    }));
    /* istanbul ignore next */
    cov_ovr9nr576().s[32]++;
    transfers.forEach(item => {
      /* istanbul ignore next */
      cov_ovr9nr576().f[5]++;
      cov_ovr9nr576().s[33]++;
      // Create two events for each transfer: one for 'out' and one for 'in'
      // Transfer Out
      allEvents.push({
        timestamp: item.transfer.createdAt,
        type: "Transfer Out",
        description: `Transferred ${item.quantity} units from ${item.transfer.fromShop.name} to ${item.transfer.toShop.name}.`,
        quantityChange: -item.quantity,
        shopId: item.transfer.fromShopId,
        shopName: item.transfer.fromShop.name,
        userId: item.transfer.fromUserId,
        userName: item.transfer.fromUser.name,
        relatedDocumentId: `Transfer ID #${item.transfer.id}`,
        details: {
          fromShop: item.transfer.fromShop.name,
          toShop: item.transfer.toShop.name,
          quantity: item.quantity,
          status: item.transfer.status,
          notes: item.transfer.notes
        }
      });
      // Transfer In
      /* istanbul ignore next */
      cov_ovr9nr576().s[34]++;
      allEvents.push({
        timestamp: item.transfer.createdAt,
        type: "Transfer In",
        description: `Received ${item.quantity} units at ${item.transfer.toShop.name} from ${item.transfer.fromShop.name}.`,
        quantityChange: item.quantity,
        shopId: item.transfer.toShopId,
        shopName: item.transfer.toShop.name,
        userId: item.transfer.toUserId,
        userName: item.transfer.toUser.name,
        relatedDocumentId: `Transfer ID #${item.transfer.id}`,
        details: {
          ...allEvents[allEvents.length - 1].details
        } // same details as out
      });
    });
    // 4. Fetch Audit Logs (Product Updates and Stock Additions)
    const auditLogs =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[35]++, await _prisma.default.auditLog.findMany({
      where: {
        OR: [{
          entity: "Product",
          entityId: productId,
          action: "UPDATE_PRODUCT"
        }, {
          entity: "InventoryItem",
          details: {
            path: ["productId"],
            equals: productId
          },
          action: "ADD_INVENTORY"
        }],
        createdAt: Object.keys(dateFilter).length > 0 ?
        /* istanbul ignore next */
        (cov_ovr9nr576().b[13][0]++, dateFilter) :
        /* istanbul ignore next */
        (cov_ovr9nr576().b[13][1]++, undefined)
      },
      // include: { user: true }, // Temporarily removed due to missing explicit relation
      orderBy: {
        createdAt: "desc"
      }
    }));
    /* istanbul ignore next */
    cov_ovr9nr576().s[36]++;
    auditLogs.forEach(log => {
      /* istanbul ignore next */
      cov_ovr9nr576().f[6]++;
      let eventType =
      /* istanbul ignore next */
      (cov_ovr9nr576().s[37]++, "Audit");
      let eventDescription =
      /* istanbul ignore next */
      (cov_ovr9nr576().s[38]++, `Action: ${log.action} on ${log.entity}`);
      let quantityChangeVal =
      /* istanbul ignore next */
      (cov_ovr9nr576().s[39]++, undefined);
      let detailsObject =
      /* istanbul ignore next */
      (cov_ovr9nr576().s[40]++, log.details);
      // let userNameVal: string | undefined = undefined; // Temporarily remove user name
      /* istanbul ignore next */
      cov_ovr9nr576().s[41]++;
      if (
      /* istanbul ignore next */
      (cov_ovr9nr576().b[15][0]++, log.action === "UPDATE_PRODUCT") &&
      /* istanbul ignore next */
      (cov_ovr9nr576().b[15][1]++, typeof log.details === "object") &&
      /* istanbul ignore next */
      (cov_ovr9nr576().b[15][2]++, log.details !== null)) {
        /* istanbul ignore next */
        cov_ovr9nr576().b[14][0]++;
        cov_ovr9nr576().s[42]++;
        eventType = "Product Update";
        const changes =
        /* istanbul ignore next */
        (cov_ovr9nr576().s[43]++, Object.entries(log.details).map(([key, value]) => {
          /* istanbul ignore next */
          cov_ovr9nr576().f[7]++;
          cov_ovr9nr576().s[44]++;
          return `  - ${key}: '${value.old}' -> '${value.new}'`;
        }).join("\n"));
        /* istanbul ignore next */
        cov_ovr9nr576().s[45]++;
        eventDescription = `Product details updated:\n${changes}`;
        /* istanbul ignore next */
        cov_ovr9nr576().s[46]++;
        detailsObject = log.details; // Already an object
      } else {
        /* istanbul ignore next */
        cov_ovr9nr576().b[14][1]++;
        cov_ovr9nr576().s[47]++;
        if (
        /* istanbul ignore next */
        (cov_ovr9nr576().b[17][0]++, log.action === "ADD_INVENTORY") &&
        /* istanbul ignore next */
        (cov_ovr9nr576().b[17][1]++, typeof log.details === "object") &&
        /* istanbul ignore next */
        (cov_ovr9nr576().b[17][2]++, log.details !== null)) {
          /* istanbul ignore next */
          cov_ovr9nr576().b[16][0]++;
          cov_ovr9nr576().s[48]++;
          eventType = "Stock Added";
          const detailJson =
          /* istanbul ignore next */
          (cov_ovr9nr576().s[49]++, log.details); // Already parsed by Prisma if jsonb
          /* istanbul ignore next */
          cov_ovr9nr576().s[50]++;
          quantityChangeVal =
          /* istanbul ignore next */
          (cov_ovr9nr576().b[18][0]++, detailJson.quantity) ||
          /* istanbul ignore next */
          (cov_ovr9nr576().b[18][1]++, 0);
          /* istanbul ignore next */
          cov_ovr9nr576().s[51]++;
          eventDescription = `Added ${quantityChangeVal} units directly. Shop ID: ${detailJson.shopId}`;
          /* istanbul ignore next */
          cov_ovr9nr576().s[52]++;
          detailsObject = detailJson;
        } else
        /* istanbul ignore next */
        {
          cov_ovr9nr576().b[16][1]++;
        }
      }
      /* istanbul ignore next */
      cov_ovr9nr576().s[53]++;
      allEvents.push({
        timestamp: log.createdAt,
        type: eventType,
        description: eventDescription,
        quantityChange: quantityChangeVal,
        shopId:
        /* istanbul ignore next */
        (cov_ovr9nr576().b[19][0]++, log.details?.shopId) ||
        /* istanbul ignore next */
        (cov_ovr9nr576().b[19][1]++, undefined),
        userId:
        /* istanbul ignore next */
        (cov_ovr9nr576().b[20][0]++, log.userId) ||
        /* istanbul ignore next */
        (cov_ovr9nr576().b[20][1]++, undefined),
        // userName: userNameVal, // Temporarily remove user name
        relatedDocumentId: `Audit ID #${log.id}`,
        details: detailsObject
      });
    });
    // Filter by event types if provided
    const filteredEvents =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[54]++, filterEventTypes.length > 0 ?
    /* istanbul ignore next */
    (cov_ovr9nr576().b[21][0]++, allEvents.filter(event => {
      /* istanbul ignore next */
      cov_ovr9nr576().f[8]++;
      cov_ovr9nr576().s[55]++;
      return filterEventTypes.includes(event.type);
    })) :
    /* istanbul ignore next */
    (cov_ovr9nr576().b[21][1]++, allEvents));
    // Sort all collected events by timestamp in descending order
    /* istanbul ignore next */
    cov_ovr9nr576().s[56]++;
    filteredEvents.sort((a, b) => {
      /* istanbul ignore next */
      cov_ovr9nr576().f[9]++;
      cov_ovr9nr576().s[57]++;
      return b.timestamp.getTime() - a.timestamp.getTime();
    });
    /* istanbul ignore next */
    cov_ovr9nr576().s[58]++;
    return _server.NextResponse.json({
      success: true,
      data: filteredEvents
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_ovr9nr576().s[59]++;
    console.error(`Error fetching product history for product ID ${params.id}:`, error);
    const message =
    /* istanbul ignore next */
    (cov_ovr9nr576().s[60]++, error instanceof Error ?
    /* istanbul ignore next */
    (cov_ovr9nr576().b[22][0]++, error.message) :
    /* istanbul ignore next */
    (cov_ovr9nr576().b[22][1]++, "An unknown error occurred"));
    /* istanbul ignore next */
    cov_ovr9nr576().s[61]++;
    return _server.NextResponse.json({
      success: false,
      message: "Failed to fetch product history",
      details: message
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJHRVQiLCJyZXF1ZXN0IiwicGFyYW1zIiwiY292X292cjlucjU3NiIsImYiLCJzIiwicHJvZHVjdElkIiwicGFyc2VJbnQiLCJpZCIsImlzTmFOIiwiYiIsIl9zZXJ2ZXIiLCJOZXh0UmVzcG9uc2UiLCJqc29uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJldmVudFR5cGVzUGFyYW0iLCJnZXQiLCJzdGFydERhdGVQYXJhbSIsImVuZERhdGVQYXJhbSIsImZpbHRlckV2ZW50VHlwZXMiLCJzcGxpdCIsInN0YXJ0RGF0ZSIsIkRhdGUiLCJlbmREYXRlIiwiZGF0ZUZpbHRlciIsImd0ZSIsImFkanVzdGVkRW5kRGF0ZSIsInNldEhvdXJzIiwibHRlIiwiYWxsRXZlbnRzIiwicHVyY2hhc2VzIiwiX3ByaXNtYSIsImRlZmF1bHQiLCJwdXJjaGFzZUludm9pY2VJdGVtIiwiZmluZE1hbnkiLCJ3aGVyZSIsInB1cmNoYXNlSW52b2ljZSIsImNyZWF0ZWRBdCIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJpbmNsdWRlIiwic3VwcGxpZXIiLCJwcm9kdWN0Iiwib3JkZXJCeSIsImZvckVhY2giLCJpdGVtIiwicHVzaCIsInRpbWVzdGFtcCIsInR5cGUiLCJkZXNjcmlwdGlvbiIsInF1YW50aXR5IiwibmFtZSIsInByaWNlIiwidG9GaXhlZCIsInF1YW50aXR5Q2hhbmdlIiwicmVsYXRlZERvY3VtZW50SWQiLCJpbnZvaWNlTnVtYmVyIiwiZGV0YWlscyIsInRvdGFsIiwic2FsZXMiLCJpbnZvaWNlSXRlbSIsImludm9pY2UiLCJjdXN0b21lciIsInNob3AiLCJzaG9wSWQiLCJzaG9wTmFtZSIsInRyYW5zZmVycyIsInRyYW5zZmVySXRlbSIsInRyYW5zZmVyIiwiZnJvbVNob3AiLCJ0b1Nob3AiLCJmcm9tVXNlciIsInRvVXNlciIsImZyb21TaG9wSWQiLCJ1c2VySWQiLCJmcm9tVXNlcklkIiwidXNlck5hbWUiLCJub3RlcyIsInRvU2hvcElkIiwidG9Vc2VySWQiLCJhdWRpdExvZ3MiLCJhdWRpdExvZyIsIk9SIiwiZW50aXR5IiwiZW50aXR5SWQiLCJhY3Rpb24iLCJwYXRoIiwiZXF1YWxzIiwibG9nIiwiZXZlbnRUeXBlIiwiZXZlbnREZXNjcmlwdGlvbiIsInF1YW50aXR5Q2hhbmdlVmFsIiwiZGV0YWlsc09iamVjdCIsImNoYW5nZXMiLCJlbnRyaWVzIiwibWFwIiwia2V5IiwidmFsdWUiLCJvbGQiLCJuZXciLCJqb2luIiwiZGV0YWlsSnNvbiIsImZpbHRlcmVkRXZlbnRzIiwiZmlsdGVyIiwiZXZlbnQiLCJpbmNsdWRlcyIsInNvcnQiLCJhIiwiZ2V0VGltZSIsImRhdGEiLCJlcnJvciIsImNvbnNvbGUiLCJFcnJvciJdLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vRG9jdW1lbnRzL21kLXNwb3J0cy0vc3JjL2FwcC9hcGkvcHJvZHVjdHMvW2lkXS9oaXN0b3J5L3JvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgcHJpc21hIGZyb20gJ0AvbGliL3ByaXNtYSc7XG5cbmludGVyZmFjZSBQcm9kdWN0SGlzdG9yeUV2ZW50IHtcbiAgICB0aW1lc3RhbXA6IERhdGU7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgcXVhbnRpdHlDaGFuZ2U/OiBudW1iZXI7XG4gICAgc2hvcElkPzogbnVtYmVyO1xuICAgIHNob3BOYW1lPzogc3RyaW5nO1xuICAgIHVzZXJJZD86IG51bWJlcjtcbiAgICB1c2VyTmFtZT86IHN0cmluZztcbiAgICByZWxhdGVkRG9jdW1lbnRJZD86IHN0cmluZztcbiAgICBkZXRhaWxzPzogYW55O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKFxuICAgIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICAgIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9XG4pIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwcm9kdWN0SWQgPSBwYXJzZUludChwYXJhbXMuaWQpO1xuICAgICAgICBpZiAoaXNOYU4ocHJvZHVjdElkKSkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdJbnZhbGlkIHByb2R1Y3QgSUQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICAgIGNvbnN0IGV2ZW50VHlwZXNQYXJhbSA9IHNlYXJjaFBhcmFtcy5nZXQoJ2V2ZW50VHlwZXMnKTtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlUGFyYW0gPSBzZWFyY2hQYXJhbXMuZ2V0KCdzdGFydERhdGUnKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZVBhcmFtID0gc2VhcmNoUGFyYW1zLmdldCgnZW5kRGF0ZScpO1xuXG4gICAgICAgIGNvbnN0IGZpbHRlckV2ZW50VHlwZXMgPSBldmVudFR5cGVzUGFyYW0gPyBldmVudFR5cGVzUGFyYW0uc3BsaXQoJywnKSA6IFtdO1xuICAgICAgICBjb25zdCBzdGFydERhdGUgPSBzdGFydERhdGVQYXJhbSA/IG5ldyBEYXRlKHN0YXJ0RGF0ZVBhcmFtKSA6IG51bGw7XG4gICAgICAgIGNvbnN0IGVuZERhdGUgPSBlbmREYXRlUGFyYW0gPyBuZXcgRGF0ZShlbmREYXRlUGFyYW0pIDogbnVsbDtcblxuICAgICAgICAvLyBDb25zdHJ1Y3QgZGF0ZSBmaWx0ZXIgZm9yIFByaXNtYVxuICAgICAgICBjb25zdCBkYXRlRmlsdGVyOiBhbnkgPSB7fTtcbiAgICAgICAgaWYgKHN0YXJ0RGF0ZSkgZGF0ZUZpbHRlci5ndGUgPSBzdGFydERhdGU7XG4gICAgICAgIGlmIChlbmREYXRlKSB7XG4gICAgICAgICAgICAvLyBBZGp1c3QgZW5kRGF0ZSB0byBpbmNsdWRlIHRoZSB3aG9sZSBkYXlcbiAgICAgICAgICAgIGNvbnN0IGFkanVzdGVkRW5kRGF0ZSA9IG5ldyBEYXRlKGVuZERhdGUpO1xuICAgICAgICAgICAgYWRqdXN0ZWRFbmREYXRlLnNldEhvdXJzKDIzLCA1OSwgNTksIDk5OSk7XG4gICAgICAgICAgICBkYXRlRmlsdGVyLmx0ZSA9IGFkanVzdGVkRW5kRGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFsbEV2ZW50czogUHJvZHVjdEhpc3RvcnlFdmVudFtdID0gW107XG5cbiAgICAgICAgLy8gMS4gRmV0Y2ggUHVyY2hhc2VzXG4gICAgICAgIGNvbnN0IHB1cmNoYXNlcyA9IGF3YWl0IHByaXNtYS5wdXJjaGFzZUludm9pY2VJdGVtLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgcHJvZHVjdElkLFxuICAgICAgICAgICAgICAgIHB1cmNoYXNlSW52b2ljZToge1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IE9iamVjdC5rZXlzKGRhdGVGaWx0ZXIpLmxlbmd0aCA+IDAgPyBkYXRlRmlsdGVyIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICBwdXJjaGFzZUludm9pY2U6IHsgaW5jbHVkZTogeyBzdXBwbGllcjogdHJ1ZSB9IH0sXG4gICAgICAgICAgICAgICAgcHJvZHVjdDogdHJ1ZSAvLyBUbyBnZXQgcHJvZHVjdCBuYW1lIGlmIG5lZWRlZCBmb3IgZGVzY3JpcHRpb24sIHRob3VnaCB3ZSBoYXZlIHByb2R1Y3RJZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxuICAgICAgICB9KTtcblxuICAgICAgICBwdXJjaGFzZXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGFsbEV2ZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IGl0ZW0ucHVyY2hhc2VJbnZvaWNlLmNyZWF0ZWRBdCwgLy8gT3IgaXRlbS5jcmVhdGVkQXQgaWYgbW9yZSBzcGVjaWZpY1xuICAgICAgICAgICAgICAgIHR5cGU6ICdQdXJjaGFzZScsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBQdXJjaGFzZWQgJHtpdGVtLnF1YW50aXR5fSB1bml0cyBmcm9tICR7aXRlbS5wdXJjaGFzZUludm9pY2Uuc3VwcGxpZXIubmFtZX0uIFByaWNlOiBScy4gJHtpdGVtLnByaWNlLnRvRml4ZWQoMil9IGVhY2guYCxcbiAgICAgICAgICAgICAgICBxdWFudGl0eUNoYW5nZTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jdW1lbnRJZDogYFB1cmNoYXNlIEludm9pY2UgIyR7aXRlbS5wdXJjaGFzZUludm9pY2UuaW52b2ljZU51bWJlcn1gLFxuICAgICAgICAgICAgICAgIC8vIHNob3BJZDogaXRlbS5wdXJjaGFzZUludm9pY2Uuc2hvcElkLCAvLyBJZiBQdXJjaGFzZUludm9pY2UgaGFzIGEgc2hvcElkXG4gICAgICAgICAgICAgICAgLy8gdXNlck5hbWU6IC8vIElmIFB1cmNoYXNlSW52b2ljZSBoYXMgYSBjcmVhdG9yL3VzZXJJZFxuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VwcGxpZXI6IGl0ZW0ucHVyY2hhc2VJbnZvaWNlLnN1cHBsaWVyLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGludm9pY2VOdW1iZXI6IGl0ZW0ucHVyY2hhc2VJbnZvaWNlLmludm9pY2VOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgICAgICBwcmljZTogaXRlbS5wcmljZSxcbiAgICAgICAgICAgICAgICAgICAgdG90YWw6IGl0ZW0udG90YWwsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIDIuIEZldGNoIFNhbGVzXG4gICAgICAgIGNvbnN0IHNhbGVzID0gYXdhaXQgcHJpc21hLmludm9pY2VJdGVtLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgcHJvZHVjdElkLFxuICAgICAgICAgICAgICAgIGludm9pY2U6IHtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBPYmplY3Qua2V5cyhkYXRlRmlsdGVyKS5sZW5ndGggPiAwID8gZGF0ZUZpbHRlciA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgaW52b2ljZTogeyBpbmNsdWRlOiB7IGN1c3RvbWVyOiB0cnVlLCBzaG9wOiB0cnVlIH0gfSwgLy8gQXNzdW1pbmcgSW52b2ljZSBoYXMgc2hvcFxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2FsZXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGFsbEV2ZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IGl0ZW0uaW52b2ljZS5jcmVhdGVkQXQsIC8vIE9yIGl0ZW0uY3JlYXRlZEF0XG4gICAgICAgICAgICAgICAgdHlwZTogJ1NhbGUnLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgU29sZCAke2l0ZW0ucXVhbnRpdHl9IHVuaXRzIHRvICR7aXRlbS5pbnZvaWNlLmN1c3RvbWVyLm5hbWV9LlByaWNlOiBScy4ke2l0ZW0ucHJpY2UudG9GaXhlZCgyKX0gZWFjaC5gLFxuICAgICAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiAtaXRlbS5xdWFudGl0eSwgLy8gTmVnYXRpdmUgZm9yIHNhbGVcbiAgICAgICAgICAgICAgICBzaG9wSWQ6IGl0ZW0uaW52b2ljZS5zaG9wSWQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHNob3BOYW1lOiBpdGVtLmludm9pY2Uuc2hvcD8ubmFtZSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgcmVsYXRlZERvY3VtZW50SWQ6IGBTYWxlcyBJbnZvaWNlICMke2l0ZW0uaW52b2ljZS5pbnZvaWNlTnVtYmVyfWAsXG4gICAgICAgICAgICAgICAgLy8gdXNlck5hbWU6IGl0ZW0uaW52b2ljZS51c2VySWQgLy8gSWYgSW52b2ljZSBoYXMgYSBjcmVhdG9yL3VzZXJJZFxuICAgICAgICAgICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tZXI6IGl0ZW0uaW52b2ljZS5jdXN0b21lci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBpbnZvaWNlTnVtYmVyOiBpdGVtLmludm9pY2UuaW52b2ljZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbDogaXRlbS50b3RhbCxcbiAgICAgICAgICAgICAgICAgICAgc2hvcDogaXRlbS5pbnZvaWNlLnNob3A/Lm5hbWUsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIDMuIEZldGNoIFRyYW5zZmVyc1xuICAgICAgICBjb25zdCB0cmFuc2ZlcnMgPSBhd2FpdCBwcmlzbWEudHJhbnNmZXJJdGVtLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgcHJvZHVjdElkLFxuICAgICAgICAgICAgICAgIHRyYW5zZmVyOiB7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogT2JqZWN0LmtleXMoZGF0ZUZpbHRlcikubGVuZ3RoID4gMCA/IGRhdGVGaWx0ZXIgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIHRyYW5zZmVyOiB7IGluY2x1ZGU6IHsgZnJvbVNob3A6IHRydWUsIHRvU2hvcDogdHJ1ZSwgZnJvbVVzZXI6IHRydWUsIHRvVXNlcjogdHJ1ZSB9IH0sXG4gICAgICAgICAgICAgICAgcHJvZHVjdDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0cmFuc2ZlcnMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0d28gZXZlbnRzIGZvciBlYWNoIHRyYW5zZmVyOiBvbmUgZm9yICdvdXQnIGFuZCBvbmUgZm9yICdpbidcbiAgICAgICAgICAgIC8vIFRyYW5zZmVyIE91dFxuICAgICAgICAgICAgYWxsRXZlbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogaXRlbS50cmFuc2Zlci5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgdHlwZTogJ1RyYW5zZmVyIE91dCcsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBUcmFuc2ZlcnJlZCAke2l0ZW0ucXVhbnRpdHl9IHVuaXRzIGZyb20gJHtpdGVtLnRyYW5zZmVyLmZyb21TaG9wLm5hbWV9IHRvICR7aXRlbS50cmFuc2Zlci50b1Nob3AubmFtZX0uYCxcbiAgICAgICAgICAgICAgICBxdWFudGl0eUNoYW5nZTogLWl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgc2hvcElkOiBpdGVtLnRyYW5zZmVyLmZyb21TaG9wSWQsXG4gICAgICAgICAgICAgICAgc2hvcE5hbWU6IGl0ZW0udHJhbnNmZXIuZnJvbVNob3AubmFtZSxcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGl0ZW0udHJhbnNmZXIuZnJvbVVzZXJJZCwgLy8gVXNlciBpbml0aWF0aW5nIHRyYW5zZmVyXG4gICAgICAgICAgICAgICAgdXNlck5hbWU6IGl0ZW0udHJhbnNmZXIuZnJvbVVzZXIubmFtZSxcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jdW1lbnRJZDogYFRyYW5zZmVyIElEICMke2l0ZW0udHJhbnNmZXIuaWR9YCxcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgICAgIGZyb21TaG9wOiBpdGVtLnRyYW5zZmVyLmZyb21TaG9wLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHRvU2hvcDogaXRlbS50cmFuc2Zlci50b1Nob3AubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS50cmFuc2Zlci5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIG5vdGVzOiBpdGVtLnRyYW5zZmVyLm5vdGVzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBUcmFuc2ZlciBJblxuICAgICAgICAgICAgYWxsRXZlbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogaXRlbS50cmFuc2Zlci5jcmVhdGVkQXQsIC8vIENvdWxkIGJlIGEgc2xpZ2h0bHkgbGF0ZXIgdGltZSBpZiB0cmFuc2ZlciBoYXMgcmVjZWl2ZWRBdFxuICAgICAgICAgICAgICAgIHR5cGU6ICdUcmFuc2ZlciBJbicsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBSZWNlaXZlZCAke2l0ZW0ucXVhbnRpdHl9IHVuaXRzIGF0ICR7aXRlbS50cmFuc2Zlci50b1Nob3AubmFtZX0gZnJvbSAke2l0ZW0udHJhbnNmZXIuZnJvbVNob3AubmFtZX0uYCxcbiAgICAgICAgICAgICAgICBxdWFudGl0eUNoYW5nZTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICAgICAgICBzaG9wSWQ6IGl0ZW0udHJhbnNmZXIudG9TaG9wSWQsXG4gICAgICAgICAgICAgICAgc2hvcE5hbWU6IGl0ZW0udHJhbnNmZXIudG9TaG9wLm5hbWUsXG4gICAgICAgICAgICAgICAgdXNlcklkOiBpdGVtLnRyYW5zZmVyLnRvVXNlcklkLCAvLyBVc2VyIHJlY2VpdmluZy9jb25maXJtaW5nIHRyYW5zZmVyXG4gICAgICAgICAgICAgICAgdXNlck5hbWU6IGl0ZW0udHJhbnNmZXIudG9Vc2VyLm5hbWUsXG4gICAgICAgICAgICAgICAgcmVsYXRlZERvY3VtZW50SWQ6IGBUcmFuc2ZlciBJRCAjJHtpdGVtLnRyYW5zZmVyLmlkfWAsXG4gICAgICAgICAgICAgICAgZGV0YWlsczogeyAuLi5hbGxFdmVudHNbYWxsRXZlbnRzLmxlbmd0aCAtIDFdLmRldGFpbHMgfSAvLyBzYW1lIGRldGFpbHMgYXMgb3V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gNC4gRmV0Y2ggQXVkaXQgTG9ncyAoUHJvZHVjdCBVcGRhdGVzIGFuZCBTdG9jayBBZGRpdGlvbnMpXG4gICAgICAgIGNvbnN0IGF1ZGl0TG9ncyA9IGF3YWl0IHByaXNtYS5hdWRpdExvZy5maW5kTWFueSh7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgZW50aXR5OiAnUHJvZHVjdCcsIGVudGl0eUlkOiBwcm9kdWN0SWQsIGFjdGlvbjogJ1VQREFURV9QUk9EVUNUJyB9LFxuICAgICAgICAgICAgICAgICAgICB7IGVudGl0eTogJ0ludmVudG9yeUl0ZW0nLCBkZXRhaWxzOiB7IHBhdGg6IFsncHJvZHVjdElkJ10sIGVxdWFsczogcHJvZHVjdElkIH0sIGFjdGlvbjogJ0FERF9JTlZFTlRPUlknIH0sXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBtb3JlIHNwZWNpZmljIGF1ZGl0IGFjdGlvbnMgaWYgbmVlZGVkLCBlLmcuLCBmb3IgbWFudWFsIGFkanVzdG1lbnRzXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IE9iamVjdC5rZXlzKGRhdGVGaWx0ZXIpLmxlbmd0aCA+IDAgPyBkYXRlRmlsdGVyIDogdW5kZWZpbmVkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gaW5jbHVkZTogeyB1c2VyOiB0cnVlIH0sIC8vIFRlbXBvcmFyaWx5IHJlbW92ZWQgZHVlIHRvIG1pc3NpbmcgZXhwbGljaXQgcmVsYXRpb25cbiAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxuICAgICAgICB9KTtcblxuICAgICAgICBhdWRpdExvZ3MuZm9yRWFjaChsb2cgPT4ge1xuICAgICAgICAgICAgbGV0IGV2ZW50VHlwZSA9ICdBdWRpdCc7XG4gICAgICAgICAgICBsZXQgZXZlbnREZXNjcmlwdGlvbiA9IGBBY3Rpb246ICR7bG9nLmFjdGlvbn0gb24gJHtsb2cuZW50aXR5fWA7XG4gICAgICAgICAgICBsZXQgcXVhbnRpdHlDaGFuZ2VWYWw6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGxldCBkZXRhaWxzT2JqZWN0ID0gbG9nLmRldGFpbHM7XG4gICAgICAgICAgICAvLyBsZXQgdXNlck5hbWVWYWw6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDsgLy8gVGVtcG9yYXJpbHkgcmVtb3ZlIHVzZXIgbmFtZVxuXG4gICAgICAgICAgICBpZiAobG9nLmFjdGlvbiA9PT0gJ1VQREFURV9QUk9EVUNUJyAmJiB0eXBlb2YgbG9nLmRldGFpbHMgPT09ICdvYmplY3QnICYmIGxvZy5kZXRhaWxzICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlID0gJ1Byb2R1Y3QgVXBkYXRlJztcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFuZ2VzID0gT2JqZWN0LmVudHJpZXMobG9nLmRldGFpbHMgYXMgUmVjb3JkPHN0cmluZywgeyBvbGQ6IGFueSwgbmV3OiBhbnkgfT4pXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoKFtrZXksIHZhbHVlXSkgPT4gYCAgLSAke2tleX06ICcke3ZhbHVlLm9sZH0nIC0+ICcke3ZhbHVlLm5ld30nYClcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgIGV2ZW50RGVzY3JpcHRpb24gPSBgUHJvZHVjdCBkZXRhaWxzIHVwZGF0ZWQ6XFxuJHtjaGFuZ2VzfWA7XG4gICAgICAgICAgICAgICAgZGV0YWlsc09iamVjdCA9IGxvZy5kZXRhaWxzOyAvLyBBbHJlYWR5IGFuIG9iamVjdFxuICAgICAgICAgICAgfSBlbHNlIGlmIChsb2cuYWN0aW9uID09PSAnQUREX0lOVkVOVE9SWScgJiYgdHlwZW9mIGxvZy5kZXRhaWxzID09PSAnb2JqZWN0JyAmJiBsb2cuZGV0YWlscyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSA9ICdTdG9jayBBZGRlZCc7XG4gICAgICAgICAgICAgICAgY29uc3QgZGV0YWlsSnNvbiA9IGxvZy5kZXRhaWxzIGFzIGFueTsgLy8gQWxyZWFkeSBwYXJzZWQgYnkgUHJpc21hIGlmIGpzb25iXG4gICAgICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2VWYWwgPSBkZXRhaWxKc29uLnF1YW50aXR5IHx8IDA7XG4gICAgICAgICAgICAgICAgZXZlbnREZXNjcmlwdGlvbiA9IGBBZGRlZCAke3F1YW50aXR5Q2hhbmdlVmFsfSB1bml0cyBkaXJlY3RseS4gU2hvcCBJRDogJHtkZXRhaWxKc29uLnNob3BJZH1gO1xuICAgICAgICAgICAgICAgIGRldGFpbHNPYmplY3QgPSBkZXRhaWxKc29uO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhbGxFdmVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBsb2cuY3JlYXRlZEF0LFxuICAgICAgICAgICAgICAgIHR5cGU6IGV2ZW50VHlwZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZXZlbnREZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICBxdWFudGl0eUNoYW5nZTogcXVhbnRpdHlDaGFuZ2VWYWwsXG4gICAgICAgICAgICAgICAgc2hvcElkOiAobG9nLmRldGFpbHMgYXMgYW55KT8uc2hvcElkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGxvZy51c2VySWQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIC8vIHVzZXJOYW1lOiB1c2VyTmFtZVZhbCwgLy8gVGVtcG9yYXJpbHkgcmVtb3ZlIHVzZXIgbmFtZVxuICAgICAgICAgICAgICAgIHJlbGF0ZWREb2N1bWVudElkOiBgQXVkaXQgSUQgIyR7bG9nLmlkfWAsXG4gICAgICAgICAgICAgICAgZGV0YWlsczogZGV0YWlsc09iamVjdFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEZpbHRlciBieSBldmVudCB0eXBlcyBpZiBwcm92aWRlZFxuICAgICAgICBjb25zdCBmaWx0ZXJlZEV2ZW50cyA9IGZpbHRlckV2ZW50VHlwZXMubGVuZ3RoID4gMFxuICAgICAgICAgICAgPyBhbGxFdmVudHMuZmlsdGVyKGV2ZW50ID0+IGZpbHRlckV2ZW50VHlwZXMuaW5jbHVkZXMoZXZlbnQudHlwZSkpXG4gICAgICAgICAgICA6IGFsbEV2ZW50cztcblxuICAgICAgICAvLyBTb3J0IGFsbCBjb2xsZWN0ZWQgZXZlbnRzIGJ5IHRpbWVzdGFtcCBpbiBkZXNjZW5kaW5nIG9yZGVyXG4gICAgICAgIGZpbHRlcmVkRXZlbnRzLnNvcnQoKGEsIGIpID0+IGIudGltZXN0YW1wLmdldFRpbWUoKSAtIGEudGltZXN0YW1wLmdldFRpbWUoKSk7XG5cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZmlsdGVyZWRFdmVudHMgfSk7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBmZXRjaGluZyBwcm9kdWN0IGhpc3RvcnkgZm9yIHByb2R1Y3QgSUQgJHtwYXJhbXMuaWR9OmAsIGVycm9yKTtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQnO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ0ZhaWxlZCB0byBmZXRjaCBwcm9kdWN0IGhpc3RvcnknLCBkZXRhaWxzOiBtZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxufSAiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OytCQWdCc0I7Ozs7OztXQUFBQSxHQUFBOzs7OztpQ0FoQm9COzs7dUVBQ3ZCOzs7Ozs7Ozs7Ozs7Ozs7QUFlWixlQUFlQSxJQUNsQkMsT0FBb0IsRUFDcEI7RUFBRUM7QUFBTSxDQUE4QjtFQUFBO0VBQUFDLGFBQUEsR0FBQUMsQ0FBQTtFQUFBRCxhQUFBLEdBQUFFLENBQUE7RUFFdEMsSUFBSTtJQUNBLE1BQU1DLFNBQUE7SUFBQTtJQUFBLENBQUFILGFBQUEsR0FBQUUsQ0FBQSxPQUFZRSxRQUFBLENBQVNMLE1BQUEsQ0FBT00sRUFBRTtJQUFBO0lBQUFMLGFBQUEsR0FBQUUsQ0FBQTtJQUNwQyxJQUFJSSxLQUFBLENBQU1ILFNBQUEsR0FBWTtNQUFBO01BQUFILGFBQUEsR0FBQU8sQ0FBQTtNQUFBUCxhQUFBLEdBQUFFLENBQUE7TUFDbEIsT0FBT00sT0FBQSxDQUFBQyxZQUFZLENBQUNDLElBQUksQ0FBQztRQUFFQyxPQUFBLEVBQVM7UUFBT0MsT0FBQSxFQUFTO01BQXFCLEdBQUc7UUFBRUMsTUFBQSxFQUFRO01BQUk7SUFDOUY7SUFBQTtJQUFBO01BQUFiLGFBQUEsR0FBQU8sQ0FBQTtJQUFBO0lBRUEsTUFBTTtNQUFFTztJQUFZLENBQUU7SUFBQTtJQUFBLENBQUFkLGFBQUEsR0FBQUUsQ0FBQSxRQUFHLElBQUlhLEdBQUEsQ0FBSWpCLE9BQUEsQ0FBUWtCLEdBQUc7SUFDNUMsTUFBTUMsZUFBQTtJQUFBO0lBQUEsQ0FBQWpCLGFBQUEsR0FBQUUsQ0FBQSxRQUFrQlksWUFBQSxDQUFhSSxHQUFHLENBQUM7SUFDekMsTUFBTUMsY0FBQTtJQUFBO0lBQUEsQ0FBQW5CLGFBQUEsR0FBQUUsQ0FBQSxRQUFpQlksWUFBQSxDQUFhSSxHQUFHLENBQUM7SUFDeEMsTUFBTUUsWUFBQTtJQUFBO0lBQUEsQ0FBQXBCLGFBQUEsR0FBQUUsQ0FBQSxRQUFlWSxZQUFBLENBQWFJLEdBQUcsQ0FBQztJQUV0QyxNQUFNRyxnQkFBQTtJQUFBO0lBQUEsQ0FBQXJCLGFBQUEsR0FBQUUsQ0FBQSxRQUFtQmUsZUFBQTtJQUFBO0lBQUEsQ0FBQWpCLGFBQUEsR0FBQU8sQ0FBQSxVQUFrQlUsZUFBQSxDQUFnQkssS0FBSyxDQUFDO0lBQUE7SUFBQSxDQUFBdEIsYUFBQSxHQUFBTyxDQUFBLFVBQU8sRUFBRTtJQUMxRSxNQUFNZ0IsU0FBQTtJQUFBO0lBQUEsQ0FBQXZCLGFBQUEsR0FBQUUsQ0FBQSxRQUFZaUIsY0FBQTtJQUFBO0lBQUEsQ0FBQW5CLGFBQUEsR0FBQU8sQ0FBQSxVQUFpQixJQUFJaUIsSUFBQSxDQUFLTCxjQUFBO0lBQUE7SUFBQSxDQUFBbkIsYUFBQSxHQUFBTyxDQUFBLFVBQWtCO0lBQzlELE1BQU1rQixPQUFBO0lBQUE7SUFBQSxDQUFBekIsYUFBQSxHQUFBRSxDQUFBLFFBQVVrQixZQUFBO0lBQUE7SUFBQSxDQUFBcEIsYUFBQSxHQUFBTyxDQUFBLFVBQWUsSUFBSWlCLElBQUEsQ0FBS0osWUFBQTtJQUFBO0lBQUEsQ0FBQXBCLGFBQUEsR0FBQU8sQ0FBQSxVQUFnQjtJQUV4RDtJQUNBLE1BQU1tQixVQUFBO0lBQUE7SUFBQSxDQUFBMUIsYUFBQSxHQUFBRSxDQUFBLFFBQWtCLENBQUM7SUFBQTtJQUFBRixhQUFBLEdBQUFFLENBQUE7SUFDekIsSUFBSXFCLFNBQUEsRUFBVztNQUFBO01BQUF2QixhQUFBLEdBQUFPLENBQUE7TUFBQVAsYUFBQSxHQUFBRSxDQUFBO01BQUF3QixVQUFBLENBQVdDLEdBQUcsR0FBR0osU0FBQTtJQUFBO0lBQUE7SUFBQTtNQUFBdkIsYUFBQSxHQUFBTyxDQUFBO0lBQUE7SUFBQVAsYUFBQSxHQUFBRSxDQUFBO0lBQ2hDLElBQUl1QixPQUFBLEVBQVM7TUFBQTtNQUFBekIsYUFBQSxHQUFBTyxDQUFBO01BQ1Q7TUFDQSxNQUFNcUIsZUFBQTtNQUFBO01BQUEsQ0FBQTVCLGFBQUEsR0FBQUUsQ0FBQSxRQUFrQixJQUFJc0IsSUFBQSxDQUFLQyxPQUFBO01BQUE7TUFBQXpCLGFBQUEsR0FBQUUsQ0FBQTtNQUNqQzBCLGVBQUEsQ0FBZ0JDLFFBQVEsQ0FBQyxJQUFJLElBQUksSUFBSTtNQUFBO01BQUE3QixhQUFBLEdBQUFFLENBQUE7TUFDckN3QixVQUFBLENBQVdJLEdBQUcsR0FBR0YsZUFBQTtJQUNyQjtJQUFBO0lBQUE7TUFBQTVCLGFBQUEsR0FBQU8sQ0FBQTtJQUFBO0lBRUEsTUFBTXdCLFNBQUE7SUFBQTtJQUFBLENBQUEvQixhQUFBLEdBQUFFLENBQUEsUUFBbUMsRUFBRTtJQUUzQztJQUNBLE1BQU04QixTQUFBO0lBQUE7SUFBQSxDQUFBaEMsYUFBQSxHQUFBRSxDQUFBLFFBQVksTUFBTStCLE9BQUEsQ0FBQUMsT0FBTSxDQUFDQyxtQkFBbUIsQ0FBQ0MsUUFBUSxDQUFDO01BQ3hEQyxLQUFBLEVBQU87UUFDSGxDLFNBQUE7UUFDQW1DLGVBQUEsRUFBaUI7VUFDYkMsU0FBQSxFQUFXQyxNQUFBLENBQU9DLElBQUksQ0FBQ2YsVUFBQSxFQUFZZ0IsTUFBTSxHQUFHO1VBQUE7VUFBQSxDQUFBMUMsYUFBQSxHQUFBTyxDQUFBLFVBQUltQixVQUFBO1VBQUE7VUFBQSxDQUFBMUIsYUFBQSxHQUFBTyxDQUFBLFVBQWFvQyxTQUFBO1FBQ2pFO01BQ0o7TUFDQUMsT0FBQSxFQUFTO1FBQ0xOLGVBQUEsRUFBaUI7VUFBRU0sT0FBQSxFQUFTO1lBQUVDLFFBQUEsRUFBVTtVQUFLO1FBQUU7UUFDL0NDLE9BQUEsRUFBUyxLQUFLO01BQ2xCO01BQ0FDLE9BQUEsRUFBUztRQUFFUixTQUFBLEVBQVc7TUFBTztJQUNqQztJQUFBO0lBQUF2QyxhQUFBLEdBQUFFLENBQUE7SUFFQThCLFNBQUEsQ0FBVWdCLE9BQU8sQ0FBQ0MsSUFBQTtNQUFBO01BQUFqRCxhQUFBLEdBQUFDLENBQUE7TUFBQUQsYUFBQSxHQUFBRSxDQUFBO01BQ2Q2QixTQUFBLENBQVVtQixJQUFJLENBQUM7UUFDWEMsU0FBQSxFQUFXRixJQUFBLENBQUtYLGVBQWUsQ0FBQ0MsU0FBUztRQUN6Q2EsSUFBQSxFQUFNO1FBQ05DLFdBQUEsRUFBYSxhQUFhSixJQUFBLENBQUtLLFFBQVEsZUFBZUwsSUFBQSxDQUFLWCxlQUFlLENBQUNPLFFBQVEsQ0FBQ1UsSUFBSSxnQkFBZ0JOLElBQUEsQ0FBS08sS0FBSyxDQUFDQyxPQUFPLENBQUMsVUFBVTtRQUNySUMsY0FBQSxFQUFnQlQsSUFBQSxDQUFLSyxRQUFRO1FBQzdCSyxpQkFBQSxFQUFtQixxQkFBcUJWLElBQUEsQ0FBS1gsZUFBZSxDQUFDc0IsYUFBYSxFQUFFO1FBQzVFO1FBQ0E7UUFDQUMsT0FBQSxFQUFTO1VBQ0xoQixRQUFBLEVBQVVJLElBQUEsQ0FBS1gsZUFBZSxDQUFDTyxRQUFRLENBQUNVLElBQUk7VUFDNUNLLGFBQUEsRUFBZVgsSUFBQSxDQUFLWCxlQUFlLENBQUNzQixhQUFhO1VBQ2pETixRQUFBLEVBQVVMLElBQUEsQ0FBS0ssUUFBUTtVQUN2QkUsS0FBQSxFQUFPUCxJQUFBLENBQUtPLEtBQUs7VUFDakJNLEtBQUEsRUFBT2IsSUFBQSxDQUFLYTtRQUNoQjtNQUNKO0lBQ0o7SUFFQTtJQUNBLE1BQU1DLEtBQUE7SUFBQTtJQUFBLENBQUEvRCxhQUFBLEdBQUFFLENBQUEsUUFBUSxNQUFNK0IsT0FBQSxDQUFBQyxPQUFNLENBQUM4QixXQUFXLENBQUM1QixRQUFRLENBQUM7TUFDNUNDLEtBQUEsRUFBTztRQUNIbEMsU0FBQTtRQUNBOEQsT0FBQSxFQUFTO1VBQ0wxQixTQUFBLEVBQVdDLE1BQUEsQ0FBT0MsSUFBSSxDQUFDZixVQUFBLEVBQVlnQixNQUFNLEdBQUc7VUFBQTtVQUFBLENBQUExQyxhQUFBLEdBQUFPLENBQUEsVUFBSW1CLFVBQUE7VUFBQTtVQUFBLENBQUExQixhQUFBLEdBQUFPLENBQUEsVUFBYW9DLFNBQUE7UUFDakU7TUFDSjtNQUNBQyxPQUFBLEVBQVM7UUFDTHFCLE9BQUEsRUFBUztVQUFFckIsT0FBQSxFQUFTO1lBQUVzQixRQUFBLEVBQVU7WUFBTUMsSUFBQSxFQUFNO1VBQUs7UUFBRTtRQUNuRHJCLE9BQUEsRUFBUztNQUNiO01BQ0FDLE9BQUEsRUFBUztRQUFFUixTQUFBLEVBQVc7TUFBTztJQUNqQztJQUFBO0lBQUF2QyxhQUFBLEdBQUFFLENBQUE7SUFFQTZELEtBQUEsQ0FBTWYsT0FBTyxDQUFDQyxJQUFBO01BQUE7TUFBQWpELGFBQUEsR0FBQUMsQ0FBQTtNQUFBRCxhQUFBLEdBQUFFLENBQUE7TUFDVjZCLFNBQUEsQ0FBVW1CLElBQUksQ0FBQztRQUNYQyxTQUFBLEVBQVdGLElBQUEsQ0FBS2dCLE9BQU8sQ0FBQzFCLFNBQVM7UUFDakNhLElBQUEsRUFBTTtRQUNOQyxXQUFBLEVBQWEsUUFBUUosSUFBQSxDQUFLSyxRQUFRLGFBQWFMLElBQUEsQ0FBS2dCLE9BQU8sQ0FBQ0MsUUFBUSxDQUFDWCxJQUFJLGNBQWNOLElBQUEsQ0FBS08sS0FBSyxDQUFDQyxPQUFPLENBQUMsVUFBVTtRQUNwSEMsY0FBQSxFQUFnQixDQUFDVCxJQUFBLENBQUtLLFFBQVE7UUFDOUJjLE1BQUE7UUFBUTtRQUFBLENBQUFwRSxhQUFBLEdBQUFPLENBQUEsV0FBQTBDLElBQUEsQ0FBS2dCLE9BQU8sQ0FBQ0csTUFBTTtRQUFBO1FBQUEsQ0FBQXBFLGFBQUEsR0FBQU8sQ0FBQSxXQUFJb0MsU0FBQTtRQUMvQjBCLFFBQUE7UUFBVTtRQUFBLENBQUFyRSxhQUFBLEdBQUFPLENBQUEsV0FBQTBDLElBQUEsQ0FBS2dCLE9BQU8sQ0FBQ0UsSUFBSSxFQUFFWixJQUFBO1FBQUE7UUFBQSxDQUFBdkQsYUFBQSxHQUFBTyxDQUFBLFdBQVFvQyxTQUFBO1FBQ3JDZ0IsaUJBQUEsRUFBbUIsa0JBQWtCVixJQUFBLENBQUtnQixPQUFPLENBQUNMLGFBQWEsRUFBRTtRQUNqRTtRQUNBQyxPQUFBLEVBQVM7VUFDTEssUUFBQSxFQUFVakIsSUFBQSxDQUFLZ0IsT0FBTyxDQUFDQyxRQUFRLENBQUNYLElBQUk7VUFDcENLLGFBQUEsRUFBZVgsSUFBQSxDQUFLZ0IsT0FBTyxDQUFDTCxhQUFhO1VBQ3pDTixRQUFBLEVBQVVMLElBQUEsQ0FBS0ssUUFBUTtVQUN2QkUsS0FBQSxFQUFPUCxJQUFBLENBQUtPLEtBQUs7VUFDakJNLEtBQUEsRUFBT2IsSUFBQSxDQUFLYSxLQUFLO1VBQ2pCSyxJQUFBLEVBQU1sQixJQUFBLENBQUtnQixPQUFPLENBQUNFLElBQUksRUFBRVo7UUFDN0I7TUFDSjtJQUNKO0lBRUE7SUFDQSxNQUFNZSxTQUFBO0lBQUE7SUFBQSxDQUFBdEUsYUFBQSxHQUFBRSxDQUFBLFFBQVksTUFBTStCLE9BQUEsQ0FBQUMsT0FBTSxDQUFDcUMsWUFBWSxDQUFDbkMsUUFBUSxDQUFDO01BQ2pEQyxLQUFBLEVBQU87UUFDSGxDLFNBQUE7UUFDQXFFLFFBQUEsRUFBVTtVQUNOakMsU0FBQSxFQUFXQyxNQUFBLENBQU9DLElBQUksQ0FBQ2YsVUFBQSxFQUFZZ0IsTUFBTSxHQUFHO1VBQUE7VUFBQSxDQUFBMUMsYUFBQSxHQUFBTyxDQUFBLFdBQUltQixVQUFBO1VBQUE7VUFBQSxDQUFBMUIsYUFBQSxHQUFBTyxDQUFBLFdBQWFvQyxTQUFBO1FBQ2pFO01BQ0o7TUFDQUMsT0FBQSxFQUFTO1FBQ0w0QixRQUFBLEVBQVU7VUFBRTVCLE9BQUEsRUFBUztZQUFFNkIsUUFBQSxFQUFVO1lBQU1DLE1BQUEsRUFBUTtZQUFNQyxRQUFBLEVBQVU7WUFBTUMsTUFBQSxFQUFRO1VBQUs7UUFBRTtRQUNwRjlCLE9BQUEsRUFBUztNQUNiO01BQ0FDLE9BQUEsRUFBUztRQUFFUixTQUFBLEVBQVc7TUFBTztJQUNqQztJQUFBO0lBQUF2QyxhQUFBLEdBQUFFLENBQUE7SUFFQW9FLFNBQUEsQ0FBVXRCLE9BQU8sQ0FBQ0MsSUFBQTtNQUFBO01BQUFqRCxhQUFBLEdBQUFDLENBQUE7TUFBQUQsYUFBQSxHQUFBRSxDQUFBO01BQ2Q7TUFDQTtNQUNBNkIsU0FBQSxDQUFVbUIsSUFBSSxDQUFDO1FBQ1hDLFNBQUEsRUFBV0YsSUFBQSxDQUFLdUIsUUFBUSxDQUFDakMsU0FBUztRQUNsQ2EsSUFBQSxFQUFNO1FBQ05DLFdBQUEsRUFBYSxlQUFlSixJQUFBLENBQUtLLFFBQVEsZUFBZUwsSUFBQSxDQUFLdUIsUUFBUSxDQUFDQyxRQUFRLENBQUNsQixJQUFJLE9BQU9OLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQ0UsTUFBTSxDQUFDbkIsSUFBSSxHQUFHO1FBQ3RIRyxjQUFBLEVBQWdCLENBQUNULElBQUEsQ0FBS0ssUUFBUTtRQUM5QmMsTUFBQSxFQUFRbkIsSUFBQSxDQUFLdUIsUUFBUSxDQUFDSyxVQUFVO1FBQ2hDUixRQUFBLEVBQVVwQixJQUFBLENBQUt1QixRQUFRLENBQUNDLFFBQVEsQ0FBQ2xCLElBQUk7UUFDckN1QixNQUFBLEVBQVE3QixJQUFBLENBQUt1QixRQUFRLENBQUNPLFVBQVU7UUFDaENDLFFBQUEsRUFBVS9CLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQ0csUUFBUSxDQUFDcEIsSUFBSTtRQUNyQ0ksaUJBQUEsRUFBbUIsZ0JBQWdCVixJQUFBLENBQUt1QixRQUFRLENBQUNuRSxFQUFFLEVBQUU7UUFDckR3RCxPQUFBLEVBQVM7VUFDTFksUUFBQSxFQUFVeEIsSUFBQSxDQUFLdUIsUUFBUSxDQUFDQyxRQUFRLENBQUNsQixJQUFJO1VBQ3JDbUIsTUFBQSxFQUFRekIsSUFBQSxDQUFLdUIsUUFBUSxDQUFDRSxNQUFNLENBQUNuQixJQUFJO1VBQ2pDRCxRQUFBLEVBQVVMLElBQUEsQ0FBS0ssUUFBUTtVQUN2QnpDLE1BQUEsRUFBUW9DLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQzNELE1BQU07VUFDNUJvRSxLQUFBLEVBQU9oQyxJQUFBLENBQUt1QixRQUFRLENBQUNTO1FBQ3pCO01BQ0o7TUFDQTtNQUFBO01BQUFqRixhQUFBLEdBQUFFLENBQUE7TUFDQTZCLFNBQUEsQ0FBVW1CLElBQUksQ0FBQztRQUNYQyxTQUFBLEVBQVdGLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQ2pDLFNBQVM7UUFDbENhLElBQUEsRUFBTTtRQUNOQyxXQUFBLEVBQWEsWUFBWUosSUFBQSxDQUFLSyxRQUFRLGFBQWFMLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQ0UsTUFBTSxDQUFDbkIsSUFBSSxTQUFTTixJQUFBLENBQUt1QixRQUFRLENBQUNDLFFBQVEsQ0FBQ2xCLElBQUksR0FBRztRQUNuSEcsY0FBQSxFQUFnQlQsSUFBQSxDQUFLSyxRQUFRO1FBQzdCYyxNQUFBLEVBQVFuQixJQUFBLENBQUt1QixRQUFRLENBQUNVLFFBQVE7UUFDOUJiLFFBQUEsRUFBVXBCLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQ0UsTUFBTSxDQUFDbkIsSUFBSTtRQUNuQ3VCLE1BQUEsRUFBUTdCLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQ1csUUFBUTtRQUM5QkgsUUFBQSxFQUFVL0IsSUFBQSxDQUFLdUIsUUFBUSxDQUFDSSxNQUFNLENBQUNyQixJQUFJO1FBQ25DSSxpQkFBQSxFQUFtQixnQkFBZ0JWLElBQUEsQ0FBS3VCLFFBQVEsQ0FBQ25FLEVBQUUsRUFBRTtRQUNyRHdELE9BQUEsRUFBUztVQUFFLEdBQUc5QixTQUFTLENBQUNBLFNBQUEsQ0FBVVcsTUFBTSxHQUFHLEVBQUUsQ0FBQ21CO1FBQVEsRUFBRTtNQUM1RDtJQUNKO0lBRUE7SUFDQSxNQUFNdUIsU0FBQTtJQUFBO0lBQUEsQ0FBQXBGLGFBQUEsR0FBQUUsQ0FBQSxRQUFZLE1BQU0rQixPQUFBLENBQUFDLE9BQU0sQ0FBQ21ELFFBQVEsQ0FBQ2pELFFBQVEsQ0FBQztNQUM3Q0MsS0FBQSxFQUFPO1FBQ0hpRCxFQUFBLEVBQUksQ0FDQTtVQUFFQyxNQUFBLEVBQVE7VUFBV0MsUUFBQSxFQUFVckYsU0FBQTtVQUFXc0YsTUFBQSxFQUFRO1FBQWlCLEdBQ25FO1VBQUVGLE1BQUEsRUFBUTtVQUFpQjFCLE9BQUEsRUFBUztZQUFFNkIsSUFBQSxFQUFNLENBQUMsWUFBWTtZQUFFQyxNQUFBLEVBQVF4RjtVQUFVO1VBQUdzRixNQUFBLEVBQVE7UUFBZ0IsRUFFM0c7UUFDRGxELFNBQUEsRUFBV0MsTUFBQSxDQUFPQyxJQUFJLENBQUNmLFVBQUEsRUFBWWdCLE1BQU0sR0FBRztRQUFBO1FBQUEsQ0FBQTFDLGFBQUEsR0FBQU8sQ0FBQSxXQUFJbUIsVUFBQTtRQUFBO1FBQUEsQ0FBQTFCLGFBQUEsR0FBQU8sQ0FBQSxXQUFhb0MsU0FBQTtNQUNqRTtNQUNBO01BQ0FJLE9BQUEsRUFBUztRQUFFUixTQUFBLEVBQVc7TUFBTztJQUNqQztJQUFBO0lBQUF2QyxhQUFBLEdBQUFFLENBQUE7SUFFQWtGLFNBQUEsQ0FBVXBDLE9BQU8sQ0FBQzRDLEdBQUE7TUFBQTtNQUFBNUYsYUFBQSxHQUFBQyxDQUFBO01BQ2QsSUFBSTRGLFNBQUE7TUFBQTtNQUFBLENBQUE3RixhQUFBLEdBQUFFLENBQUEsUUFBWTtNQUNoQixJQUFJNEYsZ0JBQUE7TUFBQTtNQUFBLENBQUE5RixhQUFBLEdBQUFFLENBQUEsUUFBbUIsV0FBVzBGLEdBQUEsQ0FBSUgsTUFBTSxPQUFPRyxHQUFBLENBQUlMLE1BQU0sRUFBRTtNQUMvRCxJQUFJUSxpQkFBQTtNQUFBO01BQUEsQ0FBQS9GLGFBQUEsR0FBQUUsQ0FBQSxRQUF3Q3lDLFNBQUE7TUFDNUMsSUFBSXFELGFBQUE7TUFBQTtNQUFBLENBQUFoRyxhQUFBLEdBQUFFLENBQUEsUUFBZ0IwRixHQUFBLENBQUkvQixPQUFPO01BQy9CO01BQUE7TUFBQTdELGFBQUEsR0FBQUUsQ0FBQTtNQUVBO01BQUk7TUFBQSxDQUFBRixhQUFBLEdBQUFPLENBQUEsV0FBQXFGLEdBQUEsQ0FBSUgsTUFBTSxLQUFLO01BQUE7TUFBQSxDQUFBekYsYUFBQSxHQUFBTyxDQUFBLFdBQW9CLE9BQU9xRixHQUFBLENBQUkvQixPQUFPLEtBQUs7TUFBQTtNQUFBLENBQUE3RCxhQUFBLEdBQUFPLENBQUEsV0FBWXFGLEdBQUEsQ0FBSS9CLE9BQU8sS0FBSyxPQUFNO1FBQUE7UUFBQTdELGFBQUEsR0FBQU8sQ0FBQTtRQUFBUCxhQUFBLEdBQUFFLENBQUE7UUFDNUYyRixTQUFBLEdBQVk7UUFDWixNQUFNSSxPQUFBO1FBQUE7UUFBQSxDQUFBakcsYUFBQSxHQUFBRSxDQUFBLFFBQVVzQyxNQUFBLENBQU8wRCxPQUFPLENBQUNOLEdBQUEsQ0FBSS9CLE9BQU8sRUFDckNzQyxHQUFHLENBQUMsQ0FBQyxDQUFDQyxHQUFBLEVBQUtDLEtBQUEsQ0FBTSxLQUFLO1VBQUE7VUFBQXJHLGFBQUEsR0FBQUMsQ0FBQTtVQUFBRCxhQUFBLEdBQUFFLENBQUE7VUFBQSxjQUFPa0csR0FBQSxNQUFTQyxLQUFBLENBQU1DLEdBQUcsU0FBU0QsS0FBQSxDQUFNRSxHQUFHLEdBQUc7UUFBRCxDQUFDLEVBQ3BFQyxJQUFJLENBQUM7UUFBQTtRQUFBeEcsYUFBQSxHQUFBRSxDQUFBO1FBQ1Y0RixnQkFBQSxHQUFtQiw2QkFBNkJHLE9BQUEsRUFBUztRQUFBO1FBQUFqRyxhQUFBLEdBQUFFLENBQUE7UUFDekQ4RixhQUFBLEdBQWdCSixHQUFBLENBQUkvQixPQUFPLEVBQUU7TUFDakMsT0FBTztRQUFBO1FBQUE3RCxhQUFBLEdBQUFPLENBQUE7UUFBQVAsYUFBQSxHQUFBRSxDQUFBO1FBQUE7UUFBSTtRQUFBLENBQUFGLGFBQUEsR0FBQU8sQ0FBQSxXQUFBcUYsR0FBQSxDQUFJSCxNQUFNLEtBQUs7UUFBQTtRQUFBLENBQUF6RixhQUFBLEdBQUFPLENBQUEsV0FBbUIsT0FBT3FGLEdBQUEsQ0FBSS9CLE9BQU8sS0FBSztRQUFBO1FBQUEsQ0FBQTdELGFBQUEsR0FBQU8sQ0FBQSxXQUFZcUYsR0FBQSxDQUFJL0IsT0FBTyxLQUFLLE9BQU07VUFBQTtVQUFBN0QsYUFBQSxHQUFBTyxDQUFBO1VBQUFQLGFBQUEsR0FBQUUsQ0FBQTtVQUNsRzJGLFNBQUEsR0FBWTtVQUNaLE1BQU1ZLFVBQUE7VUFBQTtVQUFBLENBQUF6RyxhQUFBLEdBQUFFLENBQUEsUUFBYTBGLEdBQUEsQ0FBSS9CLE9BQU8sR0FBUztVQUFBO1VBQUE3RCxhQUFBLEdBQUFFLENBQUE7VUFDdkM2RixpQkFBQTtVQUFvQjtVQUFBLENBQUEvRixhQUFBLEdBQUFPLENBQUEsV0FBQWtHLFVBQUEsQ0FBV25ELFFBQVE7VUFBQTtVQUFBLENBQUF0RCxhQUFBLEdBQUFPLENBQUEsV0FBSTtVQUFBO1VBQUFQLGFBQUEsR0FBQUUsQ0FBQTtVQUMzQzRGLGdCQUFBLEdBQW1CLFNBQVNDLGlCQUFBLDZCQUE4Q1UsVUFBQSxDQUFXckMsTUFBTSxFQUFFO1VBQUE7VUFBQXBFLGFBQUEsR0FBQUUsQ0FBQTtVQUM3RjhGLGFBQUEsR0FBZ0JTLFVBQUE7UUFDcEI7UUFBQTtRQUFBO1VBQUF6RyxhQUFBLEdBQUFPLENBQUE7UUFBQTtNQUFBO01BQUE7TUFBQVAsYUFBQSxHQUFBRSxDQUFBO01BRUE2QixTQUFBLENBQVVtQixJQUFJLENBQUM7UUFDWEMsU0FBQSxFQUFXeUMsR0FBQSxDQUFJckQsU0FBUztRQUN4QmEsSUFBQSxFQUFNeUMsU0FBQTtRQUNOeEMsV0FBQSxFQUFheUMsZ0JBQUE7UUFDYnBDLGNBQUEsRUFBZ0JxQyxpQkFBQTtRQUNoQjNCLE1BQUE7UUFBUTtRQUFBLENBQUFwRSxhQUFBLEdBQUFPLENBQUEsV0FBQXFGLEdBQUMsQ0FBSS9CLE9BQU8sRUFBVU8sTUFBQTtRQUFBO1FBQUEsQ0FBQXBFLGFBQUEsR0FBQU8sQ0FBQSxXQUFVb0MsU0FBQTtRQUN4Q21DLE1BQUE7UUFBUTtRQUFBLENBQUE5RSxhQUFBLEdBQUFPLENBQUEsV0FBQXFGLEdBQUEsQ0FBSWQsTUFBTTtRQUFBO1FBQUEsQ0FBQTlFLGFBQUEsR0FBQU8sQ0FBQSxXQUFJb0MsU0FBQTtRQUN0QjtRQUNBZ0IsaUJBQUEsRUFBbUIsYUFBYWlDLEdBQUEsQ0FBSXZGLEVBQUUsRUFBRTtRQUN4Q3dELE9BQUEsRUFBU21DO01BQ2I7SUFDSjtJQUVBO0lBQ0EsTUFBTVUsY0FBQTtJQUFBO0lBQUEsQ0FBQTFHLGFBQUEsR0FBQUUsQ0FBQSxRQUFpQm1CLGdCQUFBLENBQWlCcUIsTUFBTSxHQUFHO0lBQUE7SUFBQSxDQUFBMUMsYUFBQSxHQUFBTyxDQUFBLFdBQzNDd0IsU0FBQSxDQUFVNEUsTUFBTSxDQUFDQyxLQUFBLElBQVM7TUFBQTtNQUFBNUcsYUFBQSxHQUFBQyxDQUFBO01BQUFELGFBQUEsR0FBQUUsQ0FBQTtNQUFBLE9BQUFtQixnQkFBQSxDQUFpQndGLFFBQVEsQ0FBQ0QsS0FBQSxDQUFNeEQsSUFBSTtJQUFBO0lBQUE7SUFBQSxDQUFBcEQsYUFBQSxHQUFBTyxDQUFBLFdBQzlEd0IsU0FBQTtJQUVOO0lBQUE7SUFBQS9CLGFBQUEsR0FBQUUsQ0FBQTtJQUNBd0csY0FBQSxDQUFlSSxJQUFJLENBQUMsQ0FBQ0MsQ0FBQSxFQUFHeEcsQ0FBQSxLQUFNO01BQUE7TUFBQVAsYUFBQSxHQUFBQyxDQUFBO01BQUFELGFBQUEsR0FBQUUsQ0FBQTtNQUFBLE9BQUFLLENBQUEsQ0FBRTRDLFNBQVMsQ0FBQzZELE9BQU8sS0FBS0QsQ0FBQSxDQUFFNUQsU0FBUyxDQUFDNkQsT0FBTztJQUFBO0lBQUE7SUFBQWhILGFBQUEsR0FBQUUsQ0FBQTtJQUV6RSxPQUFPTSxPQUFBLENBQUFDLFlBQVksQ0FBQ0MsSUFBSSxDQUFDO01BQUVDLE9BQUEsRUFBUztNQUFNc0csSUFBQSxFQUFNUDtJQUFlO0VBRW5FLEVBQUUsT0FBT1EsS0FBQSxFQUFPO0lBQUE7SUFBQWxILGFBQUEsR0FBQUUsQ0FBQTtJQUNaaUgsT0FBQSxDQUFRRCxLQUFLLENBQUMsaURBQWlEbkgsTUFBQSxDQUFPTSxFQUFFLEdBQUcsRUFBRTZHLEtBQUE7SUFDN0UsTUFBTXRHLE9BQUE7SUFBQTtJQUFBLENBQUFaLGFBQUEsR0FBQUUsQ0FBQSxRQUFVZ0gsS0FBQSxZQUFpQkUsS0FBQTtJQUFBO0lBQUEsQ0FBQXBILGFBQUEsR0FBQU8sQ0FBQSxXQUFRMkcsS0FBQSxDQUFNdEcsT0FBTztJQUFBO0lBQUEsQ0FBQVosYUFBQSxHQUFBTyxDQUFBLFdBQUc7SUFBQTtJQUFBUCxhQUFBLEdBQUFFLENBQUE7SUFDekQsT0FBT00sT0FBQSxDQUFBQyxZQUFZLENBQUNDLElBQUksQ0FBQztNQUFFQyxPQUFBLEVBQVM7TUFBT0MsT0FBQSxFQUFTO01BQW1DaUQsT0FBQSxFQUFTakQ7SUFBUSxHQUFHO01BQUVDLE1BQUEsRUFBUTtJQUFJO0VBQzdIO0FBQ0oiLCJpZ25vcmVMaXN0IjpbXX0=