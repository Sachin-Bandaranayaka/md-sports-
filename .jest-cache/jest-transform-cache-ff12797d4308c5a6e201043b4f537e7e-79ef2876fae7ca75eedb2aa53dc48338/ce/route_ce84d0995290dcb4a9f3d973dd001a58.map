{"version":3,"names":["GET","cov_22fgou357z","f","s","fetchTransfersData","fetchTransfersDataFiltered","startDate","endDate","shopId","dateFilter","b","gte","Date","endDateTime","setHours","lte","whereClause","Object","keys","length","createdAt","OR","fromShopId","toShopId","transfers","_prisma","safeQuery","prisma","inventoryTransfer","findMany","select","id","status","fromShop","name","toShop","transferItems","where","undefined","orderBy","take","data","map","transfer","String","padStart","source","destination","charAt","toUpperCase","slice","date","toISOString","split","items","success","periodDays","setDate","getDate","_shopMiddleware","ShopAccessControl","withShopAccess","request","context","authResult","_auth","validateTokenPermission","isValid","_server","NextResponse","json","error","message","searchParams","URL","url","period","get","parseInt","cacheKey","isFiltered","console","time","cachedData","_cache","cacheService","timeEnd","log","meta","shopFiltered","fromCache","result","responseData","set","Error"],"sources":["/Users/sachin/Documents/md-sports-/src/app/api/dashboard/transfers/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { prisma, safeQuery } from '@/lib/prisma';\nimport { cacheService } from '@/lib/cache';\nimport { ShopAccessControl } from '@/lib/utils/shopMiddleware';\nimport { validateTokenPermission } from '@/lib/auth';\n\n// Filtered version of fetchTransfersData with date range support\nexport async function fetchTransfersDataFiltered(startDate?: string | null, endDate?: string | null, shopId?: string | null) {\n    // Build date filter\n    const dateFilter: any = {};\n    if (startDate) {\n        dateFilter.gte = new Date(startDate);\n    }\n    if (endDate) {\n        const endDateTime = new Date(endDate);\n        endDateTime.setHours(23, 59, 59, 999);\n        dateFilter.lte = endDateTime;\n    }\n\n    // Build where clause with date and shop filtering\n    const whereClause: any = {};\n    if (Object.keys(dateFilter).length > 0) {\n        whereClause.createdAt = dateFilter;\n    }\n    if (shopId) {\n        whereClause.OR = [\n            { fromShopId: shopId },\n            { toShopId: shopId }\n        ];\n    }\n\n    // Fetch inventory transfers with date and shop filtering\n    const transfers = await safeQuery(\n        () => prisma.inventoryTransfer.findMany({\n            select: {\n                id: true,\n                status: true,\n                createdAt: true,\n                fromShop: {\n                    select: { name: true }\n                },\n                toShop: {\n                    select: { name: true }\n                },\n                transferItems: {\n                    select: { id: true }\n                }\n            },\n            where: Object.keys(whereClause).length > 0 ? whereClause : undefined,\n            orderBy: {\n                createdAt: 'desc'\n            },\n            take: 10 // Show more transfers when filtering by date\n        }),\n        [],\n        'Failed to fetch filtered transfers data'\n    );\n\n    // Format the data for the frontend\n    const data = transfers.map(transfer => ({\n        id: `TR-${String(transfer.id).padStart(3, '0')}`,\n        source: transfer.fromShop.name,\n        destination: transfer.toShop.name,\n        status: transfer.status.charAt(0).toUpperCase() + transfer.status.slice(1),\n        date: transfer.createdAt.toISOString().split('T')[0],\n        items: transfer.transferItems.length\n    }));\n\n    return {\n        success: true,\n        data\n    };\n}\n\nexport async function fetchTransfersData(shopId?: string | null, periodDays?: number, startDate?: Date, endDate?: Date) {\n    // Build where clause for shop and date filtering\n    const whereClause: any = {};\n    \n    // Add shop filtering\n    if (shopId) {\n        whereClause.OR = [\n            { fromShopId: shopId },\n            { toShopId: shopId }\n        ];\n    }\n    \n    // Add date filtering based on period\n    if (periodDays) {\n        const startDate = new Date();\n        startDate.setDate(startDate.getDate() - periodDays);\n        startDate.setHours(0, 0, 0, 0);\n        \n        whereClause.createdAt = {\n            gte: startDate\n        };\n    }\n\n    // Fetch recent inventory transfers using Prisma\n    const transfers = await safeQuery(\n        () => prisma.inventoryTransfer.findMany({\n            select: {\n                id: true,\n                status: true,\n                createdAt: true,\n                fromShop: {\n                    select: { name: true }\n                },\n                toShop: {\n                    select: { name: true }\n                },\n                transferItems: {\n                    select: { id: true } // Selecting id to count items\n                }\n            },\n            where: Object.keys(whereClause).length > 0 ? whereClause : undefined,\n            orderBy: {\n                createdAt: 'desc'\n            },\n            take: 5 // Limit to 5 most recent transfers\n        }),\n        [], // Empty array fallback\n        'Failed to fetch transfers data'\n    );\n\n    // Format the data for the frontend\n    const data = transfers.map(transfer => ({\n        id: `TR-${String(transfer.id).padStart(3, '0')}`,\n        source: transfer.fromShop.name,\n        destination: transfer.toShop.name,\n        status: transfer.status.charAt(0).toUpperCase() + transfer.status.slice(1),\n        date: transfer.createdAt.toISOString().split('T')[0],\n        items: transfer.transferItems.length\n    }));\n\n    return {\n        success: true,\n        data\n    };\n}\n\nexport const GET = ShopAccessControl.withShopAccess(async (request: NextRequest, context) => {\n    try {\n        // Validate token and permissions\n        const authResult = await validateTokenPermission(request, 'view_transfers');\n        if (!authResult.isValid) {\n            return NextResponse.json({ error: authResult.message }, { status: 401 });\n        }\n\n        // Get query parameters\n        const { searchParams } = new URL(request.url);\n        const period = searchParams.get('period');\n        const periodDays = period ? parseInt(period) : undefined;\n\n        // Check cache first with shop context and period\n        const cacheKey = `dashboard:transfers:${context.isFiltered ? context.shopId : 'all'}${periodDays ? `:${periodDays}d` : ''}`;\n        console.time('cache check');\n        const cachedData = await cacheService.get(cacheKey);\n        console.timeEnd('cache check');\n\n        if (cachedData) {\n            console.log('âœ… Transfers data served from cache');\n            return NextResponse.json({\n                ...cachedData,\n                meta: {\n                    shopFiltered: context.isFiltered,\n                    shopId: context.shopId,\n                    period: periodDays,\n                    fromCache: true\n                }\n            });\n        }\n\n        console.log('ðŸ”„ Fetching fresh transfers data with shop context:', {\n            shopId: context.shopId,\n            isFiltered: context.isFiltered,\n            period: periodDays\n        });\n\n        const shopId = context.isFiltered ? context.shopId : null;\n\n        // Fetch transfers data with period filtering\n        const result = await fetchTransfersData(shopId, periodDays);\n\n        if (!result.success) {\n            return NextResponse.json(\n                {\n                    success: false,\n                    message: 'Failed to fetch transfers data',\n                    data: [],\n                    meta: {\n                        shopFiltered: context.isFiltered,\n                        shopId: context.shopId,\n                        period: periodDays\n                    }\n                },\n                { status: 500 }\n            );\n        }\n\n        const responseData = {\n            success: true,\n            data: result.data,\n            meta: {\n                shopFiltered: context.isFiltered,\n                shopId: context.shopId,\n                period: periodDays,\n                fromCache: false\n            }\n        };\n\n        // Cache the response for 2 minutes\n        console.time('cache set');\n        await cacheService.set(cacheKey, responseData, 120);\n        console.timeEnd('cache set');\n        console.log('ðŸ’¾ Transfers data cached for 2 minutes');\n\n        return NextResponse.json(responseData);\n\n    } catch (error) {\n        console.error('Error fetching transfers data:', error);\n        return NextResponse.json(\n            {\n                success: false,\n                message: 'Failed to load transfers data',\n                error: error instanceof Error ? error.message : String(error),\n                data: [], // Return empty array on error\n                meta: {\n                    shopFiltered: context.isFiltered,\n                    shopId: context.shopId\n                }\n            },\n            { status: 500 }\n        );\n    }\n});"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}