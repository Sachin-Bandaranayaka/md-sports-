9c1158d922839e4c89d2d892e4e77f9e
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _axios = /*#__PURE__*/ _interop_require_default(require("axios"));
const _chatbotService = require("../../src/services/chatbotService");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock axios
_globals.jest.mock("axios");
const mockAxios = _axios.default;
// Mock document.cookie for getCookie function
Object.defineProperty(global, "document", {
    value: {
        cookie: "",
        addEventListener: _globals.jest.fn(),
        removeEventListener: _globals.jest.fn()
    },
    writable: true
});
(0, _globals.describe)("ChatbotService", ()=>{
    (0, _globals.beforeEach)(()=>{
        _globals.jest.clearAllMocks();
        // Reset document.cookie
        global.document.cookie = "";
    });
    (0, _globals.afterEach)(()=>{
        _globals.jest.resetAllMocks();
    });
    (0, _globals.describe)("sendMessage", ()=>{
        const mockMessages = [
            {
                role: "user",
                content: "Hello, how can I help?"
            },
            {
                role: "assistant",
                content: "I can help you with your sports equipment needs."
            }
        ];
        const mockResponse = {
            role: "assistant",
            content: "Thank you for your message. How can I assist you today?"
        };
        (0, _globals.it)("should send message successfully when API key is configured", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValueOnce({
                data: mockResponse
            });
            const result = await _chatbotService.chatbotService.sendMessage(mockMessages);
            (0, _globals.expect)(result).toEqual(mockResponse);
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings");
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: mockMessages
            }, {
                headers: {
                    "Content-Type": "application/json"
                }
            });
        });
        (0, _globals.it)("should include CSRF token when available", async ()=>{
            // Set CSRF token in cookie
            global.document.cookie = "csrfToken=test-csrf-token; other=value";
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValueOnce({
                data: mockResponse
            });
            await _chatbotService.chatbotService.sendMessage(mockMessages);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: mockMessages
            }, {
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRF-Token": "test-csrf-token"
                }
            });
        });
        (0, _globals.it)("should throw error when API key is not configured", async ()=>{
            // Mock API key check failure
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: false,
                    isEmpty: true,
                    valueLength: 0
                }
            });
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Deepseek API key is not configured. Please set it in the AI Assistant settings page.");
            (0, _globals.expect)(mockAxios.post).not.toHaveBeenCalled();
        });
        (0, _globals.it)("should throw error when API key is empty", async ()=>{
            // Mock API key check with empty key
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: true,
                    valueLength: 0
                }
            });
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Deepseek API key is not configured. Please set it in the AI Assistant settings page.");
        });
        (0, _globals.it)("should handle API key check errors", async ()=>{
            // Mock API key check error
            const configError = new Error("Configuration check failed");
            mockAxios.get.mockRejectedValueOnce(configError);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Configuration check failed");
        });
        (0, _globals.it)("should handle axios error with response data", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock axios error with response
            const axiosError = {
                isAxiosError: true,
                response: {
                    status: 400,
                    data: {
                        error: "Invalid request format"
                    }
                },
                toJSON: ()=>({
                        message: "Request failed"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Invalid request format");
        });
        (0, _globals.it)("should handle 403 forbidden error", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock 403 error
            const axiosError = {
                isAxiosError: true,
                response: {
                    status: 403,
                    data: {}
                },
                toJSON: ()=>({
                        message: "Forbidden"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Access to the chatbot service was denied (403). Please check API key and configuration in AI Assistant settings, or a CSRF token issue might exist.");
        });
        (0, _globals.it)("should handle network errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock network error (no response)
            const axiosError = {
                isAxiosError: true,
                request: {},
                response: undefined,
                toJSON: ()=>({
                        message: "Network Error"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("No response received from the chatbot service. Please check your network connection and server status.");
        });
        (0, _globals.it)("should handle request setup errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock request setup error
            const axiosError = {
                isAxiosError: true,
                message: "Request setup failed",
                request: undefined,
                response: undefined,
                toJSON: ()=>({
                        message: "Request setup failed"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Error setting up chatbot request: Request setup failed");
        });
        (0, _globals.it)("should handle non-axios errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock non-axios error
            const genericError = new Error("Generic error");
            mockAxios.post.mockRejectedValueOnce(genericError);
            mockAxios.isAxiosError.mockReturnValue(false);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Generic error");
        });
        (0, _globals.it)("should handle errors without message", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock error without message
            const errorWithoutMessage = {};
            mockAxios.post.mockRejectedValueOnce(errorWithoutMessage);
            mockAxios.isAxiosError.mockReturnValue(false);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("An unexpected error occurred with the chatbot service.");
        });
        (0, _globals.it)("should handle API key check axios error with response data", async ()=>{
            // Mock API key check axios error
            const configAxiosError = {
                isAxiosError: true,
                response: {
                    data: {
                        message: "Settings API error"
                    }
                }
            };
            mockAxios.get.mockRejectedValueOnce(configAxiosError);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Settings API error");
        });
    });
    (0, _globals.describe)("getBusinessInfo", ()=>{
        (0, _globals.it)("should return business information", async ()=>{
            const businessInfo = await _chatbotService.chatbotService.getBusinessInfo();
            (0, _globals.expect)(businessInfo).toEqual({
                businessName: "MS Sports",
                inventoryCount: "Over 1,000 items",
                topSellingProducts: [
                    "Sports Shoes",
                    "Jerseys",
                    "Training Equipment"
                ],
                customerCount: "Over 500 registered customers",
                supplierCount: "50+ active suppliers"
            });
        });
        (0, _globals.it)("should return consistent data structure", async ()=>{
            const businessInfo = await _chatbotService.chatbotService.getBusinessInfo();
            (0, _globals.expect)(businessInfo).toHaveProperty("businessName");
            (0, _globals.expect)(businessInfo).toHaveProperty("inventoryCount");
            (0, _globals.expect)(businessInfo).toHaveProperty("topSellingProducts");
            (0, _globals.expect)(businessInfo).toHaveProperty("customerCount");
            (0, _globals.expect)(businessInfo).toHaveProperty("supplierCount");
            (0, _globals.expect)(Array.isArray(businessInfo.topSellingProducts)).toBe(true);
        });
    });
    (0, _globals.describe)("checkConfiguration", ()=>{
        (0, _globals.it)("should return configured when API key exists and is not empty", async ()=>{
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: false
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: true
            });
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings", {
                headers: {}
            });
        });
        (0, _globals.it)("should include CSRF token in configuration check", async ()=>{
            // Set CSRF token in cookie
            global.document.cookie = "csrfToken=config-csrf-token; other=value";
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: false
                }
            });
            await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings", {
                headers: {
                    "X-CSRF-Token": "config-csrf-token"
                }
            });
        });
        (0, _globals.it)("should return not configured when setting not found", async ()=>{
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: false,
                    exists: false
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "API key setting not found in database"
            });
        });
        (0, _globals.it)("should return not configured when API key is empty", async ()=>{
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: true
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "API key is empty. Please configure it in settings."
            });
        });
        (0, _globals.it)("should handle configuration check errors", async ()=>{
            const error = new Error("Network error");
            mockAxios.get.mockRejectedValueOnce(error);
            const consoleSpy = _globals.jest.spyOn(console, "error").mockImplementation();
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "Failed to check configuration. Please try again."
            });
            (0, _globals.expect)(consoleSpy).toHaveBeenCalledWith("Error checking chatbot configuration:", error);
            consoleSpy.mockRestore();
        });
    });
    (0, _globals.describe)("getCookie function (via sendMessage)", ()=>{
        (0, _globals.it)("should extract CSRF token from cookie string", async ()=>{
            // Set multiple cookies including CSRF token
            global.document.cookie = "sessionId=abc123; csrfToken=test-token; userId=456";
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValueOnce({
                data: {
                    role: "assistant",
                    content: "Response"
                }
            });
            await _chatbotService.chatbotService.sendMessage([
                {
                    role: "user",
                    content: "test"
                }
            ]);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: [
                    {
                        role: "user",
                        content: "test"
                    }
                ]
            }, {
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRF-Token": "test-token"
                }
            });
        });
        (0, _globals.it)("should handle missing CSRF token gracefully", async ()=>{
            // Set cookies without CSRF token
            global.document.cookie = "sessionId=abc123; userId=456";
            // Mock successful API key check
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValueOnce({
                data: {
                    role: "assistant",
                    content: "Response"
                }
            });
            await _chatbotService.chatbotService.sendMessage([
                {
                    role: "user",
                    content: "test"
                }
            ]);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: [
                    {
                        role: "user",
                        content: "test"
                    }
                ]
            }, {
                headers: {
                    "Content-Type": "application/json"
                }
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vRG9jdW1lbnRzL21kLXNwb3J0cy0vdGVzdHMvdW5pdC9jaGF0Ym90U2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBhZnRlckVhY2gsIGplc3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCBheGlvcywgeyBBeGlvc0Vycm9yIH0gZnJvbSAnYXhpb3MnO1xuaW1wb3J0IHsgY2hhdGJvdFNlcnZpY2UsIENoYXRNZXNzYWdlLCBDaGF0UmVzcG9uc2UgfSBmcm9tICdAL3NlcnZpY2VzL2NoYXRib3RTZXJ2aWNlJztcblxuLy8gTW9jayBheGlvc1xuamVzdC5tb2NrKCdheGlvcycpO1xuY29uc3QgbW9ja0F4aW9zID0gYXhpb3MgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIGF4aW9zPjtcblxuLy8gTW9jayBkb2N1bWVudC5jb29raWUgZm9yIGdldENvb2tpZSBmdW5jdGlvblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgJ2RvY3VtZW50Jywge1xuICB2YWx1ZToge1xuICAgIGNvb2tpZTogJycsXG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcbiAgfSxcbiAgd3JpdGFibGU6IHRydWUsXG59KTtcblxuZGVzY3JpYmUoJ0NoYXRib3RTZXJ2aWNlJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAvLyBSZXNldCBkb2N1bWVudC5jb29raWVcbiAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJyc7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXNldEFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kTWVzc2FnZScsICgpID0+IHtcbiAgICBjb25zdCBtb2NrTWVzc2FnZXM6IENoYXRNZXNzYWdlW10gPSBbXG4gICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ0hlbGxvLCBob3cgY2FuIEkgaGVscD8nIH0sXG4gICAgICB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAnSSBjYW4gaGVscCB5b3Ugd2l0aCB5b3VyIHNwb3J0cyBlcXVpcG1lbnQgbmVlZHMuJyB9XG4gICAgXTtcblxuICAgIGNvbnN0IG1vY2tSZXNwb25zZTogQ2hhdFJlc3BvbnNlID0ge1xuICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICBjb250ZW50OiAnVGhhbmsgeW91IGZvciB5b3VyIG1lc3NhZ2UuIEhvdyBjYW4gSSBhc3Npc3QgeW91IHRvZGF5PydcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIG1lc3NhZ2Ugc3VjY2Vzc2Z1bGx5IHdoZW4gQVBJIGtleSBpcyBjb25maWd1cmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgY2hhdGJvdCByZXNwb25zZVxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YTogbW9ja1Jlc3BvbnNlXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUmVzcG9uc2UpO1xuICAgICAgZXhwZWN0KG1vY2tBeGlvcy5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXBpL3Rlc3Qtc2V0dGluZ3MnKTtcbiAgICAgIGV4cGVjdChtb2NrQXhpb3MucG9zdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICcvYXBpL2NoYXRib3QnLFxuICAgICAgICB7IG1lc3NhZ2VzOiBtb2NrTWVzc2FnZXMgfSxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIENTUkYgdG9rZW4gd2hlbiBhdmFpbGFibGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBTZXQgQ1NSRiB0b2tlbiBpbiBjb29raWVcbiAgICAgIChnbG9iYWwuZG9jdW1lbnQgYXMgYW55KS5jb29raWUgPSAnY3NyZlRva2VuPXRlc3QtY3NyZi10b2tlbjsgb3RoZXI9dmFsdWUnO1xuXG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjaGF0Ym90IHJlc3BvbnNlXG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBkYXRhOiBtb2NrUmVzcG9uc2VcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpO1xuXG4gICAgICBleHBlY3QobW9ja0F4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnL2FwaS9jaGF0Ym90JyxcbiAgICAgICAgeyBtZXNzYWdlczogbW9ja01lc3NhZ2VzIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ1gtQ1NSRi1Ub2tlbic6ICd0ZXN0LWNzcmYtdG9rZW4nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIEFQSSBrZXkgaXMgbm90IGNvbmZpZ3VyZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIEFQSSBrZXkgY2hlY2sgZmFpbHVyZVxuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgaXNFbXB0eTogdHJ1ZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMFxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdEZWVwc2VlayBBUEkga2V5IGlzIG5vdCBjb25maWd1cmVkLiBQbGVhc2Ugc2V0IGl0IGluIHRoZSBBSSBBc3Npc3RhbnQgc2V0dGluZ3MgcGFnZS4nKTtcblxuICAgICAgZXhwZWN0KG1vY2tBeGlvcy5wb3N0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIEFQSSBrZXkgaXMgZW1wdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIEFQSSBrZXkgY2hlY2sgd2l0aCBlbXB0eSBrZXlcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogdHJ1ZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMFxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdEZWVwc2VlayBBUEkga2V5IGlzIG5vdCBjb25maWd1cmVkLiBQbGVhc2Ugc2V0IGl0IGluIHRoZSBBSSBBc3Npc3RhbnQgc2V0dGluZ3MgcGFnZS4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBrZXkgY2hlY2sgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBBUEkga2V5IGNoZWNrIGVycm9yXG4gICAgICBjb25zdCBjb25maWdFcnJvciA9IG5ldyBFcnJvcignQ29uZmlndXJhdGlvbiBjaGVjayBmYWlsZWQnKTtcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1JlamVjdGVkVmFsdWVPbmNlKGNvbmZpZ0Vycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdDb25maWd1cmF0aW9uIGNoZWNrIGZhaWxlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXhpb3MgZXJyb3Igd2l0aCByZXNwb25zZSBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIGF4aW9zIGVycm9yIHdpdGggcmVzcG9uc2VcbiAgICAgIGNvbnN0IGF4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmVxdWVzdCBmb3JtYXQnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0b0pTT046ICgpID0+ICh7IG1lc3NhZ2U6ICdSZXF1ZXN0IGZhaWxlZCcgfSlcbiAgICAgIH0gYXMgQXhpb3NFcnJvcjtcblxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKGF4aW9zRXJyb3IpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnSW52YWxpZCByZXF1ZXN0IGZvcm1hdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgNDAzIGZvcmJpZGRlbiBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayA0MDMgZXJyb3JcbiAgICAgIGNvbnN0IGF4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICBzdGF0dXM6IDQwMyxcbiAgICAgICAgICBkYXRhOiB7fVxuICAgICAgICB9LFxuICAgICAgICB0b0pTT046ICgpID0+ICh7IG1lc3NhZ2U6ICdGb3JiaWRkZW4nIH0pXG4gICAgICB9IGFzIEF4aW9zRXJyb3I7XG5cbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShheGlvc0Vycm9yKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKHRydWUpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0FjY2VzcyB0byB0aGUgY2hhdGJvdCBzZXJ2aWNlIHdhcyBkZW5pZWQgKDQwMykuIFBsZWFzZSBjaGVjayBBUEkga2V5IGFuZCBjb25maWd1cmF0aW9uIGluIEFJIEFzc2lzdGFudCBzZXR0aW5ncywgb3IgYSBDU1JGIHRva2VuIGlzc3VlIG1pZ2h0IGV4aXN0LicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgbmV0d29yayBlcnJvciAobm8gcmVzcG9uc2UpXG4gICAgICBjb25zdCBheGlvc0Vycm9yID0ge1xuICAgICAgICBpc0F4aW9zRXJyb3I6IHRydWUsXG4gICAgICAgIHJlcXVlc3Q6IHt9LFxuICAgICAgICByZXNwb25zZTogdW5kZWZpbmVkLFxuICAgICAgICB0b0pTT046ICgpID0+ICh7IG1lc3NhZ2U6ICdOZXR3b3JrIEVycm9yJyB9KVxuICAgICAgfSBhcyBBeGlvc0Vycm9yO1xuXG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UoYXhpb3NFcnJvcik7XG4gICAgICBtb2NrQXhpb3MuaXNBeGlvc0Vycm9yLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdObyByZXNwb25zZSByZWNlaXZlZCBmcm9tIHRoZSBjaGF0Ym90IHNlcnZpY2UuIFBsZWFzZSBjaGVjayB5b3VyIG5ldHdvcmsgY29ubmVjdGlvbiBhbmQgc2VydmVyIHN0YXR1cy4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJlcXVlc3Qgc2V0dXAgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHJlcXVlc3Qgc2V0dXAgZXJyb3JcbiAgICAgIGNvbnN0IGF4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JlcXVlc3Qgc2V0dXAgZmFpbGVkJyxcbiAgICAgICAgcmVxdWVzdDogdW5kZWZpbmVkLFxuICAgICAgICByZXNwb25zZTogdW5kZWZpbmVkLFxuICAgICAgICB0b0pTT046ICgpID0+ICh7IG1lc3NhZ2U6ICdSZXF1ZXN0IHNldHVwIGZhaWxlZCcgfSlcbiAgICAgIH0gYXMgQXhpb3NFcnJvcjtcblxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKGF4aW9zRXJyb3IpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnRXJyb3Igc2V0dGluZyB1cCBjaGF0Ym90IHJlcXVlc3Q6IFJlcXVlc3Qgc2V0dXAgZmFpbGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBub24tYXhpb3MgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIG5vbi1heGlvcyBlcnJvclxuICAgICAgY29uc3QgZ2VuZXJpY0Vycm9yID0gbmV3IEVycm9yKCdHZW5lcmljIGVycm9yJyk7XG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UoZ2VuZXJpY0Vycm9yKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdHZW5lcmljIGVycm9yJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgd2l0aG91dCBtZXNzYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIGVycm9yIHdpdGhvdXQgbWVzc2FnZVxuICAgICAgY29uc3QgZXJyb3JXaXRob3V0TWVzc2FnZSA9IHt9O1xuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKGVycm9yV2l0aG91dE1lc3NhZ2UpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQgd2l0aCB0aGUgY2hhdGJvdCBzZXJ2aWNlLicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQVBJIGtleSBjaGVjayBheGlvcyBlcnJvciB3aXRoIHJlc3BvbnNlIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIEFQSSBrZXkgY2hlY2sgYXhpb3MgZXJyb3JcbiAgICAgIGNvbnN0IGNvbmZpZ0F4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBtZXNzYWdlOiAnU2V0dGluZ3MgQVBJIGVycm9yJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBhcyBBeGlvc0Vycm9yO1xuXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShjb25maWdBeGlvc0Vycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdTZXR0aW5ncyBBUEkgZXJyb3InKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEJ1c2luZXNzSW5mbycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBidXNpbmVzcyBpbmZvcm1hdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1c2luZXNzSW5mbyA9IGF3YWl0IGNoYXRib3RTZXJ2aWNlLmdldEJ1c2luZXNzSW5mbygpO1xuXG4gICAgICBleHBlY3QoYnVzaW5lc3NJbmZvKS50b0VxdWFsKHtcbiAgICAgICAgYnVzaW5lc3NOYW1lOiAnTVMgU3BvcnRzJyxcbiAgICAgICAgaW52ZW50b3J5Q291bnQ6ICdPdmVyIDEsMDAwIGl0ZW1zJyxcbiAgICAgICAgdG9wU2VsbGluZ1Byb2R1Y3RzOiBbJ1Nwb3J0cyBTaG9lcycsICdKZXJzZXlzJywgJ1RyYWluaW5nIEVxdWlwbWVudCddLFxuICAgICAgICBjdXN0b21lckNvdW50OiAnT3ZlciA1MDAgcmVnaXN0ZXJlZCBjdXN0b21lcnMnLFxuICAgICAgICBzdXBwbGllckNvdW50OiAnNTArIGFjdGl2ZSBzdXBwbGllcnMnLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb25zaXN0ZW50IGRhdGEgc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYnVzaW5lc3NJbmZvID0gYXdhaXQgY2hhdGJvdFNlcnZpY2UuZ2V0QnVzaW5lc3NJbmZvKCk7XG5cbiAgICAgIGV4cGVjdChidXNpbmVzc0luZm8pLnRvSGF2ZVByb3BlcnR5KCdidXNpbmVzc05hbWUnKTtcbiAgICAgIGV4cGVjdChidXNpbmVzc0luZm8pLnRvSGF2ZVByb3BlcnR5KCdpbnZlbnRvcnlDb3VudCcpO1xuICAgICAgZXhwZWN0KGJ1c2luZXNzSW5mbykudG9IYXZlUHJvcGVydHkoJ3RvcFNlbGxpbmdQcm9kdWN0cycpO1xuICAgICAgZXhwZWN0KGJ1c2luZXNzSW5mbykudG9IYXZlUHJvcGVydHkoJ2N1c3RvbWVyQ291bnQnKTtcbiAgICAgIGV4cGVjdChidXNpbmVzc0luZm8pLnRvSGF2ZVByb3BlcnR5KCdzdXBwbGllckNvdW50Jyk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShidXNpbmVzc0luZm8udG9wU2VsbGluZ1Byb2R1Y3RzKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NoZWNrQ29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb25maWd1cmVkIHdoZW4gQVBJIGtleSBleGlzdHMgYW5kIGlzIG5vdCBlbXB0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZXhpc3RzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGF0Ym90U2VydmljZS5jaGVja0NvbmZpZ3VyYXRpb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IGlzQ29uZmlndXJlZDogdHJ1ZSB9KTtcbiAgICAgIGV4cGVjdChtb2NrQXhpb3MuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS90ZXN0LXNldHRpbmdzJywge1xuICAgICAgICBoZWFkZXJzOiB7fVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgQ1NSRiB0b2tlbiBpbiBjb25maWd1cmF0aW9uIGNoZWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2V0IENTUkYgdG9rZW4gaW4gY29va2llXG4gICAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJ2NzcmZUb2tlbj1jb25maWctY3NyZi10b2tlbjsgb3RoZXI9dmFsdWUnO1xuXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGV4aXN0czogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgY2hhdGJvdFNlcnZpY2UuY2hlY2tDb25maWd1cmF0aW9uKCk7XG5cbiAgICAgIGV4cGVjdChtb2NrQXhpb3MuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS90ZXN0LXNldHRpbmdzJywge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ1gtQ1NSRi1Ub2tlbic6ICdjb25maWctY3NyZi10b2tlbidcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBub3QgY29uZmlndXJlZCB3aGVuIHNldHRpbmcgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXhpc3RzOiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hhdGJvdFNlcnZpY2UuY2hlY2tDb25maWd1cmF0aW9uKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBpc0NvbmZpZ3VyZWQ6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiAnQVBJIGtleSBzZXR0aW5nIG5vdCBmb3VuZCBpbiBkYXRhYmFzZSdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbm90IGNvbmZpZ3VyZWQgd2hlbiBBUEkga2V5IGlzIGVtcHR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBleGlzdHM6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hhdGJvdFNlcnZpY2UuY2hlY2tDb25maWd1cmF0aW9uKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBpc0NvbmZpZ3VyZWQ6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiAnQVBJIGtleSBpcyBlbXB0eS4gUGxlYXNlIGNvbmZpZ3VyZSBpdCBpbiBzZXR0aW5ncy4nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmZpZ3VyYXRpb24gY2hlY2sgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKTtcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1JlamVjdGVkVmFsdWVPbmNlKGVycm9yKTtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGF0Ym90U2VydmljZS5jaGVja0NvbmZpZ3VyYXRpb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIGlzQ29uZmlndXJlZDogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gY2hlY2sgY29uZmlndXJhdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChjb25zb2xlU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRXJyb3IgY2hlY2tpbmcgY2hhdGJvdCBjb25maWd1cmF0aW9uOicsIGVycm9yKTtcblxuICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0Q29va2llIGZ1bmN0aW9uICh2aWEgc2VuZE1lc3NhZ2UpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZXh0cmFjdCBDU1JGIHRva2VuIGZyb20gY29va2llIHN0cmluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNldCBtdWx0aXBsZSBjb29raWVzIGluY2x1ZGluZyBDU1JGIHRva2VuXG4gICAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJ3Nlc3Npb25JZD1hYmMxMjM7IGNzcmZUb2tlbj10ZXN0LXRva2VuOyB1c2VySWQ9NDU2JztcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgY2hhdGJvdCByZXNwb25zZVxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgZGF0YTogeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudDogJ1Jlc3BvbnNlJyB9XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UoW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiAndGVzdCcgfV0pO1xuXG4gICAgICBleHBlY3QobW9ja0F4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnL2FwaS9jaGF0Ym90JyxcbiAgICAgICAgeyBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiAndGVzdCcgfV0gfSxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnWC1DU1JGLVRva2VuJzogJ3Rlc3QtdG9rZW4nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBDU1JGIHRva2VuIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBTZXQgY29va2llcyB3aXRob3V0IENTUkYgdG9rZW5cbiAgICAgIChnbG9iYWwuZG9jdW1lbnQgYXMgYW55KS5jb29raWUgPSAnc2Vzc2lvbklkPWFiYzEyMzsgdXNlcklkPTQ1Nic7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIGNoYXRib3QgcmVzcG9uc2VcbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGRhdGE6IHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6ICdSZXNwb25zZScgfVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dKTtcblxuICAgICAgZXhwZWN0KG1vY2tBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJy9hcGkvY2hhdGJvdCcsXG4gICAgICAgIHsgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsIm1vY2tBeGlvcyIsImF4aW9zIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnbG9iYWwiLCJ2YWx1ZSIsImNvb2tpZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJmbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ3cml0YWJsZSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJkb2N1bWVudCIsImFmdGVyRWFjaCIsInJlc2V0QWxsTW9ja3MiLCJtb2NrTWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsIm1vY2tSZXNwb25zZSIsIml0IiwiZ2V0IiwibW9ja1Jlc29sdmVkVmFsdWVPbmNlIiwiZGF0YSIsInN1Y2Nlc3MiLCJpc0VtcHR5IiwidmFsdWVMZW5ndGgiLCJwb3N0IiwicmVzdWx0IiwiY2hhdGJvdFNlcnZpY2UiLCJzZW5kTWVzc2FnZSIsImV4cGVjdCIsInRvRXF1YWwiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsIm1lc3NhZ2VzIiwiaGVhZGVycyIsInJlamVjdHMiLCJ0b1Rocm93Iiwibm90IiwidG9IYXZlQmVlbkNhbGxlZCIsImNvbmZpZ0Vycm9yIiwiRXJyb3IiLCJtb2NrUmVqZWN0ZWRWYWx1ZU9uY2UiLCJheGlvc0Vycm9yIiwiaXNBeGlvc0Vycm9yIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJlcnJvciIsInRvSlNPTiIsIm1lc3NhZ2UiLCJtb2NrUmV0dXJuVmFsdWUiLCJyZXF1ZXN0IiwidW5kZWZpbmVkIiwiZ2VuZXJpY0Vycm9yIiwiZXJyb3JXaXRob3V0TWVzc2FnZSIsImNvbmZpZ0F4aW9zRXJyb3IiLCJidXNpbmVzc0luZm8iLCJnZXRCdXNpbmVzc0luZm8iLCJidXNpbmVzc05hbWUiLCJpbnZlbnRvcnlDb3VudCIsInRvcFNlbGxpbmdQcm9kdWN0cyIsImN1c3RvbWVyQ291bnQiLCJzdXBwbGllckNvdW50IiwidG9IYXZlUHJvcGVydHkiLCJBcnJheSIsImlzQXJyYXkiLCJ0b0JlIiwiZXhpc3RzIiwiY2hlY2tDb25maWd1cmF0aW9uIiwiaXNDb25maWd1cmVkIiwiY29uc29sZVNweSIsInNweU9uIiwiY29uc29sZSIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsIm1vY2tSZXN0b3JlIl0sIm1hcHBpbmdzIjoiOzs7O3lCQUFrRTs4REFDaEM7Z0NBQ3dCOzs7Ozs7QUFFMUQsYUFBYTtBQUNiQSxhQUFJLENBQUNDLElBQUksQ0FBQztBQUNWLE1BQU1DLFlBQVlDLGNBQUs7QUFFdkIsOENBQThDO0FBQzlDQyxPQUFPQyxjQUFjLENBQUNDLFFBQVEsWUFBWTtJQUN4Q0MsT0FBTztRQUNMQyxRQUFRO1FBQ1JD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