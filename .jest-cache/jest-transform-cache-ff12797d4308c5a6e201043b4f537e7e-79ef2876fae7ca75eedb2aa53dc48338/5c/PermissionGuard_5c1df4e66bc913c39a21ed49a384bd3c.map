{"version":3,"names":["PermissionGuard","children","cov_1o1j67ucjt","f","user","isLoading","s","_useAuth","useAuth","checkRoutePermission","hasPermission","_usePermission","usePermission","router","_navigation","useRouter","_react","useEffect","b","push","hasAccess","console","warn","_jsxruntime","jsx","className","Fragment"],"sources":["/Users/sachin/Documents/md-sports-/src/components/auth/PermissionGuard.tsx"],"sourcesContent":["'use client';\n\nimport { ReactNode, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { usePermission } from '@/hooks/usePermission';\nimport { useAuth } from '@/hooks/useAuth';\n\ninterface PermissionGuardProps {\n    children: ReactNode;\n}\n\nexport default function PermissionGuard({ children }: PermissionGuardProps) {\n    const { user, isLoading } = useAuth();\n    const { checkRoutePermission, hasPermission } = usePermission();\n    const router = useRouter();\n\n    useEffect(() => {\n        // If authentication is still loading, do nothing\n        if (isLoading) return;\n\n        // Redirect to login if user is not authenticated\n        if (!user) {\n            router.push('/login');\n            return;\n        }\n\n        // Check permission for current route\n        const hasAccess = checkRoutePermission();\n        if (!hasAccess) {\n            console.warn('Access denied: Insufficient permissions');\n            // If user doesn't have dashboard access, redirect to sales invoices\n            if (!hasPermission('view_dashboard')) {\n                router.push('/invoices');\n            } else {\n                router.push('/dashboard');\n            }\n        }\n    }, [user, isLoading, router, checkRoutePermission]);\n\n    // Show nothing while checking authentication or permissions\n    if (isLoading || !user) {\n        return (\n            <div className=\"flex items-center justify-center min-h-screen\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\n            </div>\n        );\n    }\n\n    // Render children if user has necessary permissions\n    return <>{children}</>;\n}"],"mappings":"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","ignoreList":[]}