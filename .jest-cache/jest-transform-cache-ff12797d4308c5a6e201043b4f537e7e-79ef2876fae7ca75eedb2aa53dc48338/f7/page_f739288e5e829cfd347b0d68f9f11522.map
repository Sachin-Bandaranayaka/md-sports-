{"version":3,"names":["OptimizedInvoicesPage","queryClient","cov_1adkxrs4oh","s","_reactquery","QueryClient","defaultOptions","queries","staleTime","gcTime","refetchOnWindowFocus","refetchOnReconnect","retry","failureCount","error","f","b","status","mutations","InvoicePageContent","canManageInvoices","_usePermission","usePermission","filters","setFilters","_react","useState","page","limit","search","customer","data","invoicesData","isLoading","refetch","_useInvoicesOptimized","useInvoicesOptimized","invoices","handleRefresh","useCallback","_jsxruntime","jsx","className","jsxs","_card","Card","CardContent","message","_Button","Button","onClick","variant","_lucidereact","RefreshCw","size","disabled","Plus","CardHeader","CardTitle","length","_badge","Badge","map","invoice","invoiceNumber","customerName","Date","createdAt","toLocaleDateString","total","toFixed","id","QueryClientProvider","client","_reactquerydevtools","ReactQueryDevtools","initialIsOpen"],"sources":["/Users/sachin/Documents/md-sports-/src/app/invoices/optimized/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback } from 'react';\nimport { QueryClient, QueryClientProvider, useQuery } from '@tanstack/react-query';\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools';\nimport { Button } from '@/components/ui/Button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Plus, RefreshCw } from 'lucide-react';\nimport { useInvoicesOptimized } from '@/hooks/useInvoicesOptimized';\nimport { usePermission } from '@/hooks/usePermission';\n\n// Types\ninterface Invoice {\n    id: string | number;\n    invoiceNumber: string;\n    customerId: number;\n    customerName?: string;\n    total: number;\n    status: string;\n    paymentMethod: string;\n    createdAt: Date | string;\n    updatedAt: Date | string;\n}\n\n// Create a query client with optimized settings\nconst queryClient = new QueryClient({\n    defaultOptions: {\n        queries: {\n            staleTime: 30000, // 30 seconds\n            gcTime: 300000, // 5 minutes\n            refetchOnWindowFocus: false,\n            refetchOnReconnect: true,\n            retry: (failureCount, error: any) => {\n                if (error?.status >= 400 && error?.status < 500) {\n                    return false;\n                }\n                return failureCount < 3;\n            }\n        },\n        mutations: {\n            retry: 1\n        }\n    }\n});\n\n// Main invoice page component\nfunction InvoicePageContent() {\n    const { canManageInvoices } = usePermission();\n    \n    // State\n    const [filters, setFilters] = useState({\n        page: 1,\n        limit: 20,\n        search: '',\n        customer: '',\n        status: ''\n    });\n    \n    const {\n        data: invoicesData,\n        isLoading,\n        error,\n        refetch\n    } = useInvoicesOptimized(filters);\n    \n    const invoices = invoicesData?.data || [];\n    \n    // Handle refresh\n    const handleRefresh = useCallback(() => {\n        refetch();\n    }, [refetch]);\n    \n    if (isLoading) {\n        return (\n            <div className=\"container mx-auto px-4 py-8\">\n                <div className=\"animate-pulse\">\n                    <div className=\"h-8 bg-gray-200 rounded w-1/4 mb-6\"></div>\n                    <div className=\"h-96 bg-gray-200 rounded\"></div>\n                </div>\n            </div>\n        );\n    }\n\n    if (error) {\n        return (\n            <div className=\"container mx-auto px-4 py-8\">\n                <Card className=\"border-red-200 bg-red-50\">\n                    <CardContent className=\"p-6\">\n                        <div className=\"text-center\">\n                            <h3 className=\"text-lg font-semibold text-red-800 mb-2\">\n                                Error Loading Invoices\n                            </h3>\n                            <p className=\"text-red-600 mb-4\">\n                                {error.message || 'An unexpected error occurred'}\n                            </p>\n                            <Button onClick={handleRefresh} variant=\"outline\">\n                                <RefreshCw className=\"h-4 w-4 mr-2\" />\n                                Try Again\n                            </Button>\n                        </div>\n                    </CardContent>\n                </Card>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"container mx-auto px-4 py-6 space-y-6\">\n            {/* Header */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                <div>\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Sales Invoices (Optimized)</h1>\n                    <p className=\"text-gray-600\">\n                        Optimized version of the invoice management page\n                    </p>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                    <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={handleRefresh}\n                        disabled={isLoading}\n                    >\n                        <RefreshCw className=\"h-4 w-4 mr-2\" />\n                        Refresh\n                    </Button>\n                    {canManageInvoices() && (\n                        <Button disabled>\n                            <Plus className=\"h-4 w-4 mr-2\" />\n                            New Invoice\n                        </Button>\n                    )}\n                </div>\n            </div>\n\n            {/* Main Content */}\n            <Card>\n                <CardHeader>\n                        <CardTitle className=\"flex items-center gap-2\">\n                            Invoices\n                            {invoices.length > 0 && (\n                                <Badge variant=\"secondary\">\n                                    {invoices.length} total\n                                </Badge>\n                            )}\n                        </CardTitle>\n                </CardHeader>\n                <CardContent>\n                    {invoices.length === 0 ? (\n                        <div className=\"text-center py-8\">\n                            <p className=\"text-gray-500 mb-4\">No invoices found</p>\n                        </div>\n                    ) : (\n                        <div className=\"space-y-4\">\n                            {invoices.map((invoice: Invoice) => (\n                                <div key={invoice.id} className=\"p-4 border rounded-lg\">\n                                    <div className=\"flex justify-between items-start\">\n                                        <div>\n                                            <h3 className=\"font-medium\">{invoice.invoiceNumber}</h3>\n                                            <p className=\"text-sm text-gray-600\">\n                                                {invoice.customerName || 'Unknown Customer'}\n                                            </p>\n                                            <p className=\"text-sm text-gray-500\">\n                                                {new Date(invoice.createdAt).toLocaleDateString()}\n                                            </p>\n                    </div>\n                                        <div className=\"text-right\">\n                                            <p className=\"font-semibold\">${invoice.total.toFixed(2)}</p>\n                                            <Badge \n                                                variant={invoice.status === 'paid' ? 'default' : 'secondary'}\n                                                className=\"text-xs\"\n                                            >\n                                                {invoice.status}\n                                            </Badge>\n                                        </div>\n                                    </div>\n                                </div>\n                            ))}\n                            </div>\n                        )}\n                </CardContent>\n            </Card>\n        </div>\n    );\n}\n\n// Main page component with providers\nexport default function OptimizedInvoicesPage() {\n    return (\n        <QueryClientProvider client={queryClient}>\n            <InvoicePageContent />\n            <ReactQueryDevtools initialIsOpen={false} />\n        </QueryClientProvider>\n    );\n}"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}