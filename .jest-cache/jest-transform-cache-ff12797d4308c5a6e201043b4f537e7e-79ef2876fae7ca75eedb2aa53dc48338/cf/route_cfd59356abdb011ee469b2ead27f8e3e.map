{"version":3,"names":["GET","cov_1g350ag0j4","f","s","headers","wb","_xlsx","utils","book_new","ws","aoa_to_sheet","book_append_sheet","buffer","write","type","bookType","_server","NextResponse","status","error","console","json","success","message","Error","b","String"],"sources":["/Users/sachin/Documents/md-sports-/src/app/api/products/template/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport * as XLSX from 'xlsx';\n\nexport async function GET() {\n    try {\n        // Define the headers for the Excel template\n        const headers = [\n            'Name',\n            'SKU',\n            'Description',\n            'RetailPrice',\n            'CostPrice',\n            'Barcode',\n            'CategoryName',\n            'InitialQuantity',\n            'ShopName'\n        ];\n\n        // Create a new workbook and a worksheet\n        const wb = XLSX.utils.book_new();\n        const ws = XLSX.utils.aoa_to_sheet([headers]); // array_of_arrays_to_sheet\n\n        // Add the worksheet to the workbook\n        XLSX.utils.book_append_sheet(wb, ws, 'ProductsTemplate');\n\n        // Generate the Excel file buffer\n        const buffer = XLSX.write(wb, { type: 'buffer', bookType: 'xlsx' });\n\n        // Return the buffer as a downloadable file\n        return new NextResponse(buffer, {\n            status: 200,\n            headers: {\n                'Content-Disposition': 'attachment; filename=\"product_import_template.xlsx\"',\n                'Content-Type': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n            },\n        });\n\n    } catch (error) {\n        console.error('Error generating product import template:', error);\n        return NextResponse.json(\n            {\n                success: false,\n                message: 'Error generating product import template',\n                error: error instanceof Error ? error.message : String(error),\n            },\n            { status: 500 }\n        );\n    }\n} "],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAGsB;;;;;;WAAAA,GAAA;;;;;kCAHO;;;yEACP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEf,eAAeA,IAAA;EAAA;EAAAC,cAAA,GAAAC,CAAA;EAAAD,cAAA,GAAAE,CAAA;EAClB,IAAI;IACA;IACA,MAAMC,OAAA;IAAA;IAAA,CAAAH,cAAA,GAAAE,CAAA,QAAU,CACZ,QACA,OACA,eACA,eACA,aACA,WACA,gBACA,mBACA,WACH;IAED;IACA,MAAME,EAAA;IAAA;IAAA,CAAAJ,cAAA,GAAAE,CAAA,QAAKG,KAAA,CAAKC,KAAK,CAACC,QAAQ;IAC9B,MAAMC,EAAA;IAAA;IAAA,CAAAR,cAAA,GAAAE,CAAA,QAAKG,KAAA,CAAKC,KAAK,CAACG,YAAY,CAAC,CAACN,OAAA,CAAQ,IAAG;IAE/C;IAAA;IAAAH,cAAA,GAAAE,CAAA;IACAG,KAAA,CAAKC,KAAK,CAACI,iBAAiB,CAACN,EAAA,EAAII,EAAA,EAAI;IAErC;IACA,MAAMG,MAAA;IAAA;IAAA,CAAAX,cAAA,GAAAE,CAAA,QAASG,KAAA,CAAKO,KAAK,CAACR,EAAA,EAAI;MAAES,IAAA,EAAM;MAAUC,QAAA,EAAU;IAAO;IAEjE;IAAA;IAAAd,cAAA,GAAAE,CAAA;IACA,OAAO,IAAIa,OAAA,CAAAC,YAAY,CAACL,MAAA,EAAQ;MAC5BM,MAAA,EAAQ;MACRd,OAAA,EAAS;QACL,uBAAuB;QACvB,gBAAgB;MACpB;IACJ;EAEJ,EAAE,OAAOe,KAAA,EAAO;IAAA;IAAAlB,cAAA,GAAAE,CAAA;IACZiB,OAAA,CAAQD,KAAK,CAAC,6CAA6CA,KAAA;IAAA;IAAAlB,cAAA,GAAAE,CAAA;IAC3D,OAAOa,OAAA,CAAAC,YAAY,CAACI,IAAI,CACpB;MACIC,OAAA,EAAS;MACTC,OAAA,EAAS;MACTJ,KAAA,EAAOA,KAAA,YAAiBK,KAAA;MAAA;MAAA,CAAAvB,cAAA,GAAAwB,CAAA,WAAQN,KAAA,CAAMI,OAAO;MAAA;MAAA,CAAAtB,cAAA,GAAAwB,CAAA,WAAGC,MAAA,CAAOP,KAAA;IAC3D,GACA;MAAED,MAAA,EAAQ;IAAI;EAEtB;AACJ","ignoreList":[]}