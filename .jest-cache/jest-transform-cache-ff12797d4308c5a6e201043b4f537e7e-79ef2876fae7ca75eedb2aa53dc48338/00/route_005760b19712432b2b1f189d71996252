c842b40ebf27be512ae54a8e7322c659
"use strict";

/* istanbul ignore next */
function cov_2olsk8ksg4() {
  var path = "/Users/sachin/Documents/md-sports-/src/app/api/reports/product-performance/route.ts";
  var hash = "c84d142d9b11f10e4e0cb459cbd246fe770b0ba0";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/sachin/Documents/md-sports-/src/app/api/reports/product-performance/route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 19
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 38
        }
      },
      "4": {
        start: {
          line: 12,
          column: 16
        },
        end: {
          line: 12,
          column: 49
        }
      },
      "5": {
        start: {
          line: 14,
          column: 4
        },
        end: {
          line: 119,
          column: 5
        }
      },
      "6": {
        start: {
          line: 15,
          column: 20
        },
        end: {
          line: 15,
          column: 30
        }
      },
      "7": {
        start: {
          line: 16,
          column: 32
        },
        end: {
          line: 16,
          column: 78
        }
      },
      "8": {
        start: {
          line: 17,
          column: 31
        },
        end: {
          line: 17,
          column: 98
        }
      },
      "9": {
        start: {
          line: 18,
          column: 29
        },
        end: {
          line: 36,
          column: 10
        }
      },
      "10": {
        start: {
          line: 37,
          column: 8
        },
        end: {
          line: 53,
          column: 9
        }
      },
      "11": {
        start: {
          line: 38,
          column: 12
        },
        end: {
          line: 52,
          column: 15
        }
      },
      "12": {
        start: {
          line: 55,
          column: 35
        },
        end: {
          line: 55,
          column: 37
        }
      },
      "13": {
        start: {
          line: 56,
          column: 8
        },
        end: {
          line: 71,
          column: 11
        }
      },
      "14": {
        start: {
          line: 57,
          column: 36
        },
        end: {
          line: 57,
          column: 61
        }
      },
      "15": {
        start: {
          line: 58,
          column: 12
        },
        end: {
          line: 68,
          column: 13
        }
      },
      "16": {
        start: {
          line: 59,
          column: 16
        },
        end: {
          line: 67,
          column: 18
        }
      },
      "17": {
        start: {
          line: 69,
          column: 12
        },
        end: {
          line: 69,
          column: 83
        }
      },
      "18": {
        start: {
          line: 70,
          column: 12
        },
        end: {
          line: 70,
          column: 79
        }
      },
      "19": {
        start: {
          line: 73,
          column: 48
        },
        end: {
          line: 73,
          column: 50
        }
      },
      "20": {
        start: {
          line: 74,
          column: 8
        },
        end: {
          line: 87,
          column: 11
        }
      },
      "21": {
        start: {
          line: 75,
          column: 36
        },
        end: {
          line: 75,
          column: 56
        }
      },
      "22": {
        start: {
          line: 76,
          column: 12
        },
        end: {
          line: 83,
          column: 13
        }
      },
      "23": {
        start: {
          line: 77,
          column: 16
        },
        end: {
          line: 82,
          column: 18
        }
      },
      "24": {
        start: {
          line: 84,
          column: 12
        },
        end: {
          line: 84,
          column: 84
        }
      },
      "25": {
        start: {
          line: 85,
          column: 12
        },
        end: {
          line: 85,
          column: 108
        }
      },
      "26": {
        start: {
          line: 86,
          column: 12
        },
        end: {
          line: 86,
          column: 112
        }
      },
      "27": {
        start: {
          line: 89,
          column: 8
        },
        end: {
          line: 91,
          column: 9
        }
      },
      "28": {
        start: {
          line: 90,
          column: 12
        },
        end: {
          line: 90,
          column: 116
        }
      },
      "29": {
        start: {
          line: 90,
          column: 75
        },
        end: {
          line: 90,
          column: 114
        }
      },
      "30": {
        start: {
          line: 93,
          column: 30
        },
        end: {
          line: 93,
          column: 134
        }
      },
      "31": {
        start: {
          line: 93,
          column: 90
        },
        end: {
          line: 93,
          column: 133
        }
      },
      "32": {
        start: {
          line: 94,
          column: 36
        },
        end: {
          line: 94,
          column: 101
        }
      },
      "33": {
        start: {
          line: 94,
          column: 69
        },
        end: {
          line: 94,
          column: 97
        }
      },
      "34": {
        start: {
          line: 95,
          column: 41
        },
        end: {
          line: 95,
          column: 109
        }
      },
      "35": {
        start: {
          line: 95,
          column: 74
        },
        end: {
          line: 95,
          column: 105
        }
      },
      "36": {
        start: {
          line: 96,
          column: 8
        },
        end: {
          line: 109,
          column: 11
        }
      },
      "37": {
        start: {
          line: 111,
          column: 8
        },
        end: {
          line: 111,
          column: 75
        }
      },
      "38": {
        start: {
          line: 112,
          column: 8
        },
        end: {
          line: 118,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "GET",
        decl: {
          start: {
            line: 13,
            column: 15
          },
          end: {
            line: 13,
            column: 18
          }
        },
        loc: {
          start: {
            line: 13,
            column: 28
          },
          end: {
            line: 120,
            column: 1
          }
        },
        line: 13
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 56,
            column: 29
          },
          end: {
            line: 56,
            column: 30
          }
        },
        loc: {
          start: {
            line: 56,
            column: 37
          },
          end: {
            line: 71,
            column: 9
          }
        },
        line: 56
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 74,
            column: 50
          },
          end: {
            line: 74,
            column: 51
          }
        },
        loc: {
          start: {
            line: 74,
            column: 61
          },
          end: {
            line: 87,
            column: 9
          }
        },
        line: 74
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 90,
            column: 67
          },
          end: {
            line: 90,
            column: 68
          }
        },
        loc: {
          start: {
            line: 90,
            column: 75
          },
          end: {
            line: 90,
            column: 114
          }
        },
        line: 90
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 93,
            column: 82
          },
          end: {
            line: 93,
            column: 83
          }
        },
        loc: {
          start: {
            line: 93,
            column: 90
          },
          end: {
            line: 93,
            column: 133
          }
        },
        line: 93
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 94,
            column: 57
          },
          end: {
            line: 94,
            column: 58
          }
        },
        loc: {
          start: {
            line: 94,
            column: 69
          },
          end: {
            line: 94,
            column: 97
          }
        },
        line: 94
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 95,
            column: 62
          },
          end: {
            line: 95,
            column: 63
          }
        },
        loc: {
          start: {
            line: 95,
            column: 74
          },
          end: {
            line: 95,
            column: 105
          }
        },
        line: 95
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 37,
            column: 8
          },
          end: {
            line: 53,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 37,
            column: 8
          },
          end: {
            line: 53,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 37
      },
      "1": {
        loc: {
          start: {
            line: 58,
            column: 12
          },
          end: {
            line: 68,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 58,
            column: 12
          },
          end: {
            line: 68,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 58
      },
      "2": {
        loc: {
          start: {
            line: 64,
            column: 34
          },
          end: {
            line: 64,
            column: 80
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 64,
            column: 34
          },
          end: {
            line: 64,
            column: 61
          }
        }, {
          start: {
            line: 64,
            column: 65
          },
          end: {
            line: 64,
            column: 80
          }
        }],
        line: 64
      },
      "3": {
        loc: {
          start: {
            line: 76,
            column: 12
          },
          end: {
            line: 83,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 76,
            column: 12
          },
          end: {
            line: 83,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 76
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/Users/sachin/Documents/md-sports-/src/app/api/reports/product-performance/route.ts"],
      sourcesContent: ["import { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\n\nexport async function GET(request: Request) {\n    try {\n        const now = new Date();\n        const firstDayOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n        const lastDayOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59, 999);\n\n        const invoiceItems = await prisma.invoiceItem.findMany({\n            where: {\n                invoice: {\n                    status: 'paid', // Consider only paid invoices for sales performance\n                    createdAt: {\n                        gte: firstDayOfMonth,\n                        lte: lastDayOfMonth,\n                    },\n                },\n            },\n            include: {\n                product: {\n                    include: {\n                        category: true, // Include category information\n                    },\n                },\n                invoice: true, // To confirm invoice date and status if needed for double check\n            },\n        });\n\n        if (invoiceItems.length === 0) {\n            return NextResponse.json({\n                success: true,\n                details: [], // Will be an array of categories, each with a products array\n                summary: {\n                    month: now.toLocaleString('default', { month: 'long' }),\n                    year: now.getFullYear(),\n                    overallTotalRevenue: 0,\n                    overallTotalProductsSold: 0,\n                    numberOfCategoriesWithSales: 0\n                },\n                generatedAt: new Date().toISOString(),\n                message: 'No sales data found for products in the current month.'\n            });\n        }\n\n        // Aggregate data by product\n        const productPerformance: Record<string, {\n            productId: number;\n            productName: string;\n            sku: string | null;\n            categoryId: number | null;\n            categoryName: string;\n            totalQuantitySold: number;\n            totalSalesAmount: number;\n        }> = {};\n\n        invoiceItems.forEach(item => {\n            const productIdString = item.productId.toString(); // Use string for object key\n            if (!productPerformance[productIdString]) {\n                productPerformance[productIdString] = {\n                    productId: item.productId,\n                    productName: item.product.name,\n                    sku: item.product.sku,\n                    categoryId: item.product.categoryId,\n                    categoryName: item.product.category?.name || 'Uncategorized',\n                    totalQuantitySold: 0,\n                    totalSalesAmount: 0,\n                };\n            }\n            productPerformance[productIdString].totalQuantitySold += item.quantity;\n            productPerformance[productIdString].totalSalesAmount += item.total;\n        });\n\n        // Further group by category\n        const categoryPerformanceIntermediate: Record<string, { categoryName: string; products: any[]; totalCategorySales: number; totalCategoryQuantity: number; }> = {};\n        Object.values(productPerformance).forEach(product => {\n            const categoryNameKey = product.categoryName; // Use category name as key\n\n            if (!categoryPerformanceIntermediate[categoryNameKey]) {\n                categoryPerformanceIntermediate[categoryNameKey] = {\n                    categoryName: product.categoryName,\n                    products: [],\n                    totalCategorySales: 0,\n                    totalCategoryQuantity: 0,\n                };\n            }\n            categoryPerformanceIntermediate[categoryNameKey].products.push(product);\n            categoryPerformanceIntermediate[categoryNameKey].totalCategorySales += product.totalSalesAmount;\n            categoryPerformanceIntermediate[categoryNameKey].totalCategoryQuantity += product.totalQuantitySold;\n        });\n\n        // Sort products within each category by sales amount\n        for (const catName in categoryPerformanceIntermediate) {\n            categoryPerformanceIntermediate[catName].products.sort((a, b) => b.totalSalesAmount - a.totalSalesAmount);\n        }\n\n        // Convert intermediate object to array and sort categories by sales amount\n        const reportDetails = Object.values(categoryPerformanceIntermediate).sort((a, b) => b.totalCategorySales - a.totalCategorySales);\n\n        const overallTotalRevenue = reportDetails.reduce((sum, cat) => sum + cat.totalCategorySales, 0);\n        const overallTotalProductsSold = reportDetails.reduce((sum, cat) => sum + cat.totalCategoryQuantity, 0);\n\n        return NextResponse.json({\n            success: true,\n            details: reportDetails, // Array of categories, each with products array\n            summary: {\n                month: now.toLocaleString('default', { month: 'long' }),\n                year: now.getFullYear(),\n                overallTotalRevenue: overallTotalRevenue,\n                overallTotalProductsSold: overallTotalProductsSold,\n                numberOfCategoriesWithSales: reportDetails.length,\n            },\n            generatedAt: new Date().toISOString(),\n        });\n\n    } catch (error: any) {\n        console.error('Error fetching product performance report:', error);\n        return NextResponse.json(\n            { success: false, message: 'Failed to fetch product performance report', error: error.message },\n            { status: 500 }\n        );\n    }\n}"],
      names: ["GET", "request", "now", "Date", "firstDayOfMonth", "getFullYear", "getMonth", "lastDayOfMonth", "invoiceItems", "prisma", "invoiceItem", "findMany", "where", "invoice", "status", "createdAt", "gte", "lte", "include", "product", "category", "length", "NextResponse", "json", "success", "details", "summary", "month", "toLocaleString", "year", "overallTotalRevenue", "overallTotalProductsSold", "numberOfCategoriesWithSales", "generatedAt", "toISOString", "message", "productPerformance", "forEach", "item", "productIdString", "productId", "toString", "productName", "name", "sku", "categoryId", "categoryName", "totalQuantitySold", "totalSalesAmount", "quantity", "total", "categoryPerformanceIntermediate", "Object", "values", "categoryNameKey", "products", "totalCategorySales", "totalCategoryQuantity", "push", "catName", "sort", "a", "b", "reportDetails", "reduce", "sum", "cat", "error", "console"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "c84d142d9b11f10e4e0cb459cbd246fe770b0ba0"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2olsk8ksg4 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2olsk8ksg4();
cov_2olsk8ksg4().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_2olsk8ksg4().s[1]++;
Object.defineProperty(exports, "GET", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_2olsk8ksg4().f[0]++;
    cov_2olsk8ksg4().s[2]++;
    return GET;
  }
});
const _server =
/* istanbul ignore next */
(cov_2olsk8ksg4().s[3]++, require("next/server"));
const _prisma =
/* istanbul ignore next */
(cov_2olsk8ksg4().s[4]++, require("../../../../lib/prisma"));
async function GET(request) {
  /* istanbul ignore next */
  cov_2olsk8ksg4().f[1]++;
  cov_2olsk8ksg4().s[5]++;
  try {
    const now =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[6]++, new Date());
    const firstDayOfMonth =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[7]++, new Date(now.getFullYear(), now.getMonth(), 1));
    const lastDayOfMonth =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[8]++, new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59, 999));
    const invoiceItems =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[9]++, await _prisma.prisma.invoiceItem.findMany({
      where: {
        invoice: {
          status: "paid",
          createdAt: {
            gte: firstDayOfMonth,
            lte: lastDayOfMonth
          }
        }
      },
      include: {
        product: {
          include: {
            category: true
          }
        },
        invoice: true
      }
    }));
    /* istanbul ignore next */
    cov_2olsk8ksg4().s[10]++;
    if (invoiceItems.length === 0) {
      /* istanbul ignore next */
      cov_2olsk8ksg4().b[0][0]++;
      cov_2olsk8ksg4().s[11]++;
      return _server.NextResponse.json({
        success: true,
        details: [],
        summary: {
          month: now.toLocaleString("default", {
            month: "long"
          }),
          year: now.getFullYear(),
          overallTotalRevenue: 0,
          overallTotalProductsSold: 0,
          numberOfCategoriesWithSales: 0
        },
        generatedAt: new Date().toISOString(),
        message: "No sales data found for products in the current month."
      });
    } else
    /* istanbul ignore next */
    {
      cov_2olsk8ksg4().b[0][1]++;
    }
    // Aggregate data by product
    const productPerformance =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[12]++, {});
    /* istanbul ignore next */
    cov_2olsk8ksg4().s[13]++;
    invoiceItems.forEach(item => {
      /* istanbul ignore next */
      cov_2olsk8ksg4().f[2]++;
      const productIdString =
      /* istanbul ignore next */
      (cov_2olsk8ksg4().s[14]++, item.productId.toString()); // Use string for object key
      /* istanbul ignore next */
      cov_2olsk8ksg4().s[15]++;
      if (!productPerformance[productIdString]) {
        /* istanbul ignore next */
        cov_2olsk8ksg4().b[1][0]++;
        cov_2olsk8ksg4().s[16]++;
        productPerformance[productIdString] = {
          productId: item.productId,
          productName: item.product.name,
          sku: item.product.sku,
          categoryId: item.product.categoryId,
          categoryName:
          /* istanbul ignore next */
          (cov_2olsk8ksg4().b[2][0]++, item.product.category?.name) ||
          /* istanbul ignore next */
          (cov_2olsk8ksg4().b[2][1]++, "Uncategorized"),
          totalQuantitySold: 0,
          totalSalesAmount: 0
        };
      } else
      /* istanbul ignore next */
      {
        cov_2olsk8ksg4().b[1][1]++;
      }
      cov_2olsk8ksg4().s[17]++;
      productPerformance[productIdString].totalQuantitySold += item.quantity;
      /* istanbul ignore next */
      cov_2olsk8ksg4().s[18]++;
      productPerformance[productIdString].totalSalesAmount += item.total;
    });
    // Further group by category
    const categoryPerformanceIntermediate =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[19]++, {});
    /* istanbul ignore next */
    cov_2olsk8ksg4().s[20]++;
    Object.values(productPerformance).forEach(product => {
      /* istanbul ignore next */
      cov_2olsk8ksg4().f[3]++;
      const categoryNameKey =
      /* istanbul ignore next */
      (cov_2olsk8ksg4().s[21]++, product.categoryName); // Use category name as key
      /* istanbul ignore next */
      cov_2olsk8ksg4().s[22]++;
      if (!categoryPerformanceIntermediate[categoryNameKey]) {
        /* istanbul ignore next */
        cov_2olsk8ksg4().b[3][0]++;
        cov_2olsk8ksg4().s[23]++;
        categoryPerformanceIntermediate[categoryNameKey] = {
          categoryName: product.categoryName,
          products: [],
          totalCategorySales: 0,
          totalCategoryQuantity: 0
        };
      } else
      /* istanbul ignore next */
      {
        cov_2olsk8ksg4().b[3][1]++;
      }
      cov_2olsk8ksg4().s[24]++;
      categoryPerformanceIntermediate[categoryNameKey].products.push(product);
      /* istanbul ignore next */
      cov_2olsk8ksg4().s[25]++;
      categoryPerformanceIntermediate[categoryNameKey].totalCategorySales += product.totalSalesAmount;
      /* istanbul ignore next */
      cov_2olsk8ksg4().s[26]++;
      categoryPerformanceIntermediate[categoryNameKey].totalCategoryQuantity += product.totalQuantitySold;
    });
    // Sort products within each category by sales amount
    /* istanbul ignore next */
    cov_2olsk8ksg4().s[27]++;
    for (const catName in categoryPerformanceIntermediate) {
      /* istanbul ignore next */
      cov_2olsk8ksg4().s[28]++;
      categoryPerformanceIntermediate[catName].products.sort((a, b) => {
        /* istanbul ignore next */
        cov_2olsk8ksg4().f[4]++;
        cov_2olsk8ksg4().s[29]++;
        return b.totalSalesAmount - a.totalSalesAmount;
      });
    }
    // Convert intermediate object to array and sort categories by sales amount
    const reportDetails =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[30]++, Object.values(categoryPerformanceIntermediate).sort((a, b) => {
      /* istanbul ignore next */
      cov_2olsk8ksg4().f[5]++;
      cov_2olsk8ksg4().s[31]++;
      return b.totalCategorySales - a.totalCategorySales;
    }));
    const overallTotalRevenue =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[32]++, reportDetails.reduce((sum, cat) => {
      /* istanbul ignore next */
      cov_2olsk8ksg4().f[6]++;
      cov_2olsk8ksg4().s[33]++;
      return sum + cat.totalCategorySales;
    }, 0));
    const overallTotalProductsSold =
    /* istanbul ignore next */
    (cov_2olsk8ksg4().s[34]++, reportDetails.reduce((sum, cat) => {
      /* istanbul ignore next */
      cov_2olsk8ksg4().f[7]++;
      cov_2olsk8ksg4().s[35]++;
      return sum + cat.totalCategoryQuantity;
    }, 0));
    /* istanbul ignore next */
    cov_2olsk8ksg4().s[36]++;
    return _server.NextResponse.json({
      success: true,
      details: reportDetails,
      summary: {
        month: now.toLocaleString("default", {
          month: "long"
        }),
        year: now.getFullYear(),
        overallTotalRevenue: overallTotalRevenue,
        overallTotalProductsSold: overallTotalProductsSold,
        numberOfCategoriesWithSales: reportDetails.length
      },
      generatedAt: new Date().toISOString()
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_2olsk8ksg4().s[37]++;
    console.error("Error fetching product performance report:", error);
    /* istanbul ignore next */
    cov_2olsk8ksg4().s[38]++;
    return _server.NextResponse.json({
      success: false,
      message: "Failed to fetch product performance report",
      error: error.message
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMm9sc2s4a3NnNCIsImFjdHVhbENvdmVyYWdlIiwicyIsIkdFVCIsInJlcXVlc3QiLCJmIiwibm93IiwiRGF0ZSIsImZpcnN0RGF5T2ZNb250aCIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJsYXN0RGF5T2ZNb250aCIsImludm9pY2VJdGVtcyIsIl9wcmlzbWEiLCJwcmlzbWEiLCJpbnZvaWNlSXRlbSIsImZpbmRNYW55Iiwid2hlcmUiLCJpbnZvaWNlIiwic3RhdHVzIiwiY3JlYXRlZEF0IiwiZ3RlIiwibHRlIiwiaW5jbHVkZSIsInByb2R1Y3QiLCJjYXRlZ29yeSIsImxlbmd0aCIsImIiLCJfc2VydmVyIiwiTmV4dFJlc3BvbnNlIiwianNvbiIsInN1Y2Nlc3MiLCJkZXRhaWxzIiwic3VtbWFyeSIsIm1vbnRoIiwidG9Mb2NhbGVTdHJpbmciLCJ5ZWFyIiwib3ZlcmFsbFRvdGFsUmV2ZW51ZSIsIm92ZXJhbGxUb3RhbFByb2R1Y3RzU29sZCIsIm51bWJlck9mQ2F0ZWdvcmllc1dpdGhTYWxlcyIsImdlbmVyYXRlZEF0IiwidG9JU09TdHJpbmciLCJtZXNzYWdlIiwicHJvZHVjdFBlcmZvcm1hbmNlIiwiZm9yRWFjaCIsIml0ZW0iLCJwcm9kdWN0SWRTdHJpbmciLCJwcm9kdWN0SWQiLCJ0b1N0cmluZyIsInByb2R1Y3ROYW1lIiwibmFtZSIsInNrdSIsImNhdGVnb3J5SWQiLCJjYXRlZ29yeU5hbWUiLCJ0b3RhbFF1YW50aXR5U29sZCIsInRvdGFsU2FsZXNBbW91bnQiLCJxdWFudGl0eSIsInRvdGFsIiwiY2F0ZWdvcnlQZXJmb3JtYW5jZUludGVybWVkaWF0ZSIsIk9iamVjdCIsInZhbHVlcyIsImNhdGVnb3J5TmFtZUtleSIsInByb2R1Y3RzIiwidG90YWxDYXRlZ29yeVNhbGVzIiwidG90YWxDYXRlZ29yeVF1YW50aXR5IiwicHVzaCIsImNhdE5hbWUiLCJzb3J0IiwiYSIsInJlcG9ydERldGFpbHMiLCJyZWR1Y2UiLCJzdW0iLCJjYXQiLCJlcnJvciIsImNvbnNvbGUiXSwic291cmNlcyI6WyIvVXNlcnMvc2FjaGluL0RvY3VtZW50cy9tZC1zcG9ydHMtL3NyYy9hcHAvYXBpL3JlcG9ydHMvcHJvZHVjdC1wZXJmb3JtYW5jZS9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBjb25zdCBmaXJzdERheU9mTW9udGggPSBuZXcgRGF0ZShub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCksIDEpO1xuICAgICAgICBjb25zdCBsYXN0RGF5T2ZNb250aCA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCBub3cuZ2V0TW9udGgoKSArIDEsIDAsIDIzLCA1OSwgNTksIDk5OSk7XG5cbiAgICAgICAgY29uc3QgaW52b2ljZUl0ZW1zID0gYXdhaXQgcHJpc21hLmludm9pY2VJdGVtLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgaW52b2ljZToge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdwYWlkJywgLy8gQ29uc2lkZXIgb25seSBwYWlkIGludm9pY2VzIGZvciBzYWxlcyBwZXJmb3JtYW5jZVxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGd0ZTogZmlyc3REYXlPZk1vbnRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBsYXN0RGF5T2ZNb250aCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICBwcm9kdWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLCAvLyBJbmNsdWRlIGNhdGVnb3J5IGluZm9ybWF0aW9uXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpbnZvaWNlOiB0cnVlLCAvLyBUbyBjb25maXJtIGludm9pY2UgZGF0ZSBhbmQgc3RhdHVzIGlmIG5lZWRlZCBmb3IgZG91YmxlIGNoZWNrXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaW52b2ljZUl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRldGFpbHM6IFtdLCAvLyBXaWxsIGJlIGFuIGFycmF5IG9mIGNhdGVnb3JpZXMsIGVhY2ggd2l0aCBhIHByb2R1Y3RzIGFycmF5XG4gICAgICAgICAgICAgICAgc3VtbWFyeToge1xuICAgICAgICAgICAgICAgICAgICBtb250aDogbm93LnRvTG9jYWxlU3RyaW5nKCdkZWZhdWx0JywgeyBtb250aDogJ2xvbmcnIH0pLFxuICAgICAgICAgICAgICAgICAgICB5ZWFyOiBub3cuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmFsbFRvdGFsUmV2ZW51ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmFsbFRvdGFsUHJvZHVjdHNTb2xkOiAwLFxuICAgICAgICAgICAgICAgICAgICBudW1iZXJPZkNhdGVnb3JpZXNXaXRoU2FsZXM6IDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdlbmVyYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ05vIHNhbGVzIGRhdGEgZm91bmQgZm9yIHByb2R1Y3RzIGluIHRoZSBjdXJyZW50IG1vbnRoLidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWdncmVnYXRlIGRhdGEgYnkgcHJvZHVjdFxuICAgICAgICBjb25zdCBwcm9kdWN0UGVyZm9ybWFuY2U6IFJlY29yZDxzdHJpbmcsIHtcbiAgICAgICAgICAgIHByb2R1Y3RJZDogbnVtYmVyO1xuICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHN0cmluZztcbiAgICAgICAgICAgIHNrdTogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgICAgIGNhdGVnb3J5SWQ6IG51bWJlciB8IG51bGw7XG4gICAgICAgICAgICBjYXRlZ29yeU5hbWU6IHN0cmluZztcbiAgICAgICAgICAgIHRvdGFsUXVhbnRpdHlTb2xkOiBudW1iZXI7XG4gICAgICAgICAgICB0b3RhbFNhbGVzQW1vdW50OiBudW1iZXI7XG4gICAgICAgIH0+ID0ge307XG5cbiAgICAgICAgaW52b2ljZUl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwcm9kdWN0SWRTdHJpbmcgPSBpdGVtLnByb2R1Y3RJZC50b1N0cmluZygpOyAvLyBVc2Ugc3RyaW5nIGZvciBvYmplY3Qga2V5XG4gICAgICAgICAgICBpZiAoIXByb2R1Y3RQZXJmb3JtYW5jZVtwcm9kdWN0SWRTdHJpbmddKSB7XG4gICAgICAgICAgICAgICAgcHJvZHVjdFBlcmZvcm1hbmNlW3Byb2R1Y3RJZFN0cmluZ10gPSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQsXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3QubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2t1OiBpdGVtLnByb2R1Y3Quc2t1LFxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUlkOiBpdGVtLnByb2R1Y3QuY2F0ZWdvcnlJZCxcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnlOYW1lOiBpdGVtLnByb2R1Y3QuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbFF1YW50aXR5U29sZDogMCxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxTYWxlc0Ftb3VudDogMCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJvZHVjdFBlcmZvcm1hbmNlW3Byb2R1Y3RJZFN0cmluZ10udG90YWxRdWFudGl0eVNvbGQgKz0gaXRlbS5xdWFudGl0eTtcbiAgICAgICAgICAgIHByb2R1Y3RQZXJmb3JtYW5jZVtwcm9kdWN0SWRTdHJpbmddLnRvdGFsU2FsZXNBbW91bnQgKz0gaXRlbS50b3RhbDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRnVydGhlciBncm91cCBieSBjYXRlZ29yeVxuICAgICAgICBjb25zdCBjYXRlZ29yeVBlcmZvcm1hbmNlSW50ZXJtZWRpYXRlOiBSZWNvcmQ8c3RyaW5nLCB7IGNhdGVnb3J5TmFtZTogc3RyaW5nOyBwcm9kdWN0czogYW55W107IHRvdGFsQ2F0ZWdvcnlTYWxlczogbnVtYmVyOyB0b3RhbENhdGVnb3J5UXVhbnRpdHk6IG51bWJlcjsgfT4gPSB7fTtcbiAgICAgICAgT2JqZWN0LnZhbHVlcyhwcm9kdWN0UGVyZm9ybWFuY2UpLmZvckVhY2gocHJvZHVjdCA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yeU5hbWVLZXkgPSBwcm9kdWN0LmNhdGVnb3J5TmFtZTsgLy8gVXNlIGNhdGVnb3J5IG5hbWUgYXMga2V5XG5cbiAgICAgICAgICAgIGlmICghY2F0ZWdvcnlQZXJmb3JtYW5jZUludGVybWVkaWF0ZVtjYXRlZ29yeU5hbWVLZXldKSB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcnlQZXJmb3JtYW5jZUludGVybWVkaWF0ZVtjYXRlZ29yeU5hbWVLZXldID0ge1xuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWU6IHByb2R1Y3QuY2F0ZWdvcnlOYW1lLFxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0czogW10sXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQ2F0ZWdvcnlTYWxlczogMCxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxDYXRlZ29yeVF1YW50aXR5OiAwLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRlZ29yeVBlcmZvcm1hbmNlSW50ZXJtZWRpYXRlW2NhdGVnb3J5TmFtZUtleV0ucHJvZHVjdHMucHVzaChwcm9kdWN0KTtcbiAgICAgICAgICAgIGNhdGVnb3J5UGVyZm9ybWFuY2VJbnRlcm1lZGlhdGVbY2F0ZWdvcnlOYW1lS2V5XS50b3RhbENhdGVnb3J5U2FsZXMgKz0gcHJvZHVjdC50b3RhbFNhbGVzQW1vdW50O1xuICAgICAgICAgICAgY2F0ZWdvcnlQZXJmb3JtYW5jZUludGVybWVkaWF0ZVtjYXRlZ29yeU5hbWVLZXldLnRvdGFsQ2F0ZWdvcnlRdWFudGl0eSArPSBwcm9kdWN0LnRvdGFsUXVhbnRpdHlTb2xkO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTb3J0IHByb2R1Y3RzIHdpdGhpbiBlYWNoIGNhdGVnb3J5IGJ5IHNhbGVzIGFtb3VudFxuICAgICAgICBmb3IgKGNvbnN0IGNhdE5hbWUgaW4gY2F0ZWdvcnlQZXJmb3JtYW5jZUludGVybWVkaWF0ZSkge1xuICAgICAgICAgICAgY2F0ZWdvcnlQZXJmb3JtYW5jZUludGVybWVkaWF0ZVtjYXROYW1lXS5wcm9kdWN0cy5zb3J0KChhLCBiKSA9PiBiLnRvdGFsU2FsZXNBbW91bnQgLSBhLnRvdGFsU2FsZXNBbW91bnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29udmVydCBpbnRlcm1lZGlhdGUgb2JqZWN0IHRvIGFycmF5IGFuZCBzb3J0IGNhdGVnb3JpZXMgYnkgc2FsZXMgYW1vdW50XG4gICAgICAgIGNvbnN0IHJlcG9ydERldGFpbHMgPSBPYmplY3QudmFsdWVzKGNhdGVnb3J5UGVyZm9ybWFuY2VJbnRlcm1lZGlhdGUpLnNvcnQoKGEsIGIpID0+IGIudG90YWxDYXRlZ29yeVNhbGVzIC0gYS50b3RhbENhdGVnb3J5U2FsZXMpO1xuXG4gICAgICAgIGNvbnN0IG92ZXJhbGxUb3RhbFJldmVudWUgPSByZXBvcnREZXRhaWxzLnJlZHVjZSgoc3VtLCBjYXQpID0+IHN1bSArIGNhdC50b3RhbENhdGVnb3J5U2FsZXMsIDApO1xuICAgICAgICBjb25zdCBvdmVyYWxsVG90YWxQcm9kdWN0c1NvbGQgPSByZXBvcnREZXRhaWxzLnJlZHVjZSgoc3VtLCBjYXQpID0+IHN1bSArIGNhdC50b3RhbENhdGVnb3J5UXVhbnRpdHksIDApO1xuXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGV0YWlsczogcmVwb3J0RGV0YWlscywgLy8gQXJyYXkgb2YgY2F0ZWdvcmllcywgZWFjaCB3aXRoIHByb2R1Y3RzIGFycmF5XG4gICAgICAgICAgICBzdW1tYXJ5OiB7XG4gICAgICAgICAgICAgICAgbW9udGg6IG5vdy50b0xvY2FsZVN0cmluZygnZGVmYXVsdCcsIHsgbW9udGg6ICdsb25nJyB9KSxcbiAgICAgICAgICAgICAgICB5ZWFyOiBub3cuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgICAgICAgICBvdmVyYWxsVG90YWxSZXZlbnVlOiBvdmVyYWxsVG90YWxSZXZlbnVlLFxuICAgICAgICAgICAgICAgIG92ZXJhbGxUb3RhbFByb2R1Y3RzU29sZDogb3ZlcmFsbFRvdGFsUHJvZHVjdHNTb2xkLFxuICAgICAgICAgICAgICAgIG51bWJlck9mQ2F0ZWdvcmllc1dpdGhTYWxlczogcmVwb3J0RGV0YWlscy5sZW5ndGgsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2VuZXJhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfSk7XG5cbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3QgcGVyZm9ybWFuY2UgcmVwb3J0OicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ0ZhaWxlZCB0byBmZXRjaCBwcm9kdWN0IHBlcmZvcm1hbmNlIHJlcG9ydCcsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0sXG4gICAgICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICAgKTtcbiAgICB9XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQU1RO0lBQUFBLGNBQUEsWUFBQUEsQ0FBQTtNQUFBLE9BQUFDLGNBQUE7SUFBQTtFQUFBO0VBQUEsT0FBQUEsY0FBQTtBQUFBO0FBQUFELGNBQUE7QUFBQUEsY0FBQSxHQUFBRSxDQUFBOzs7Ozs7K0JBSGM7Ozs7OztXQUFBQyxHQUFBOzs7OztrQ0FITzs7O2tDQUNOO0FBRWhCLGVBQWVBLElBQUlDLE9BQWdCO0VBQUE7RUFBQUosY0FBQSxHQUFBSyxDQUFBO0VBQUFMLGNBQUEsR0FBQUUsQ0FBQTtFQUN0QyxJQUFJO0lBQ0EsTUFBTUksR0FBQTtJQUFBO0lBQUEsQ0FBQU4sY0FBQSxHQUFBRSxDQUFBLE9BQU0sSUFBSUssSUFBQTtJQUNoQixNQUFNQyxlQUFBO0lBQUE7SUFBQSxDQUFBUixjQUFBLEdBQUFFLENBQUEsT0FBa0IsSUFBSUssSUFBQSxDQUFLRCxHQUFBLENBQUlHLFdBQVcsSUFBSUgsR0FBQSxDQUFJSSxRQUFRLElBQUk7SUFDcEUsTUFBTUMsY0FBQTtJQUFBO0lBQUEsQ0FBQVgsY0FBQSxHQUFBRSxDQUFBLE9BQWlCLElBQUlLLElBQUEsQ0FBS0QsR0FBQSxDQUFJRyxXQUFXLElBQUlILEdBQUEsQ0FBSUksUUFBUSxLQUFLLEdBQUcsR0FBRyxJQUFJLElBQUksSUFBSTtJQUV0RixNQUFNRSxZQUFBO0lBQUE7SUFBQSxDQUFBWixjQUFBLEdBQUFFLENBQUEsT0FBZSxNQUFNVyxPQUFBLENBQUFDLE1BQU0sQ0FBQ0MsV0FBVyxDQUFDQyxRQUFRLENBQUM7TUFDbkRDLEtBQUEsRUFBTztRQUNIQyxPQUFBLEVBQVM7VUFDTEMsTUFBQSxFQUFRO1VBQ1JDLFNBQUEsRUFBVztZQUNQQyxHQUFBLEVBQUtiLGVBQUE7WUFDTGMsR0FBQSxFQUFLWDtVQUNUO1FBQ0o7TUFDSjtNQUNBWSxPQUFBLEVBQVM7UUFDTEMsT0FBQSxFQUFTO1VBQ0xELE9BQUEsRUFBUztZQUNMRSxRQUFBLEVBQVU7VUFDZDtRQUNKO1FBQ0FQLE9BQUEsRUFBUztNQUNiO0lBQ0o7SUFBQTtJQUFBbEIsY0FBQSxHQUFBRSxDQUFBO0lBRUEsSUFBSVUsWUFBQSxDQUFhYyxNQUFNLEtBQUssR0FBRztNQUFBO01BQUExQixjQUFBLEdBQUEyQixDQUFBO01BQUEzQixjQUFBLEdBQUFFLENBQUE7TUFDM0IsT0FBTzBCLE9BQUEsQ0FBQUMsWUFBWSxDQUFDQyxJQUFJLENBQUM7UUFDckJDLE9BQUEsRUFBUztRQUNUQyxPQUFBLEVBQVMsRUFBRTtRQUNYQyxPQUFBLEVBQVM7VUFDTEMsS0FBQSxFQUFPNUIsR0FBQSxDQUFJNkIsY0FBYyxDQUFDLFdBQVc7WUFBRUQsS0FBQSxFQUFPO1VBQU87VUFDckRFLElBQUEsRUFBTTlCLEdBQUEsQ0FBSUcsV0FBVztVQUNyQjRCLG1CQUFBLEVBQXFCO1VBQ3JCQyx3QkFBQSxFQUEwQjtVQUMxQkMsMkJBQUEsRUFBNkI7UUFDakM7UUFDQUMsV0FBQSxFQUFhLElBQUlqQyxJQUFBLEdBQU9rQyxXQUFXO1FBQ25DQyxPQUFBLEVBQVM7TUFDYjtJQUNKO0lBQUE7SUFBQTtNQUFBMUMsY0FBQSxHQUFBMkIsQ0FBQTtJQUFBO0lBRUE7SUFDQSxNQUFNZ0Isa0JBQUE7SUFBQTtJQUFBLENBQUEzQyxjQUFBLEdBQUFFLENBQUEsUUFRRCxDQUFDO0lBQUE7SUFBQUYsY0FBQSxHQUFBRSxDQUFBO0lBRU5VLFlBQUEsQ0FBYWdDLE9BQU8sQ0FBQ0MsSUFBQTtNQUFBO01BQUE3QyxjQUFBLEdBQUFLLENBQUE7TUFDakIsTUFBTXlDLGVBQUE7TUFBQTtNQUFBLENBQUE5QyxjQUFBLEdBQUFFLENBQUEsUUFBa0IyQyxJQUFBLENBQUtFLFNBQVMsQ0FBQ0MsUUFBUSxLQUFJO01BQUE7TUFBQWhELGNBQUEsR0FBQUUsQ0FBQTtNQUNuRCxJQUFJLENBQUN5QyxrQkFBa0IsQ0FBQ0csZUFBQSxDQUFnQixFQUFFO1FBQUE7UUFBQTlDLGNBQUEsR0FBQTJCLENBQUE7UUFBQTNCLGNBQUEsR0FBQUUsQ0FBQTtRQUN0Q3lDLGtCQUFrQixDQUFDRyxlQUFBLENBQWdCLEdBQUc7VUFDbENDLFNBQUEsRUFBV0YsSUFBQSxDQUFLRSxTQUFTO1VBQ3pCRSxXQUFBLEVBQWFKLElBQUEsQ0FBS3JCLE9BQU8sQ0FBQzBCLElBQUk7VUFDOUJDLEdBQUEsRUFBS04sSUFBQSxDQUFLckIsT0FBTyxDQUFDMkIsR0FBRztVQUNyQkMsVUFBQSxFQUFZUCxJQUFBLENBQUtyQixPQUFPLENBQUM0QixVQUFVO1VBQ25DQyxZQUFBO1VBQWM7VUFBQSxDQUFBckQsY0FBQSxHQUFBMkIsQ0FBQSxVQUFBa0IsSUFBQSxDQUFLckIsT0FBTyxDQUFDQyxRQUFRLEVBQUV5QixJQUFBO1VBQUE7VUFBQSxDQUFBbEQsY0FBQSxHQUFBMkIsQ0FBQSxVQUFRO1VBQzdDMkIsaUJBQUEsRUFBbUI7VUFDbkJDLGdCQUFBLEVBQWtCO1FBQ3RCO01BQ0o7TUFBQTtNQUFBO1FBQUF2RCxjQUFBLEdBQUEyQixDQUFBO01BQUE7TUFBQTNCLGNBQUEsR0FBQUUsQ0FBQTtNQUNBeUMsa0JBQWtCLENBQUNHLGVBQUEsQ0FBZ0IsQ0FBQ1EsaUJBQWlCLElBQUlULElBQUEsQ0FBS1csUUFBUTtNQUFBO01BQUF4RCxjQUFBLEdBQUFFLENBQUE7TUFDdEV5QyxrQkFBa0IsQ0FBQ0csZUFBQSxDQUFnQixDQUFDUyxnQkFBZ0IsSUFBSVYsSUFBQSxDQUFLWSxLQUFLO0lBQ3RFO0lBRUE7SUFDQSxNQUFNQywrQkFBQTtJQUFBO0lBQUEsQ0FBQTFELGNBQUEsR0FBQUUsQ0FBQSxRQUF5SixDQUFDO0lBQUE7SUFBQUYsY0FBQSxHQUFBRSxDQUFBO0lBQ2hLeUQsTUFBQSxDQUFPQyxNQUFNLENBQUNqQixrQkFBQSxFQUFvQkMsT0FBTyxDQUFDcEIsT0FBQTtNQUFBO01BQUF4QixjQUFBLEdBQUFLLENBQUE7TUFDdEMsTUFBTXdELGVBQUE7TUFBQTtNQUFBLENBQUE3RCxjQUFBLEdBQUFFLENBQUEsUUFBa0JzQixPQUFBLENBQVE2QixZQUFZLEdBQUU7TUFBQTtNQUFBckQsY0FBQSxHQUFBRSxDQUFBO01BRTlDLElBQUksQ0FBQ3dELCtCQUErQixDQUFDRyxlQUFBLENBQWdCLEVBQUU7UUFBQTtRQUFBN0QsY0FBQSxHQUFBMkIsQ0FBQTtRQUFBM0IsY0FBQSxHQUFBRSxDQUFBO1FBQ25Ed0QsK0JBQStCLENBQUNHLGVBQUEsQ0FBZ0IsR0FBRztVQUMvQ1IsWUFBQSxFQUFjN0IsT0FBQSxDQUFRNkIsWUFBWTtVQUNsQ1MsUUFBQSxFQUFVLEVBQUU7VUFDWkMsa0JBQUEsRUFBb0I7VUFDcEJDLHFCQUFBLEVBQXVCO1FBQzNCO01BQ0o7TUFBQTtNQUFBO1FBQUFoRSxjQUFBLEdBQUEyQixDQUFBO01BQUE7TUFBQTNCLGNBQUEsR0FBQUUsQ0FBQTtNQUNBd0QsK0JBQStCLENBQUNHLGVBQUEsQ0FBZ0IsQ0FBQ0MsUUFBUSxDQUFDRyxJQUFJLENBQUN6QyxPQUFBO01BQUE7TUFBQXhCLGNBQUEsR0FBQUUsQ0FBQTtNQUMvRHdELCtCQUErQixDQUFDRyxlQUFBLENBQWdCLENBQUNFLGtCQUFrQixJQUFJdkMsT0FBQSxDQUFRK0IsZ0JBQWdCO01BQUE7TUFBQXZELGNBQUEsR0FBQUUsQ0FBQTtNQUMvRndELCtCQUErQixDQUFDRyxlQUFBLENBQWdCLENBQUNHLHFCQUFxQixJQUFJeEMsT0FBQSxDQUFROEIsaUJBQWlCO0lBQ3ZHO0lBRUE7SUFBQTtJQUFBdEQsY0FBQSxHQUFBRSxDQUFBO0lBQ0EsS0FBSyxNQUFNZ0UsT0FBQSxJQUFXUiwrQkFBQSxFQUFpQztNQUFBO01BQUExRCxjQUFBLEdBQUFFLENBQUE7TUFDbkR3RCwrQkFBK0IsQ0FBQ1EsT0FBQSxDQUFRLENBQUNKLFFBQVEsQ0FBQ0ssSUFBSSxDQUFDLENBQUNDLENBQUEsRUFBR3pDLENBQUEsS0FBTTtRQUFBO1FBQUEzQixjQUFBLEdBQUFLLENBQUE7UUFBQUwsY0FBQSxHQUFBRSxDQUFBO1FBQUEsT0FBQXlCLENBQUEsQ0FBRTRCLGdCQUFnQixHQUFHYSxDQUFBLENBQUViLGdCQUFnQjtNQUFoQixDQUFnQjtJQUM1RztJQUVBO0lBQ0EsTUFBTWMsYUFBQTtJQUFBO0lBQUEsQ0FBQXJFLGNBQUEsR0FBQUUsQ0FBQSxRQUFnQnlELE1BQUEsQ0FBT0MsTUFBTSxDQUFDRiwrQkFBQSxFQUFpQ1MsSUFBSSxDQUFDLENBQUNDLENBQUEsRUFBR3pDLENBQUEsS0FBTTtNQUFBO01BQUEzQixjQUFBLEdBQUFLLENBQUE7TUFBQUwsY0FBQSxHQUFBRSxDQUFBO01BQUEsT0FBQXlCLENBQUEsQ0FBRW9DLGtCQUFrQixHQUFHSyxDQUFBLENBQUVMLGtCQUFrQjtJQUFsQixDQUFrQjtJQUUvSCxNQUFNMUIsbUJBQUE7SUFBQTtJQUFBLENBQUFyQyxjQUFBLEdBQUFFLENBQUEsUUFBc0JtRSxhQUFBLENBQWNDLE1BQU0sQ0FBQyxDQUFDQyxHQUFBLEVBQUtDLEdBQUEsS0FBUTtNQUFBO01BQUF4RSxjQUFBLEdBQUFLLENBQUE7TUFBQUwsY0FBQSxHQUFBRSxDQUFBO01BQUEsT0FBQXFFLEdBQUEsR0FBTUMsR0FBQSxDQUFJVCxrQkFBa0I7SUFBbEIsQ0FBa0IsRUFBRTtJQUM3RixNQUFNekIsd0JBQUE7SUFBQTtJQUFBLENBQUF0QyxjQUFBLEdBQUFFLENBQUEsUUFBMkJtRSxhQUFBLENBQWNDLE1BQU0sQ0FBQyxDQUFDQyxHQUFBLEVBQUtDLEdBQUEsS0FBUTtNQUFBO01BQUF4RSxjQUFBLEdBQUFLLENBQUE7TUFBQUwsY0FBQSxHQUFBRSxDQUFBO01BQUEsT0FBQXFFLEdBQUEsR0FBTUMsR0FBQSxDQUFJUixxQkFBcUI7SUFBckIsQ0FBcUIsRUFBRTtJQUFBO0lBQUFoRSxjQUFBLEdBQUFFLENBQUE7SUFFckcsT0FBTzBCLE9BQUEsQ0FBQUMsWUFBWSxDQUFDQyxJQUFJLENBQUM7TUFDckJDLE9BQUEsRUFBUztNQUNUQyxPQUFBLEVBQVNxQyxhQUFBO01BQ1RwQyxPQUFBLEVBQVM7UUFDTEMsS0FBQSxFQUFPNUIsR0FBQSxDQUFJNkIsY0FBYyxDQUFDLFdBQVc7VUFBRUQsS0FBQSxFQUFPO1FBQU87UUFDckRFLElBQUEsRUFBTTlCLEdBQUEsQ0FBSUcsV0FBVztRQUNyQjRCLG1CQUFBLEVBQXFCQSxtQkFBQTtRQUNyQkMsd0JBQUEsRUFBMEJBLHdCQUFBO1FBQzFCQywyQkFBQSxFQUE2QjhCLGFBQUEsQ0FBYzNDO01BQy9DO01BQ0FjLFdBQUEsRUFBYSxJQUFJakMsSUFBQSxHQUFPa0MsV0FBVztJQUN2QztFQUVKLEVBQUUsT0FBT2dDLEtBQUEsRUFBWTtJQUFBO0lBQUF6RSxjQUFBLEdBQUFFLENBQUE7SUFDakJ3RSxPQUFBLENBQVFELEtBQUssQ0FBQyw4Q0FBOENBLEtBQUE7SUFBQTtJQUFBekUsY0FBQSxHQUFBRSxDQUFBO0lBQzVELE9BQU8wQixPQUFBLENBQUFDLFlBQVksQ0FBQ0MsSUFBSSxDQUNwQjtNQUFFQyxPQUFBLEVBQVM7TUFBT1csT0FBQSxFQUFTO01BQThDK0IsS0FBQSxFQUFPQSxLQUFBLENBQU0vQjtJQUFRLEdBQzlGO01BQUV2QixNQUFBLEVBQVE7SUFBSTtFQUV0QjtBQUNKIiwiaWdub3JlTGlzdCI6W119