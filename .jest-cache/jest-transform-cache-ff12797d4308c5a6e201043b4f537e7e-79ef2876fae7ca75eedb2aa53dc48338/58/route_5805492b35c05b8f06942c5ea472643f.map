{"version":3,"names":["POST","req","cov_22e3dojtpp","f","s","body","json","email","password","b","_server","NextResponse","success","message","status","user","_prisma","default","findFirst","where","isActive","storedHash","isMatch","_bcryptjs","compare","salt","genSalt","newHash","hash","userFound","passwordMatch","userInfo","id","name","storedPasswordHash","newGeneratedHash","passwordCompareResult","error","console"],"sources":["/Users/sachin/Documents/md-sports-/src/app/api/auth/verify-login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport bcrypt from 'bcryptjs';\nimport prisma from '@/lib/prisma';\n\nexport async function POST(req: NextRequest) {\n    try {\n        const body = await req.json();\n        const { email, password } = body;\n\n        if (!email || !password) {\n            return NextResponse.json(\n                { success: false, message: 'Email and password are required' },\n                { status: 400 }\n            );\n        }\n\n        // Try to find the user directly from the database\n        const user = await prisma.user.findFirst({\n            where: {\n                email: email,\n                isActive: true\n            }\n        });\n\n        if (!user) {\n            return NextResponse.json({\n                success: false,\n                message: 'User not found',\n                email\n            });\n        }\n\n        // Get stored password hash\n        const storedHash = user.password;\n\n        // Test with the provided password\n        const isMatch = await bcrypt.compare(password, storedHash);\n\n        // Hash a new password for comparison\n        const salt = await bcrypt.genSalt(10);\n        const newHash = await bcrypt.hash('password', salt);\n\n        return NextResponse.json({\n            success: true,\n            userFound: true,\n            passwordMatch: isMatch,\n            userInfo: {\n                id: user.id,\n                name: user.name,\n                email: user.email,\n                storedPasswordHash: storedHash,\n                newGeneratedHash: newHash,\n                passwordCompareResult: isMatch\n            }\n        });\n    } catch (error) {\n        console.error('Verify login error:', error);\n        return NextResponse.json(\n            { success: false, message: 'Verification failed', error: (error as Error).message },\n            { status: 500 }\n        );\n    }\n} "],"mappings":"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","ignoreList":[]}