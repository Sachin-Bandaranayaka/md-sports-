fa7d92e41ca1b18c787a7a8b5fa6a3eb
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _axios = /*#__PURE__*/ _interop_require_default(require("axios"));
const _chatbotService = require("../../src/services/chatbotService");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock axios
_globals.jest.mock("axios");
const mockAxios = {
    get: _globals.jest.fn(),
    post: _globals.jest.fn(),
    isAxiosError: _globals.jest.fn()
};
_axios.default.get = mockAxios.get;
_axios.default.post = mockAxios.post;
_axios.default.isAxiosError = mockAxios.isAxiosError;
// Mock document.cookie for getCookie function
Object.defineProperty(global, "document", {
    value: {
        cookie: "",
        addEventListener: _globals.jest.fn(),
        removeEventListener: _globals.jest.fn()
    },
    writable: true
});
(0, _globals.describe)("ChatbotService", ()=>{
    (0, _globals.beforeEach)(()=>{
        _globals.jest.clearAllMocks();
        // Reset document.cookie
        global.document.cookie = "";
    });
    (0, _globals.afterEach)(()=>{
        _globals.jest.resetAllMocks();
    });
    (0, _globals.describe)("sendMessage", ()=>{
        const mockMessages = [
            {
                role: "user",
                content: "Hello, how can I help?"
            },
            {
                role: "assistant",
                content: "I can help you with your sports equipment needs."
            }
        ];
        const mockResponse = {
            role: "assistant",
            content: "Thank you for your message. How can I assist you today?"
        };
        (0, _globals.it)("should send message successfully when API key is configured", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: mockResponse
            });
            const result = await _chatbotService.chatbotService.sendMessage(mockMessages);
            (0, _globals.expect)(result).toEqual(mockResponse);
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings");
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: mockMessages
            }, {
                headers: {
                    "Content-Type": "application/json"
                }
            });
        });
        (0, _globals.it)("should include CSRF token when available", async ()=>{
            // Set CSRF token in cookie
            global.document.cookie = "csrfToken=test-csrf-token; other=value";
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: mockResponse
            });
            await _chatbotService.chatbotService.sendMessage(mockMessages);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: mockMessages
            }, {
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRF-Token": "test-csrf-token"
                }
            });
        });
        (0, _globals.it)("should throw error when API key is not configured", async ()=>{
            // Mock API key check failure
            mockAxios.get.mockResolvedValue({
                data: {
                    success: false,
                    isEmpty: true,
                    valueLength: 0
                }
            });
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Deepseek API key is not configured. Please set it in the AI Assistant settings page.");
            (0, _globals.expect)(mockAxios.post).not.toHaveBeenCalled();
        });
        (0, _globals.it)("should throw error when API key is empty", async ()=>{
            // Mock API key check with empty key
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: true,
                    valueLength: 0
                }
            });
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Deepseek API key is not configured. Please set it in the AI Assistant settings page.");
        });
        (0, _globals.it)("should handle API key check errors", async ()=>{
            // Mock API key check error
            const configError = new Error("Configuration check failed");
            mockAxios.get.mockRejectedValueOnce(configError);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Configuration check failed");
        });
        (0, _globals.it)("should handle axios error with response data", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock axios error with response
            const axiosError = {
                isAxiosError: true,
                response: {
                    status: 400,
                    data: {
                        error: "Invalid request format"
                    }
                },
                toJSON: ()=>({
                        message: "Request failed"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Invalid request format");
        });
        (0, _globals.it)("should handle 403 forbidden error", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock 403 error
            const axiosError = {
                isAxiosError: true,
                response: {
                    status: 403,
                    data: {}
                },
                toJSON: ()=>({
                        message: "Forbidden"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Access to the chatbot service was denied (403). Please check API key and configuration in AI Assistant settings, or a CSRF token issue might exist.");
        });
        (0, _globals.it)("should handle network errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock network error (no response)
            const axiosError = {
                isAxiosError: true,
                request: {},
                response: undefined,
                toJSON: ()=>({
                        message: "Network Error"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("No response received from the chatbot service. Please check your network connection and server status.");
        });
        (0, _globals.it)("should handle request setup errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock request setup error
            const axiosError = {
                isAxiosError: true,
                message: "Request setup failed",
                request: undefined,
                response: undefined,
                toJSON: ()=>({
                        message: "Request setup failed"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Error setting up chatbot request: Request setup failed");
        });
        (0, _globals.it)("should handle non-axios errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock non-axios error
            const genericError = new Error("Generic error");
            mockAxios.post.mockRejectedValueOnce(genericError);
            mockAxios.isAxiosError.mockReturnValue(false);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Generic error");
        });
        (0, _globals.it)("should handle errors without message", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock error without message
            const errorWithoutMessage = {};
            mockAxios.post.mockRejectedValueOnce(errorWithoutMessage);
            mockAxios.isAxiosError.mockReturnValue(false);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("An unexpected error occurred with the chatbot service.");
        });
        (0, _globals.it)("should handle API key check axios error with response data", async ()=>{
            // Mock API key check axios error
            const configAxiosError = {
                isAxiosError: true,
                response: {
                    data: {
                        message: "Settings API error"
                    }
                }
            };
            mockAxios.get.mockRejectedValueOnce(configAxiosError);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Settings API error");
        });
    });
    (0, _globals.describe)("getBusinessInfo", ()=>{
        (0, _globals.it)("should return business information", async ()=>{
            const businessInfo = await _chatbotService.chatbotService.getBusinessInfo();
            (0, _globals.expect)(businessInfo).toEqual({
                businessName: "MS Sports",
                inventoryCount: "Over 1,000 items",
                topSellingProducts: [
                    "Sports Shoes",
                    "Jerseys",
                    "Training Equipment"
                ],
                customerCount: "Over 500 registered customers",
                supplierCount: "50+ active suppliers"
            });
        });
        (0, _globals.it)("should return consistent data structure", async ()=>{
            const businessInfo = await _chatbotService.chatbotService.getBusinessInfo();
            (0, _globals.expect)(businessInfo).toHaveProperty("businessName");
            (0, _globals.expect)(businessInfo).toHaveProperty("inventoryCount");
            (0, _globals.expect)(businessInfo).toHaveProperty("topSellingProducts");
            (0, _globals.expect)(businessInfo).toHaveProperty("customerCount");
            (0, _globals.expect)(businessInfo).toHaveProperty("supplierCount");
            (0, _globals.expect)(Array.isArray(businessInfo.topSellingProducts)).toBe(true);
        });
    });
    (0, _globals.describe)("checkConfiguration", ()=>{
        (0, _globals.it)("should return configured when API key exists and is not empty", async ()=>{
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: false
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: true
            });
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings", {
                headers: {}
            });
        });
        (0, _globals.it)("should include CSRF token in configuration check", async ()=>{
            // Set CSRF token in cookie
            global.document.cookie = "csrfToken=config-csrf-token; other=value";
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: false
                }
            });
            await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings", {
                headers: {
                    "X-CSRF-Token": "config-csrf-token"
                }
            });
        });
        (0, _globals.it)("should return not configured when setting not found", async ()=>{
            mockAxios.get.mockResolvedValue({
                data: {
                    success: false,
                    exists: false
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "API key setting not found in database"
            });
        });
        (0, _globals.it)("should return not configured when API key is empty", async ()=>{
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: true
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "API key is empty. Please configure it in settings."
            });
        });
        (0, _globals.it)("should handle configuration check errors", async ()=>{
            const error = new Error("Network error");
            mockAxios.get.mockRejectedValueOnce(error);
            const consoleSpy = _globals.jest.spyOn(console, "error").mockImplementation();
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "Failed to check configuration. Please try again."
            });
            (0, _globals.expect)(consoleSpy).toHaveBeenCalledWith("Error checking chatbot configuration:", error);
            consoleSpy.mockRestore();
        });
    });
    (0, _globals.describe)("getCookie function (via sendMessage)", ()=>{
        (0, _globals.it)("should extract CSRF token from cookie string", async ()=>{
            // Set multiple cookies including CSRF token
            global.document.cookie = "sessionId=abc123; csrfToken=test-token; userId=456";
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: {
                    role: "assistant",
                    content: "Response"
                }
            });
            await _chatbotService.chatbotService.sendMessage([
                {
                    role: "user",
                    content: "test"
                }
            ]);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: [
                    {
                        role: "user",
                        content: "test"
                    }
                ]
            }, {
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRF-Token": "test-token"
                }
            });
        });
        (0, _globals.it)("should handle missing CSRF token gracefully", async ()=>{
            // Set cookies without CSRF token
            global.document.cookie = "sessionId=abc123; userId=456";
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: {
                    role: "assistant",
                    content: "Response"
                }
            });
            await _chatbotService.chatbotService.sendMessage([
                {
                    role: "user",
                    content: "test"
                }
            ]);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: [
                    {
                        role: "user",
                        content: "test"
                    }
                ]
            }, {
                headers: {
                    "Content-Type": "application/json"
                }
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vRG9jdW1lbnRzL21kLXNwb3J0cy0vdGVzdHMvdW5pdC9jaGF0Ym90U2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBhZnRlckVhY2gsIGplc3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCBheGlvcywgeyBBeGlvc0Vycm9yIH0gZnJvbSAnYXhpb3MnO1xuaW1wb3J0IHsgY2hhdGJvdFNlcnZpY2UsIENoYXRNZXNzYWdlLCBDaGF0UmVzcG9uc2UgfSBmcm9tICdAL3NlcnZpY2VzL2NoYXRib3RTZXJ2aWNlJztcblxuLy8gTW9jayBheGlvc1xuamVzdC5tb2NrKCdheGlvcycpO1xuY29uc3QgbW9ja0F4aW9zID0ge1xuICBnZXQ6IGplc3QuZm4oKSxcbiAgcG9zdDogamVzdC5mbigpLFxuICBpc0F4aW9zRXJyb3I6IGplc3QuZm4oKSxcbn07XG4oYXhpb3MgYXMgYW55KS5nZXQgPSBtb2NrQXhpb3MuZ2V0O1xuKGF4aW9zIGFzIGFueSkucG9zdCA9IG1vY2tBeGlvcy5wb3N0O1xuKGF4aW9zIGFzIGFueSkuaXNBeGlvc0Vycm9yID0gbW9ja0F4aW9zLmlzQXhpb3NFcnJvcjtcblxuLy8gTW9jayBkb2N1bWVudC5jb29raWUgZm9yIGdldENvb2tpZSBmdW5jdGlvblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgJ2RvY3VtZW50Jywge1xuICB2YWx1ZToge1xuICAgIGNvb2tpZTogJycsXG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcbiAgfSxcbiAgd3JpdGFibGU6IHRydWUsXG59KTtcblxuZGVzY3JpYmUoJ0NoYXRib3RTZXJ2aWNlJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAvLyBSZXNldCBkb2N1bWVudC5jb29raWVcbiAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJyc7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXNldEFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kTWVzc2FnZScsICgpID0+IHtcbiAgICBjb25zdCBtb2NrTWVzc2FnZXM6IENoYXRNZXNzYWdlW10gPSBbXG4gICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ0hlbGxvLCBob3cgY2FuIEkgaGVscD8nIH0sXG4gICAgICB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAnSSBjYW4gaGVscCB5b3Ugd2l0aCB5b3VyIHNwb3J0cyBlcXVpcG1lbnQgbmVlZHMuJyB9XG4gICAgXTtcblxuICAgIGNvbnN0IG1vY2tSZXNwb25zZTogQ2hhdFJlc3BvbnNlID0ge1xuICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICBjb250ZW50OiAnVGhhbmsgeW91IGZvciB5b3VyIG1lc3NhZ2UuIEhvdyBjYW4gSSBhc3Npc3QgeW91IHRvZGF5PydcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIG1lc3NhZ2Ugc3VjY2Vzc2Z1bGx5IHdoZW4gQVBJIGtleSBpcyBjb25maWd1cmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjaGF0Ym90IHJlc3BvbnNlXG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IG1vY2tSZXNwb25zZVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Jlc3BvbnNlKTtcbiAgICAgIGV4cGVjdChtb2NrQXhpb3MuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS90ZXN0LXNldHRpbmdzJyk7XG4gICAgICBleHBlY3QobW9ja0F4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnL2FwaS9jaGF0Ym90JyxcbiAgICAgICAgeyBtZXNzYWdlczogbW9ja01lc3NhZ2VzIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBDU1JGIHRva2VuIHdoZW4gYXZhaWxhYmxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2V0IENTUkYgdG9rZW4gaW4gY29va2llXG4gICAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJ2NzcmZUb2tlbj10ZXN0LWNzcmYtdG9rZW47IG90aGVyPXZhbHVlJztcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjaGF0Ym90IHJlc3BvbnNlXG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IG1vY2tSZXNwb25zZVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcyk7XG5cbiAgICAgIGV4cGVjdChtb2NrQXhpb3MucG9zdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICcvYXBpL2NoYXRib3QnLFxuICAgICAgICB7IG1lc3NhZ2VzOiBtb2NrTWVzc2FnZXMgfSxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnWC1DU1JGLVRva2VuJzogJ3Rlc3QtY3NyZi10b2tlbidcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gQVBJIGtleSBpcyBub3QgY29uZmlndXJlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgQVBJIGtleSBjaGVjayBmYWlsdXJlXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGlzRW1wdHk6IHRydWUsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDBcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnRGVlcHNlZWsgQVBJIGtleSBpcyBub3QgY29uZmlndXJlZC4gUGxlYXNlIHNldCBpdCBpbiB0aGUgQUkgQXNzaXN0YW50IHNldHRpbmdzIHBhZ2UuJyk7XG5cbiAgICAgIGV4cGVjdChtb2NrQXhpb3MucG9zdCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBBUEkga2V5IGlzIGVtcHR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBBUEkga2V5IGNoZWNrIHdpdGggZW1wdHkga2V5XG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IHRydWUsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDBcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnRGVlcHNlZWsgQVBJIGtleSBpcyBub3QgY29uZmlndXJlZC4gUGxlYXNlIHNldCBpdCBpbiB0aGUgQUkgQXNzaXN0YW50IHNldHRpbmdzIHBhZ2UuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBBUEkga2V5IGNoZWNrIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgQVBJIGtleSBjaGVjayBlcnJvclxuICAgICAgY29uc3QgY29uZmlnRXJyb3IgPSBuZXcgRXJyb3IoJ0NvbmZpZ3VyYXRpb24gY2hlY2sgZmFpbGVkJyk7XG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShjb25maWdFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnQ29uZmlndXJhdGlvbiBjaGVjayBmYWlsZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGF4aW9zIGVycm9yIHdpdGggcmVzcG9uc2UgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIGF4aW9zIGVycm9yIHdpdGggcmVzcG9uc2VcbiAgICAgIGNvbnN0IGF4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgcmVxdWVzdCBmb3JtYXQnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0b0pTT046ICgpID0+ICh7IG1lc3NhZ2U6ICdSZXF1ZXN0IGZhaWxlZCcgfSlcbiAgICAgIH0gYXMgQXhpb3NFcnJvcjtcblxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKGF4aW9zRXJyb3IpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnSW52YWxpZCByZXF1ZXN0IGZvcm1hdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgNDAzIGZvcmJpZGRlbiBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIDQwMyBlcnJvclxuICAgICAgY29uc3QgYXhpb3NFcnJvciA9IHtcbiAgICAgICAgaXNBeGlvc0Vycm9yOiB0cnVlLFxuICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgIHN0YXR1czogNDAzLFxuICAgICAgICAgIGRhdGE6IHt9XG4gICAgICAgIH0sXG4gICAgICAgIHRvSlNPTjogKCkgPT4gKHsgbWVzc2FnZTogJ0ZvcmJpZGRlbicgfSlcbiAgICAgIH0gYXMgQXhpb3NFcnJvcjtcblxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKGF4aW9zRXJyb3IpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnQWNjZXNzIHRvIHRoZSBjaGF0Ym90IHNlcnZpY2Ugd2FzIGRlbmllZCAoNDAzKS4gUGxlYXNlIGNoZWNrIEFQSSBrZXkgYW5kIGNvbmZpZ3VyYXRpb24gaW4gQUkgQXNzaXN0YW50IHNldHRpbmdzLCBvciBhIENTUkYgdG9rZW4gaXNzdWUgbWlnaHQgZXhpc3QuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBuZXR3b3JrIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIG5ldHdvcmsgZXJyb3IgKG5vIHJlc3BvbnNlKVxuICAgICAgY29uc3QgYXhpb3NFcnJvciA9IHtcbiAgICAgICAgaXNBeGlvc0Vycm9yOiB0cnVlLFxuICAgICAgICByZXF1ZXN0OiB7fSxcbiAgICAgICAgcmVzcG9uc2U6IHVuZGVmaW5lZCxcbiAgICAgICAgdG9KU09OOiAoKSA9PiAoeyBtZXNzYWdlOiAnTmV0d29yayBFcnJvcicgfSlcbiAgICAgIH0gYXMgQXhpb3NFcnJvcjtcblxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKGF4aW9zRXJyb3IpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnTm8gcmVzcG9uc2UgcmVjZWl2ZWQgZnJvbSB0aGUgY2hhdGJvdCBzZXJ2aWNlLiBQbGVhc2UgY2hlY2sgeW91ciBuZXR3b3JrIGNvbm5lY3Rpb24gYW5kIHNlcnZlciBzdGF0dXMuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSByZXF1ZXN0IHNldHVwIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHJlcXVlc3Qgc2V0dXAgZXJyb3JcbiAgICAgIGNvbnN0IGF4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JlcXVlc3Qgc2V0dXAgZmFpbGVkJyxcbiAgICAgICAgcmVxdWVzdDogdW5kZWZpbmVkLFxuICAgICAgICByZXNwb25zZTogdW5kZWZpbmVkLFxuICAgICAgICB0b0pTT046ICgpID0+ICh7IG1lc3NhZ2U6ICdSZXF1ZXN0IHNldHVwIGZhaWxlZCcgfSlcbiAgICAgIH0gYXMgQXhpb3NFcnJvcjtcblxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKGF4aW9zRXJyb3IpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnRXJyb3Igc2V0dGluZyB1cCBjaGF0Ym90IHJlcXVlc3Q6IFJlcXVlc3Qgc2V0dXAgZmFpbGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBub24tYXhpb3MgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgbm9uLWF4aW9zIGVycm9yXG4gICAgICBjb25zdCBnZW5lcmljRXJyb3IgPSBuZXcgRXJyb3IoJ0dlbmVyaWMgZXJyb3InKTtcbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShnZW5lcmljRXJyb3IpO1xuICAgICAgbW9ja0F4aW9zLmlzQXhpb3NFcnJvci5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0dlbmVyaWMgZXJyb3InKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVycm9ycyB3aXRob3V0IG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayBlcnJvciB3aXRob3V0IG1lc3NhZ2VcbiAgICAgIGNvbnN0IGVycm9yV2l0aG91dE1lc3NhZ2UgPSB7fTtcbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShlcnJvcldpdGhvdXRNZXNzYWdlKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkIHdpdGggdGhlIGNoYXRib3Qgc2VydmljZS4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBrZXkgY2hlY2sgYXhpb3MgZXJyb3Igd2l0aCByZXNwb25zZSBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBBUEkga2V5IGNoZWNrIGF4aW9zIGVycm9yXG4gICAgICBjb25zdCBjb25maWdBeGlvc0Vycm9yID0ge1xuICAgICAgICBpc0F4aW9zRXJyb3I6IHRydWUsXG4gICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgbWVzc2FnZTogJ1NldHRpbmdzIEFQSSBlcnJvcidcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gYXMgQXhpb3NFcnJvcjtcblxuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UoY29uZmlnQXhpb3NFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnU2V0dGluZ3MgQVBJIGVycm9yJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRCdXNpbmVzc0luZm8nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYnVzaW5lc3MgaW5mb3JtYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBidXNpbmVzc0luZm8gPSBhd2FpdCBjaGF0Ym90U2VydmljZS5nZXRCdXNpbmVzc0luZm8oKTtcblxuICAgICAgZXhwZWN0KGJ1c2luZXNzSW5mbykudG9FcXVhbCh7XG4gICAgICAgIGJ1c2luZXNzTmFtZTogJ01TIFNwb3J0cycsXG4gICAgICAgIGludmVudG9yeUNvdW50OiAnT3ZlciAxLDAwMCBpdGVtcycsXG4gICAgICAgIHRvcFNlbGxpbmdQcm9kdWN0czogWydTcG9ydHMgU2hvZXMnLCAnSmVyc2V5cycsICdUcmFpbmluZyBFcXVpcG1lbnQnXSxcbiAgICAgICAgY3VzdG9tZXJDb3VudDogJ092ZXIgNTAwIHJlZ2lzdGVyZWQgY3VzdG9tZXJzJyxcbiAgICAgICAgc3VwcGxpZXJDb3VudDogJzUwKyBhY3RpdmUgc3VwcGxpZXJzJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29uc2lzdGVudCBkYXRhIHN0cnVjdHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1c2luZXNzSW5mbyA9IGF3YWl0IGNoYXRib3RTZXJ2aWNlLmdldEJ1c2luZXNzSW5mbygpO1xuXG4gICAgICBleHBlY3QoYnVzaW5lc3NJbmZvKS50b0hhdmVQcm9wZXJ0eSgnYnVzaW5lc3NOYW1lJyk7XG4gICAgICBleHBlY3QoYnVzaW5lc3NJbmZvKS50b0hhdmVQcm9wZXJ0eSgnaW52ZW50b3J5Q291bnQnKTtcbiAgICAgIGV4cGVjdChidXNpbmVzc0luZm8pLnRvSGF2ZVByb3BlcnR5KCd0b3BTZWxsaW5nUHJvZHVjdHMnKTtcbiAgICAgIGV4cGVjdChidXNpbmVzc0luZm8pLnRvSGF2ZVByb3BlcnR5KCdjdXN0b21lckNvdW50Jyk7XG4gICAgICBleHBlY3QoYnVzaW5lc3NJbmZvKS50b0hhdmVQcm9wZXJ0eSgnc3VwcGxpZXJDb3VudCcpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoYnVzaW5lc3NJbmZvLnRvcFNlbGxpbmdQcm9kdWN0cykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjaGVja0NvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29uZmlndXJlZCB3aGVuIEFQSSBrZXkgZXhpc3RzIGFuZCBpcyBub3QgZW1wdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZXhpc3RzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGF0Ym90U2VydmljZS5jaGVja0NvbmZpZ3VyYXRpb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IGlzQ29uZmlndXJlZDogdHJ1ZSB9KTtcbiAgICAgIGV4cGVjdChtb2NrQXhpb3MuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS90ZXN0LXNldHRpbmdzJywge1xuICAgICAgICBoZWFkZXJzOiB7fVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgQ1NSRiB0b2tlbiBpbiBjb25maWd1cmF0aW9uIGNoZWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2V0IENTUkYgdG9rZW4gaW4gY29va2llXG4gICAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJ2NzcmZUb2tlbj1jb25maWctY3NyZi10b2tlbjsgb3RoZXI9dmFsdWUnO1xuXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZXhpc3RzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBjaGF0Ym90U2VydmljZS5jaGVja0NvbmZpZ3VyYXRpb24oKTtcblxuICAgICAgZXhwZWN0KG1vY2tBeGlvcy5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYXBpL3Rlc3Qtc2V0dGluZ3MnLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnWC1DU1JGLVRva2VuJzogJ2NvbmZpZy1jc3JmLXRva2VuJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIG5vdCBjb25maWd1cmVkIHdoZW4gc2V0dGluZyBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGV4aXN0czogZmFsc2VcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoYXRib3RTZXJ2aWNlLmNoZWNrQ29uZmlndXJhdGlvbigpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgaXNDb25maWd1cmVkOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogJ0FQSSBrZXkgc2V0dGluZyBub3QgZm91bmQgaW4gZGF0YWJhc2UnXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIG5vdCBjb25maWd1cmVkIHdoZW4gQVBJIGtleSBpcyBlbXB0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBleGlzdHM6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hhdGJvdFNlcnZpY2UuY2hlY2tDb25maWd1cmF0aW9uKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBpc0NvbmZpZ3VyZWQ6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiAnQVBJIGtleSBpcyBlbXB0eS4gUGxlYXNlIGNvbmZpZ3VyZSBpdCBpbiBzZXR0aW5ncy4nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmZpZ3VyYXRpb24gY2hlY2sgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKTtcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1JlamVjdGVkVmFsdWVPbmNlKGVycm9yKTtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGF0Ym90U2VydmljZS5jaGVja0NvbmZpZ3VyYXRpb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIGlzQ29uZmlndXJlZDogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gY2hlY2sgY29uZmlndXJhdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChjb25zb2xlU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRXJyb3IgY2hlY2tpbmcgY2hhdGJvdCBjb25maWd1cmF0aW9uOicsIGVycm9yKTtcblxuICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0Q29va2llIGZ1bmN0aW9uICh2aWEgc2VuZE1lc3NhZ2UpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZXh0cmFjdCBDU1JGIHRva2VuIGZyb20gY29va2llIHN0cmluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNldCBtdWx0aXBsZSBjb29raWVzIGluY2x1ZGluZyBDU1JGIHRva2VuXG4gICAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJ3Nlc3Npb25JZD1hYmMxMjM7IGNzcmZUb2tlbj10ZXN0LXRva2VuOyB1c2VySWQ9NDU2JztcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjaGF0Ym90IHJlc3BvbnNlXG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6ICdSZXNwb25zZScgfVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dKTtcblxuICAgICAgZXhwZWN0KG1vY2tBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJy9hcGkvY2hhdGJvdCcsXG4gICAgICAgIHsgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ1gtQ1NSRi1Ub2tlbic6ICd0ZXN0LXRva2VuJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgQ1NSRiB0b2tlbiBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2V0IGNvb2tpZXMgd2l0aG91dCBDU1JGIHRva2VuXG4gICAgICAoZ2xvYmFsLmRvY3VtZW50IGFzIGFueSkuY29va2llID0gJ3Nlc3Npb25JZD1hYmMxMjM7IHVzZXJJZD00NTYnO1xuXG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIGNoYXRib3QgcmVzcG9uc2VcbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudDogJ1Jlc3BvbnNlJyB9XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UoW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiAndGVzdCcgfV0pO1xuXG4gICAgICBleHBlY3QobW9ja0F4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnL2FwaS9jaGF0Ym90JyxcbiAgICAgICAgeyBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiAndGVzdCcgfV0gfSxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwibW9ja0F4aW9zIiwiZ2V0IiwiZm4iLCJwb3N0IiwiaXNBeGlvc0Vycm9yIiwiYXhpb3MiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdsb2JhbCIsInZhbHVlIiwiY29va2llIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ3cml0YWJsZSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJkb2N1bWVudCIsImFmdGVyRWFjaCIsInJlc2V0QWxsTW9ja3MiLCJtb2NrTWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsIm1vY2tSZXNwb25zZSIsIml0IiwibW9ja1Jlc29sdmVkVmFsdWUiLCJkYXRhIiwic3VjY2VzcyIsImlzRW1wdHkiLCJ2YWx1ZUxlbmd0aCIsInJlc3VsdCIsImNoYXRib3RTZXJ2aWNlIiwic2VuZE1lc3NhZ2UiLCJleHBlY3QiLCJ0b0VxdWFsIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJtZXNzYWdlcyIsImhlYWRlcnMiLCJyZWplY3RzIiwidG9UaHJvdyIsIm5vdCIsInRvSGF2ZUJlZW5DYWxsZWQiLCJtb2NrUmVzb2x2ZWRWYWx1ZU9uY2UiLCJjb25maWdFcnJvciIsIkVycm9yIiwibW9ja1JlamVjdGVkVmFsdWVPbmNlIiwiYXhpb3NFcnJvciIsInJlc3BvbnNlIiwic3RhdHVzIiwiZXJyb3IiLCJ0b0pTT04iLCJtZXNzYWdlIiwibW9ja1JldHVyblZhbHVlIiwicmVxdWVzdCIsInVuZGVmaW5lZCIsImdlbmVyaWNFcnJvciIsImVycm9yV2l0aG91dE1lc3NhZ2UiLCJjb25maWdBeGlvc0Vycm9yIiwiYnVzaW5lc3NJbmZvIiwiZ2V0QnVzaW5lc3NJbmZvIiwiYnVzaW5lc3NOYW1lIiwiaW52ZW50b3J5Q291bnQiLCJ0b3BTZWxsaW5nUHJvZHVjdHMiLCJjdXN0b21lckNvdW50Iiwic3VwcGxpZXJDb3VudCIsInRvSGF2ZVByb3BlcnR5IiwiQXJyYXkiLCJpc0FycmF5IiwidG9CZSIsImV4aXN0cyIsImNoZWNrQ29uZmlndXJhdGlvbiIsImlzQ29uZmlndXJlZCIsImNvbnNvbGVTcHkiLCJzcHlPbiIsImNvbnNvbGUiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJtb2NrUmVzdG9yZSJdLCJtYXBwaW5ncyI6Ijs7Ozt5QkFBa0U7OERBQ2hDO2dDQUN3Qjs7Ozs7O0FBRTFELGFBQWE7QUFDYkEsYUFBSSxD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