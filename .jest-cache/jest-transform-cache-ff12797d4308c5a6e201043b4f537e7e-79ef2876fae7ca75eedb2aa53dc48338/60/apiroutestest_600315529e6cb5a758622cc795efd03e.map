{"version":3,"sources":["/Users/sachin/Documents/md-sports-/tests/integration/api-routes.test.ts"],"sourcesContent":["import { describe, it, expect, beforeAll, afterAll, beforeEach, afterEach } from '@jest/globals';\nimport { createMocks } from 'node-mocks-http';\nimport { PrismaClient } from '@prisma/client';\nimport bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\n\n// Mock Next.js types for testing\ninterface NextRequest {\n  method: string;\n  url: string;\n  headers: Headers;\n  json(): Promise<any>;\n  text(): Promise<string>;\n}\n\ninterface NextResponse {\n  status: number;\n  json: any;\n}\n\n// Mock NextResponse constructor\nconst NextResponse = {\n  json: (data: any, init?: { status?: number }) => ({\n    status: init?.status || 200,\n    json: data,\n  }),\n};\n\n// Import API handlers (adjust paths as needed)\n// These would be the actual API route handlers\ninterface MockApiHandler {\n  POST?: (req: NextRequest) => Promise<NextResponse>;\n  GET?: (req: NextRequest) => Promise<NextResponse>;\n  PUT?: (req: NextRequest) => Promise<NextResponse>;\n  DELETE?: (req: NextRequest) => Promise<NextResponse>;\n}\n\n// Mock implementations for testing\nconst mockPrisma = {\n  user: {\n    findUnique: jest.fn(),\n    create: jest.fn(),\n    findMany: jest.fn(),\n    update: jest.fn(),\n    delete: jest.fn(),\n  },\n  product: {\n    findMany: jest.fn(),\n    findUnique: jest.fn(),\n    create: jest.fn(),\n    update: jest.fn(),\n    delete: jest.fn(),\n  },\n  shop: {\n    findUnique: jest.fn(),\n    create: jest.fn(),\n  },\n  refreshToken: {\n    create: jest.fn(),\n    findUnique: jest.fn(),\n    delete: jest.fn(),\n  },\n  $disconnect: jest.fn(),\n} as any;\n\n// Mock API handlers\nconst authHandler: MockApiHandler = {\n  POST: async (req: NextRequest) => {\n    const body = await req.json();\n    const { email, password } = body;\n\n    if (!email || !password) {\n      return NextResponse.json(\n        { error: 'Email and password are required' },\n        { status: 400 }\n      );\n    }\n\n    // Find user\n    const user = await mockPrisma.user.findUnique({\n      where: { email },\n    });\n\n    if (!user) {\n      return NextResponse.json(\n        { error: 'Invalid credentials' },\n        { status: 401 }\n      );\n    }\n\n    // Verify password\n    const isValid = await bcrypt.compare(password, user.password);\n    if (!isValid) {\n      return NextResponse.json(\n        { error: 'Invalid credentials' },\n        { status: 401 }\n      );\n    }\n\n    // Generate token\n    const token = jwt.sign(\n      { userId: user.id, email: user.email },\n      process.env.JWT_SECRET || 'test-secret',\n      { expiresIn: '1h' }\n    );\n\n    return NextResponse.json({\n      user: {\n        id: user.id,\n        email: user.email,\n        name: user.name,\n      },\n      token,\n    });\n  },\n};\n\nconst productsHandler: MockApiHandler = {\n  GET: async (req: NextRequest) => {\n    const url = new URL(req.url);\n    const shopId = url.searchParams.get('shopId');\n    const page = parseInt(url.searchParams.get('page') || '1');\n    const limit = parseInt(url.searchParams.get('limit') || '10');\n    const search = url.searchParams.get('search');\n\n    if (!shopId) {\n      return NextResponse.json(\n        { error: 'Shop ID is required' },\n        { status: 400 }\n      );\n    }\n\n    // Build where clause\n    const where: any = { shopId };\n    if (search) {\n      where.OR = [\n        { name: { contains: search, mode: 'insensitive' } },\n        { description: { contains: search, mode: 'insensitive' } },\n        { sku: { contains: search, mode: 'insensitive' } },\n      ];\n    }\n\n    const products = await mockPrisma.product.findMany({\n      where,\n      skip: (page - 1) * limit,\n      take: limit,\n      orderBy: { createdAt: 'desc' },\n    });\n\n    return NextResponse.json({\n      products,\n      pagination: {\n        page,\n        limit,\n        total: products.length,\n      },\n    });\n  },\n\n  POST: async (req: NextRequest) => {\n    const authHeader = req.headers.get('authorization');\n    if (!authHeader?.startsWith('Bearer ')) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      );\n    }\n\n    const token = authHeader.substring(7);\n    try {\n      jwt.verify(token, process.env.JWT_SECRET || 'test-secret');\n    } catch {\n      return NextResponse.json(\n        { error: 'Invalid token' },\n        { status: 401 }\n      );\n    }\n\n    const body = await req.json();\n    const { name, description, price, sku, shopId } = body;\n\n    // Validation\n    if (!name || !price || !sku || !shopId) {\n      return NextResponse.json(\n        { error: 'Name, price, SKU, and shop ID are required' },\n        { status: 400 }\n      );\n    }\n\n    if (price <= 0) {\n      return NextResponse.json(\n        { error: 'Price must be greater than 0' },\n        { status: 400 }\n      );\n    }\n\n    // Check if SKU already exists\n    const existingProduct = await mockPrisma.product.findUnique({\n      where: { sku_shopId: { sku, shopId } },\n    });\n\n    if (existingProduct) {\n      return NextResponse.json(\n        { error: 'Product with this SKU already exists' },\n        { status: 409 }\n      );\n    }\n\n    const product = await mockPrisma.product.create({\n      data: {\n        name,\n        description,\n        price,\n        sku,\n        shopId,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      },\n    });\n\n    return NextResponse.json(product, { status: 201 });\n  },\n};\n\nconst userHandler: MockApiHandler = {\n  GET: async (req: NextRequest) => {\n    const authHeader = req.headers.get('authorization');\n    if (!authHeader?.startsWith('Bearer ')) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      );\n    }\n\n    const token = authHeader.substring(7);\n    let decoded: any;\n    try {\n      decoded = jwt.verify(token, process.env.JWT_SECRET || 'test-secret');\n    } catch {\n      return NextResponse.json(\n        { error: 'Invalid token' },\n        { status: 401 }\n      );\n    }\n\n    const user = await mockPrisma.user.findUnique({\n      where: { id: decoded.userId },\n      select: {\n        id: true,\n        email: true,\n        name: true,\n        permissions: true,\n        shopId: true,\n        isActive: true,\n      },\n    });\n\n    if (!user) {\n      return NextResponse.json(\n        { error: 'User not found' },\n        { status: 404 }\n      );\n    }\n\n    return NextResponse.json({ user });\n  },\n};\n\ndescribe('API Routes Integration Tests', () => {\n  beforeAll(() => {\n    process.env.JWT_SECRET = 'test-secret';\n  });\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  afterEach(() => {\n    jest.resetAllMocks();\n  });\n\n  afterAll(async () => {\n    await mockPrisma.$disconnect();\n  });\n\n  describe('POST /api/auth/login', () => {\n    const mockUser = {\n      id: 1,\n      email: 'test@example.com',\n      password: '$2a$10$hashedPassword',\n      name: 'Test User',\n      shopId: 'shop-1',\n    };\n\n    it('should successfully login with valid credentials', async () => {\n      // Arrange\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n      jest.spyOn(bcrypt, 'compare').mockResolvedValue(true as never);\n      jest.spyOn(jwt, 'sign').mockReturnValue('mock-token' as never);\n\n      const request = new NextRequest('http://localhost:3000/api/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          password: 'password123',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Act\n      const response = await authHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(200);\n      expect(data).toEqual({\n        user: {\n          id: 1,\n          email: 'test@example.com',\n          name: 'Test User',\n        },\n        token: 'mock-token',\n      });\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({\n        where: { email: 'test@example.com' },\n      });\n    });\n\n    it('should return 400 for missing credentials', async () => {\n      // Arrange\n      const request = new NextRequest('http://localhost:3000/api/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          // password missing\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Act\n      const response = await authHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(400);\n      expect(data.error).toBe('Email and password are required');\n    });\n\n    it('should return 401 for invalid credentials', async () => {\n      // Arrange\n      mockPrisma.user.findUnique.mockResolvedValue(null);\n\n      const request = new NextRequest('http://localhost:3000/api/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'nonexistent@example.com',\n          password: 'password123',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Act\n      const response = await authHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('Invalid credentials');\n    });\n\n    it('should return 401 for wrong password', async () => {\n      // Arrange\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n      jest.spyOn(bcrypt, 'compare').mockResolvedValue(false as never);\n\n      const request = new NextRequest('http://localhost:3000/api/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          password: 'wrongpassword',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Act\n      const response = await authHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('Invalid credentials');\n    });\n  });\n\n  describe('GET /api/products', () => {\n    const mockProducts = [\n      {\n        id: 1,\n        name: 'Product 1',\n        description: 'Description 1',\n        price: 100,\n        sku: 'SKU001',\n        shopId: 'shop-1',\n        createdAt: new Date(),\n      },\n      {\n        id: 2,\n        name: 'Product 2',\n        description: 'Description 2',\n        price: 200,\n        sku: 'SKU002',\n        shopId: 'shop-1',\n        createdAt: new Date(),\n      },\n    ];\n\n    it('should return products for valid shop ID', async () => {\n      // Arrange\n      mockPrisma.product.findMany.mockResolvedValue(mockProducts);\n\n      const request = new NextRequest(\n        'http://localhost:3000/api/products?shopId=shop-1&page=1&limit=10'\n      );\n\n      // Act\n      const response = await productsHandler.GET!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(200);\n      expect(data.products).toEqual(mockProducts);\n      expect(data.pagination).toEqual({\n        page: 1,\n        limit: 10,\n        total: 2,\n      });\n    });\n\n    it('should return 400 for missing shop ID', async () => {\n      // Arrange\n      const request = new NextRequest('http://localhost:3000/api/products');\n\n      // Act\n      const response = await productsHandler.GET!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(400);\n      expect(data.error).toBe('Shop ID is required');\n    });\n\n    it('should handle search functionality', async () => {\n      // Arrange\n      const filteredProducts = [mockProducts[0]];\n      mockPrisma.product.findMany.mockResolvedValue(filteredProducts);\n\n      const request = new NextRequest(\n        'http://localhost:3000/api/products?shopId=shop-1&search=Product%201'\n      );\n\n      // Act\n      const response = await productsHandler.GET!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(200);\n      expect(data.products).toEqual(filteredProducts);\n      expect(mockPrisma.product.findMany).toHaveBeenCalledWith({\n        where: {\n          shopId: 'shop-1',\n          OR: [\n            { name: { contains: 'Product 1', mode: 'insensitive' } },\n            { description: { contains: 'Product 1', mode: 'insensitive' } },\n            { sku: { contains: 'Product 1', mode: 'insensitive' } },\n          ],\n        },\n        skip: 0,\n        take: 10,\n        orderBy: { createdAt: 'desc' },\n      });\n    });\n  });\n\n  describe('POST /api/products', () => {\n    const validToken = 'valid-token';\n    const mockProduct = {\n      id: 1,\n      name: 'New Product',\n      description: 'New Description',\n      price: 150,\n      sku: 'SKU003',\n      shopId: 'shop-1',\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    beforeEach(() => {\n      jest.spyOn(jwt, 'verify').mockReturnValue({ userId: 1 } as never);\n    });\n\n    it('should create product with valid data and auth', async () => {\n      // Arrange\n      mockPrisma.product.findUnique.mockResolvedValue(null); // SKU doesn't exist\n      mockPrisma.product.create.mockResolvedValue(mockProduct);\n\n      const request = new NextRequest('http://localhost:3000/api/products', {\n        method: 'POST',\n        body: JSON.stringify({\n          name: 'New Product',\n          description: 'New Description',\n          price: 150,\n          sku: 'SKU003',\n          shopId: 'shop-1',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${validToken}`,\n        },\n      });\n\n      // Act\n      const response = await productsHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(201);\n      expect(data).toEqual(mockProduct);\n      expect(mockPrisma.product.create).toHaveBeenCalledWith({\n        data: expect.objectContaining({\n          name: 'New Product',\n          description: 'New Description',\n          price: 150,\n          sku: 'SKU003',\n          shopId: 'shop-1',\n        }),\n      });\n    });\n\n    it('should return 401 for missing authorization', async () => {\n      // Arrange\n      const request = new NextRequest('http://localhost:3000/api/products', {\n        method: 'POST',\n        body: JSON.stringify({\n          name: 'New Product',\n          price: 150,\n          sku: 'SKU003',\n          shopId: 'shop-1',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Act\n      const response = await productsHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('Unauthorized');\n    });\n\n    it('should return 400 for invalid price', async () => {\n      // Arrange\n      const request = new NextRequest('http://localhost:3000/api/products', {\n        method: 'POST',\n        body: JSON.stringify({\n          name: 'New Product',\n          price: -10, // Invalid price\n          sku: 'SKU003',\n          shopId: 'shop-1',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${validToken}`,\n        },\n      });\n\n      // Act\n      const response = await productsHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(400);\n      expect(data.error).toBe('Price must be greater than 0');\n    });\n\n    it('should return 409 for duplicate SKU', async () => {\n      // Arrange\n      mockPrisma.product.findUnique.mockResolvedValue(mockProduct); // SKU exists\n\n      const request = new NextRequest('http://localhost:3000/api/products', {\n        method: 'POST',\n        body: JSON.stringify({\n          name: 'New Product',\n          price: 150,\n          sku: 'SKU003',\n          shopId: 'shop-1',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${validToken}`,\n        },\n      });\n\n      // Act\n      const response = await productsHandler.POST!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(409);\n      expect(data.error).toBe('Product with this SKU already exists');\n    });\n  });\n\n  describe('GET /api/user', () => {\n    const mockUser = {\n      id: 1,\n      email: 'test@example.com',\n      name: 'Test User',\n      permissions: ['inventory:read', 'sales:create'],\n      shopId: 'shop-1',\n      isActive: true,\n    };\n\n    it('should return user data for valid token', async () => {\n      // Arrange\n      jest.spyOn(jwt, 'verify').mockReturnValue({ userId: 1 } as never);\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n\n      const request = new NextRequest('http://localhost:3000/api/user', {\n        headers: {\n          'Authorization': 'Bearer valid-token',\n        },\n      });\n\n      // Act\n      const response = await userHandler.GET!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(200);\n      expect(data.user).toEqual(mockUser);\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({\n        where: { id: 1 },\n        select: {\n          id: true,\n          email: true,\n          name: true,\n          permissions: true,\n          shopId: true,\n          isActive: true,\n        },\n      });\n    });\n\n    it('should return 401 for invalid token', async () => {\n      // Arrange\n      jest.spyOn(jwt, 'verify').mockImplementation(() => {\n        throw new Error('Invalid token');\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/user', {\n        headers: {\n          'Authorization': 'Bearer invalid-token',\n        },\n      });\n\n      // Act\n      const response = await userHandler.GET!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('Invalid token');\n    });\n\n    it('should return 404 for non-existent user', async () => {\n      // Arrange\n      jest.spyOn(jwt, 'verify').mockReturnValue({ userId: 999 } as never);\n      mockPrisma.user.findUnique.mockResolvedValue(null);\n\n      const request = new NextRequest('http://localhost:3000/api/user', {\n        headers: {\n          'Authorization': 'Bearer valid-token',\n        },\n      });\n\n      // Act\n      const response = await userHandler.GET!(request);\n      const data = await response.json();\n\n      // Assert\n      expect(response.status).toBe(404);\n      expect(data.error).toBe('User not found');\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle database connection errors', async () => {\n      // Arrange\n      mockPrisma.user.findUnique.mockRejectedValue(new Error('Database connection failed'));\n\n      const request = new NextRequest('http://localhost:3000/api/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          password: 'password123',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Act & Assert\n      await expect(authHandler.POST!(request)).rejects.toThrow('Database connection failed');\n    });\n\n    it('should handle malformed JSON requests', async () => {\n      // Arrange\n      const request = new NextRequest('http://localhost:3000/api/auth/login', {\n        method: 'POST',\n        body: 'invalid json',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Act & Assert\n      await expect(authHandler.POST!(request)).rejects.toThrow();\n    });\n  });\n\n  describe('Rate Limiting Simulation', () => {\n    it('should handle multiple concurrent requests', async () => {\n      // Arrange\n      const mockUser = {\n        id: 1,\n        email: 'test@example.com',\n        password: '$2a$10$hashedPassword',\n        name: 'Test User',\n        shopId: 'shop-1',\n      };\n      \n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n      jest.spyOn(bcrypt, 'compare').mockResolvedValue(true as never);\n      jest.spyOn(jwt, 'sign').mockReturnValue('mock-token' as never);\n\n      const requests = Array.from({ length: 5 }, () => \n        new NextRequest('http://localhost:3000/api/auth/login', {\n          method: 'POST',\n          body: JSON.stringify({\n            email: 'test@example.com',\n            password: 'password123',\n          }),\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        })\n      );\n\n      // Act\n      const responses = await Promise.all(\n        requests.map(req => authHandler.POST!(req))\n      );\n\n      // Assert\n      responses.forEach(response => {\n        expect(response.status).toBe(200);\n      });\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledTimes(5);\n    });\n  });\n});"],"names":["NextResponse","json","data","init","status","mockPrisma","user","findUnique","jest","fn","create","findMany","update","delete","product","shop","refreshToken","$disconnect","authHandler","POST","req","body","email","password","error","where","isValid","bcrypt","compare","token","jwt","sign","userId","id","process","env","JWT_SECRET","expiresIn","name","productsHandler","GET","url","URL","shopId","searchParams","get","page","parseInt","limit","search","OR","contains","mode","description","sku","products","skip","take","orderBy","createdAt","pagination","total","length","authHeader","headers","startsWith","substring","verify","price","existingProduct","sku_shopId","Date","updatedAt","userHandler","decoded","select","permissions","isActive","describe","beforeAll","beforeEach","clearAllMocks","afterEach","resetAllMocks","afterAll","mockUser","it","mockResolvedValue","spyOn","mockReturnValue","request","NextRequest","method","JSON","stringify","response","expect","toBe","toEqual","toHaveBeenCalledWith","mockProducts","filteredProducts","validToken","mockProduct","objectContaining","mockImplementation","Error","mockRejectedValue","rejects","toThrow","requests","Array","from","responses","Promise","all","map","forEach","toHaveBeenCalledTimes"],"mappings":"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"}