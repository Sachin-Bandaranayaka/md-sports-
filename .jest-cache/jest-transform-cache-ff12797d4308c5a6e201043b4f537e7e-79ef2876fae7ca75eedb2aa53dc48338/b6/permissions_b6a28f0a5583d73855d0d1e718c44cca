fb31b80f22a548f06b9a9b5cc30ec34a
/**
 * Centralized permission checking utilities
 */ /**
 * Check if user has admin permissions or specific permission
 * @param permissions - Array of user permissions
 * @param requiredPermission - The specific permission required
 * @returns boolean indicating if user has permission
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    hasAllPermissions: function() {
        return hasAllPermissions;
    },
    hasAnyPermission: function() {
        return hasAnyPermission;
    },
    hasPermission: function() {
        return hasPermission;
    },
    isAdmin: function() {
        return isAdmin;
    }
});
function hasPermission(permissions, requiredPermission) {
    return permissions.includes("*") || permissions.includes("admin:all") || permissions.includes("ALL") || permissions.includes(requiredPermission);
}
function hasAnyPermission(permissions, requiredPermissions) {
    return permissions.includes("*") || permissions.includes("admin:all") || permissions.includes("ALL") || requiredPermissions.some((permission)=>permissions.includes(permission));
}
function hasAllPermissions(permissions, requiredPermissions) {
    return permissions.includes("*") || permissions.includes("admin:all") || permissions.includes("ALL") || requiredPermissions.every((permission)=>permissions.includes(permission));
}
function isAdmin(permissions) {
    return permissions.includes("*") || permissions.includes("admin:all") || permissions.includes("ALL") || permissions.includes("shop:manage") || permissions.includes("user:manage");
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vRG9jdW1lbnRzL21kLXNwb3J0cy0vc3JjL2xpYi91dGlscy9wZXJtaXNzaW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENlbnRyYWxpemVkIHBlcm1pc3Npb24gY2hlY2tpbmcgdXRpbGl0aWVzXG4gKi9cblxuLyoqXG4gKiBDaGVjayBpZiB1c2VyIGhhcyBhZG1pbiBwZXJtaXNzaW9ucyBvciBzcGVjaWZpYyBwZXJtaXNzaW9uXG4gKiBAcGFyYW0gcGVybWlzc2lvbnMgLSBBcnJheSBvZiB1c2VyIHBlcm1pc3Npb25zXG4gKiBAcGFyYW0gcmVxdWlyZWRQZXJtaXNzaW9uIC0gVGhlIHNwZWNpZmljIHBlcm1pc3Npb24gcmVxdWlyZWRcbiAqIEByZXR1cm5zIGJvb2xlYW4gaW5kaWNhdGluZyBpZiB1c2VyIGhhcyBwZXJtaXNzaW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHBlcm1pc3Npb25zOiBzdHJpbmdbXSwgcmVxdWlyZWRQZXJtaXNzaW9uOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gcGVybWlzc2lvbnMuaW5jbHVkZXMoJyonKSB8fCBcbiAgICAgICAgICAgcGVybWlzc2lvbnMuaW5jbHVkZXMoJ2FkbWluOmFsbCcpIHx8IFxuICAgICAgICAgICBwZXJtaXNzaW9ucy5pbmNsdWRlcygnQUxMJykgfHwgXG4gICAgICAgICAgIHBlcm1pc3Npb25zLmluY2x1ZGVzKHJlcXVpcmVkUGVybWlzc2lvbik7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdXNlciBoYXMgYW55IG9mIHRoZSBzcGVjaWZpZWQgcGVybWlzc2lvbnMgb3IgYWRtaW4gcGVybWlzc2lvbnNcbiAqIEBwYXJhbSBwZXJtaXNzaW9ucyAtIEFycmF5IG9mIHVzZXIgcGVybWlzc2lvbnNcbiAqIEBwYXJhbSByZXF1aXJlZFBlcm1pc3Npb25zIC0gQXJyYXkgb2YgcGVybWlzc2lvbnMsIHVzZXIgbmVlZHMgYXQgbGVhc3Qgb25lXG4gKiBAcmV0dXJucyBib29sZWFuIGluZGljYXRpbmcgaWYgdXNlciBoYXMgYW55IG9mIHRoZSByZXF1aXJlZCBwZXJtaXNzaW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzQW55UGVybWlzc2lvbihwZXJtaXNzaW9uczogc3RyaW5nW10sIHJlcXVpcmVkUGVybWlzc2lvbnM6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHBlcm1pc3Npb25zLmluY2x1ZGVzKCcqJykgfHwgXG4gICAgICAgICAgIHBlcm1pc3Npb25zLmluY2x1ZGVzKCdhZG1pbjphbGwnKSB8fCBcbiAgICAgICAgICAgcGVybWlzc2lvbnMuaW5jbHVkZXMoJ0FMTCcpIHx8IFxuICAgICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zLnNvbWUocGVybWlzc2lvbiA9PiBwZXJtaXNzaW9ucy5pbmNsdWRlcyhwZXJtaXNzaW9uKSk7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdXNlciBoYXMgYWxsIG9mIHRoZSBzcGVjaWZpZWQgcGVybWlzc2lvbnMgb3IgYWRtaW4gcGVybWlzc2lvbnNcbiAqIEBwYXJhbSBwZXJtaXNzaW9ucyAtIEFycmF5IG9mIHVzZXIgcGVybWlzc2lvbnNcbiAqIEBwYXJhbSByZXF1aXJlZFBlcm1pc3Npb25zIC0gQXJyYXkgb2YgcGVybWlzc2lvbnMsIHVzZXIgbmVlZHMgYWxsIG9mIHRoZW1cbiAqIEByZXR1cm5zIGJvb2xlYW4gaW5kaWNhdGluZyBpZiB1c2VyIGhhcyBhbGwgcmVxdWlyZWQgcGVybWlzc2lvbnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0FsbFBlcm1pc3Npb25zKHBlcm1pc3Npb25zOiBzdHJpbmdbXSwgcmVxdWlyZWRQZXJtaXNzaW9uczogc3RyaW5nW10pOiBib29sZWFuIHtcbiAgICByZXR1cm4gcGVybWlzc2lvbnMuaW5jbHVkZXMoJyonKSB8fCBcbiAgICAgICAgICAgcGVybWlzc2lvbnMuaW5jbHVkZXMoJ2FkbWluOmFsbCcpIHx8IFxuICAgICAgICAgICBwZXJtaXNzaW9ucy5pbmNsdWRlcygnQUxMJykgfHwgXG4gICAgICAgICAgIHJlcXVpcmVkUGVybWlzc2lvbnMuZXZlcnkocGVybWlzc2lvbiA9PiBwZXJtaXNzaW9ucy5pbmNsdWRlcyhwZXJtaXNzaW9uKSk7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdXNlciBpcyBhbiBhZG1pbiAoaGFzIGFkbWluOmFsbCwgKiwgb3Igc3BlY2lmaWMgYWRtaW4gcGVybWlzc2lvbnMpXG4gKiBAcGFyYW0gcGVybWlzc2lvbnMgLSBBcnJheSBvZiB1c2VyIHBlcm1pc3Npb25zXG4gKiBAcmV0dXJucyBib29sZWFuIGluZGljYXRpbmcgaWYgdXNlciBpcyBhbiBhZG1pblxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBZG1pbihwZXJtaXNzaW9uczogc3RyaW5nW10pOiBib29sZWFuIHtcbiAgICByZXR1cm4gcGVybWlzc2lvbnMuaW5jbHVkZXMoJyonKSB8fCBcbiAgICAgICAgICAgcGVybWlzc2lvbnMuaW5jbHVkZXMoJ2FkbWluOmFsbCcpIHx8IFxuICAgICAgICAgICBwZXJtaXNzaW9ucy5pbmNsdWRlcygnQUxMJykgfHwgXG4gICAgICAgICAgIHBlcm1pc3Npb25zLmluY2x1ZGVzKCdzaG9wOm1hbmFnZScpIHx8IFxuICAgICAgICAgICBwZXJtaXNzaW9ucy5pbmNsdWRlcygndXNlcjptYW5hZ2UnKTtcbn0iXSwibmFtZXMiOlsiaGFzQWxsUGVybWlzc2lvbnMiLCJoYXNBbnlQZXJtaXNzaW9uIiwiaGFzUGVybWlzc2lvbiIsImlzQWRtaW4iLCJwZXJtaXNzaW9ucyIsInJlcXVpcmVkUGVybWlzc2lvbiIsImluY2x1ZGVzIiwicmVxdWlyZWRQZXJtaXNzaW9ucyIsInNvbWUiLCJwZXJtaXNzaW9uIiwiZXZlcnkiXSwibWFwcGluZ3MiOiJBQUFBOztDQUVDLEdBRUQ7Ozs7O0NBS0M7Ozs7Ozs7Ozs7O0lBMkJlQSxpQkFBaUI7ZUFBakJBOztJQWJBQyxnQkFBZ0I7ZUFBaEJBOztJQWJBQyxhQUFhO2VBQWJBOztJQXNDQUMsT0FBTztlQUFQQTs7O0FBdENULFNBQVNELGNBQWNFLFdBQXFCLEVBQUVDLGtCQUEwQjtJQUMzRSxPQUFPRCxZQUFZRSxRQUFRLENBQUMsUUFDckJGLFlBQVlFLFFBQVEsQ0FBQyxnQkFDckJGLFlBQVlFLFFBQVEsQ0FBQyxVQUNyQkYsWUFBWUUsUUFBUSxDQUFDRDtBQUNoQztBQVFPLFNBQVNKLGlCQUFpQkcsV0FBcUIsRUFBRUcsbUJBQTZCO0lBQ2pGLE9BQU9ILFlBQVlFLFFBQVEsQ0FBQyxRQUNyQkYsWUFBWUUsUUFBUSxDQUFDLGdCQUNyQkYsWUFBWUUsUUFBUSxDQUFDLFVBQ3JCQyxvQkFBb0JDLElBQUksQ0FBQ0MsQ0FBQUEsYUFBY0wsWUFBWUUsUUFBUSxDQUFDRztBQUN2RTtBQVFPLFNBQVNULGtCQUFrQkksV0FBcUIsRUFBRUcsbUJBQTZCO0lBQ2xGLE9BQU9ILFlBQVlFLFFBQVEsQ0FBQyxRQUNyQkYsWUFBWUUsUUFBUSxDQUFDLGdCQUNyQkYsWUFBWUUsUUFBUSxDQUFDLFVBQ3JCQyxvQkFBb0JHLEtBQUssQ0FBQ0QsQ0FBQUEsYUFBY0wsWUFBWUUsUUFBUSxDQUFDRztBQUN4RTtBQU9PLFNBQVNOLFFBQVFDLFdBQXFCO0lBQ3pDLE9BQU9BLFlBQVlFLFFBQVEsQ0FBQyxRQUNyQkYsWUFBWUUsUUFBUSxDQUFDLGdCQUNyQkYsWUFBWUUsUUFBUSxDQUFDLFVBQ3JCRixZQUFZRSxRQUFRLENBQUMsa0JBQ3JCRixZQUFZRSxRQUFRLENBQUM7QUFDaEMifQ==