{"version":3,"sources":["/Users/sachin/Documents/md-sports-/tests/setup/global-setup.js"],"sourcesContent":["const { PrismaClient } = require('@prisma/client');\n\nmodule.exports = async () => {\n  console.log('üöÄ Setting up Jest global environment...');\n  \n  // Set test environment variables\n  process.env.NODE_ENV = 'test';\n  process.env.DATABASE_URL = process.env.TEST_DATABASE_URL || process.env.DATABASE_URL;\n  \n  // Initialize test database if needed\n  if (process.env.SETUP_TEST_DB === 'true') {\n    const prisma = new PrismaClient();\n    \n    try {\n      // Ensure database connection\n      await prisma.$connect();\n      console.log('‚úÖ Test database connected');\n      \n      // Run any necessary setup\n      await setupTestData(prisma);\n      \n    } catch (error) {\n      console.error('‚ùå Test database setup failed:', error);\n      throw error;\n    } finally {\n      await prisma.$disconnect();\n    }\n  }\n  \n  console.log('‚úÖ Jest global setup completed');\n};\n\nasync function setupTestData(prisma) {\n  // Create minimal test data if needed\n  try {\n    // Check if test shop exists\n    const testShop = await prisma.shop.findFirst({\n      where: { id: 'test-shop-jest' }\n    });\n    \n    if (!testShop) {\n      await prisma.shop.create({\n        data: {\n          id: 'test-shop-jest',\n          name: 'Jest Test Shop',\n          location: 'Test Location'\n        }\n      });\n      console.log('üì¶ Test shop created for Jest');\n    }\n  } catch (error) {\n    console.warn('‚ö†Ô∏è Test data setup warning:', error.message);\n    // Don't fail setup for data creation issues\n  }\n}"],"names":["PrismaClient","require","module","exports","console","log","process","env","NODE_ENV","DATABASE_URL","TEST_DATABASE_URL","SETUP_TEST_DB","prisma","$connect","setupTestData","error","$disconnect","testShop","shop","findFirst","where","id","create","data","name","location","warn","message"],"mappings":";AAAA,MAAM,EAAEA,YAAY,EAAE,GAAGC,QAAQ;AAEjCC,OAAOC,OAAO,GAAG;IACfC,QAAQC,GAAG,CAAC;IAEZ,iCAAiC;IACjCC,QAAQC,GAAG,CAACC,QAAQ,GAAG;IACvBF,QAAQC,GAAG,CAACE,YAAY,GAAGH,QAAQC,GAAG,CAACG,iBAAiB,IAAIJ,QAAQC,GAAG,CAACE,YAAY;IAEpF,qCAAqC;IACrC,IAAIH,QAAQC,GAAG,CAACI,aAAa,KAAK,QAAQ;QACxC,MAAMC,SAAS,IAAIZ;QAEnB,IAAI;YACF,6BAA6B;YAC7B,MAAMY,OAAOC,QAAQ;YACrBT,QAAQC,GAAG,CAAC;YAEZ,0BAA0B;YAC1B,MAAMS,cAAcF;QAEtB,EAAE,OAAOG,OAAO;YACdX,QAAQW,KAAK,CAAC,iCAAiCA;YAC/C,MAAMA;QACR,SAAU;YACR,MAAMH,OAAOI,WAAW;QAC1B;IACF;IAEAZ,QAAQC,GAAG,CAAC;AACd;AAEA,eAAeS,cAAcF,MAAM;IACjC,qCAAqC;IACrC,IAAI;QACF,4BAA4B;QAC5B,MAAMK,WAAW,MAAML,OAAOM,IAAI,CAACC,SAAS,CAAC;YAC3CC,OAAO;gBAAEC,IAAI;YAAiB;QAChC;QAEA,IAAI,CAACJ,UAAU;YACb,MAAML,OAAOM,IAAI,CAACI,MAAM,CAAC;gBACvBC,MAAM;oBACJF,IAAI;oBACJG,MAAM;oBACNC,UAAU;gBACZ;YACF;YACArB,QAAQC,GAAG,CAAC;QACd;IACF,EAAE,OAAOU,OAAO;QACdX,QAAQsB,IAAI,CAAC,+BAA+BX,MAAMY,OAAO;IACzD,4CAA4C;IAC9C;AACF"}