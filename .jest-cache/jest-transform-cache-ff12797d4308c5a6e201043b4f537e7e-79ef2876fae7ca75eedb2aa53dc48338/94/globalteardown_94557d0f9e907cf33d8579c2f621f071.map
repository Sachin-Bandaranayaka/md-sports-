{"version":3,"sources":["/Users/sachin/Documents/md-sports-/tests/setup/global-teardown.js"],"sourcesContent":["const { PrismaClient } = require('@prisma/client');\n\nconst { cleanupCache } = require('../../src/lib/cache');\n\nmodule.exports = async () => {\n  console.log('üßπ Starting Jest global teardown...');\n  \n  // Clean up cache intervals\n  try {\n    cleanupCache();\n    console.log('üßπ Cache cleanup completed');\n  } catch (error) {\n    console.error('‚ùå Cache cleanup failed:', error);\n  }\n  \n  // Clean up test database if needed\n  if (process.env.SETUP_TEST_DB === 'true') {\n    const prisma = new PrismaClient();\n    \n    try {\n      await prisma.$connect();\n      \n      // Clean up test data\n      await cleanupTestData(prisma);\n      \n      console.log('üóëÔ∏è Test data cleaned up');\n      \n    } catch (error) {\n      console.error('‚ùå Test cleanup failed:', error);\n      // Don't throw to avoid failing the teardown\n    } finally {\n      await prisma.$disconnect();\n    }\n  }\n  \n  console.log('‚úÖ Jest global teardown completed');\n};\n\nasync function cleanupTestData(prisma) {\n  try {\n    // Clean up Jest-specific test data\n    await prisma.shop.deleteMany({\n      where: {\n        id: 'test-shop-jest'\n      }\n    });\n    \n    // Clean up any other test artifacts\n    await prisma.user.deleteMany({\n      where: {\n        email: {\n          endsWith: '@jest.test'\n        }\n      }\n    });\n    \n  } catch (error) {\n    console.warn('‚ö†Ô∏è Cleanup warning:', error.message);\n  }\n}"],"names":["PrismaClient","require","cleanupCache","module","exports","console","log","error","process","env","SETUP_TEST_DB","prisma","$connect","cleanupTestData","$disconnect","shop","deleteMany","where","id","user","email","endsWith","warn","message"],"mappings":";AAAA,MAAM,EAAEA,YAAY,EAAE,GAAGC,QAAQ;AAEjC,MAAM,EAAEC,YAAY,EAAE,GAAGD,QAAQ;AAEjCE,OAAOC,OAAO,GAAG;IACfC,QAAQC,GAAG,CAAC;IAEZ,2BAA2B;IAC3B,IAAI;QACFJ;QACAG,QAAQC,GAAG,CAAC;IACd,EAAE,OAAOC,OAAO;QACdF,QAAQE,KAAK,CAAC,2BAA2BA;IAC3C;IAEA,mCAAmC;IACnC,IAAIC,QAAQC,GAAG,CAACC,aAAa,KAAK,QAAQ;QACxC,MAAMC,SAAS,IAAIX;QAEnB,IAAI;YACF,MAAMW,OAAOC,QAAQ;YAErB,qBAAqB;YACrB,MAAMC,gBAAgBF;YAEtBN,QAAQC,GAAG,CAAC;QAEd,EAAE,OAAOC,OAAO;YACdF,QAAQE,KAAK,CAAC,0BAA0BA;QACxC,4CAA4C;QAC9C,SAAU;YACR,MAAMI,OAAOG,WAAW;QAC1B;IACF;IAEAT,QAAQC,GAAG,CAAC;AACd;AAEA,eAAeO,gBAAgBF,MAAM;IACnC,IAAI;QACF,mCAAmC;QACnC,MAAMA,OAAOI,IAAI,CAACC,UAAU,CAAC;YAC3BC,OAAO;gBACLC,IAAI;YACN;QACF;QAEA,oCAAoC;QACpC,MAAMP,OAAOQ,IAAI,CAACH,UAAU,CAAC;YAC3BC,OAAO;gBACLG,OAAO;oBACLC,UAAU;gBACZ;YACF;QACF;IAEF,EAAE,OAAOd,OAAO;QACdF,QAAQiB,IAAI,CAAC,uBAAuBf,MAAMgB,OAAO;IACnD;AACF"}