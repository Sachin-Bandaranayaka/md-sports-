{"version":3,"sources":["/Users/sachin/Documents/md-sports-/tests/unit/cacheManagement.test.ts"],"sourcesContent":["import { Redis } from 'ioredis';\n\n// Mock cache service\nconst mockCacheService = {\n  get: jest.fn(),\n  set: jest.fn(),\n  delete: jest.fn(),\n  deletePattern: jest.fn(),\n  clear: jest.fn(),\n};\n\n// Mock Redis\nconst mockRedis = {\n  get: jest.fn(),\n  set: jest.fn(),\n  setex: jest.fn(),\n  del: jest.fn(),\n  keys: jest.fn(),\n  flushall: jest.fn(),\n  ping: jest.fn(),\n  quit: jest.fn(),\n  on: jest.fn(),\n  connect: jest.fn(),\n  disconnect: jest.fn(),\n};\n\n// Mock ioredis\njest.mock('ioredis', () => {\n  return {\n    Redis: jest.fn().mockImplementation(() => mockRedis),\n  };\n});\n\n// Mock the inventory cache service\nconst mockInventoryCache = {\n  get: jest.fn(),\n  set: jest.fn(),\n  invalidateInventoryData: jest.fn(),\n  generateKey: jest.fn(),\n  warmPopularInventoryData: jest.fn(),\n  trackFilterUsage: jest.fn(),\n  getMetrics: jest.fn(),\n};\n\njest.mock('@/lib/inventoryCache', () => ({\n  inventoryCacheService: mockInventoryCache,\n}));\n\n// Mock console methods\nconst consoleSpy = {\n  log: jest.spyOn(console, 'log').mockImplementation(() => {}),\n  error: jest.spyOn(console, 'error').mockImplementation(() => {}),\n  warn: jest.spyOn(console, 'warn').mockImplementation(() => {}),\n};\n\ndescribe('Cache Management Tests', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    consoleSpy.log.mockClear();\n    consoleSpy.error.mockClear();\n    consoleSpy.warn.mockClear();\n  });\n\n  afterAll(() => {\n    consoleSpy.log.mockRestore();\n    consoleSpy.error.mockRestore();\n    consoleSpy.warn.mockRestore();\n  });\n\n  describe('Basic Cache Operations', () => {\n    describe('Memory Cache', () => {\n      it('should store and retrieve data from memory cache', async () => {\n        const testData = { id: 1, name: 'Test Data' };\n        const cacheKey = 'test:key:1';\n\n        // Mock memory cache behavior\n        const memoryCache = new Map();\n        memoryCache.set(cacheKey, JSON.stringify(testData));\n\n        // Simulate cache set\n        mockCacheService.set.mockResolvedValue(undefined);\n        await mockCacheService.set(cacheKey, testData, 300);\n        \n        // Simulate cache get\n        mockCacheService.get.mockResolvedValue(testData);\n        const result = await mockCacheService.get(cacheKey);\n\n        expect(result).toEqual(testData);\n      });\n\n      it('should handle cache expiration', async () => {\n        const testData = { id: 1, name: 'Expiring Data' };\n        const cacheKey = 'test:expiring:1';\n        const ttl = 1; // 1 second\n\n        mockCacheService.set.mockResolvedValue(undefined);\n        await mockCacheService.set(cacheKey, testData, ttl);\n\n        // Simulate time passing and cache expiration\n        mockCacheService.get.mockResolvedValue(null);\n        const result = await mockCacheService.get(cacheKey);\n        expect(result).toBeNull();\n      });\n\n      it('should handle cache miss gracefully', async () => {\n        mockCacheService.get.mockResolvedValue(null);\n        const result = await mockCacheService.get('non:existent:key');\n        expect(result).toBeNull();\n      });\n    });\n\n    describe('Redis Cache', () => {\n      it('should store data in Redis when available', async () => {\n        const testData = { id: 1, name: 'Redis Test' };\n        const cacheKey = 'redis:test:1';\n        const ttl = 300;\n\n        mockRedis.setex.mockResolvedValue('OK');\n\n        mockCacheService.set.mockResolvedValue(undefined);\n        await mockCacheService.set(cacheKey, testData, ttl);\n\n        expect(mockRedis.setex).toHaveBeenCalledWith(\n          cacheKey,\n          ttl,\n          JSON.stringify(testData)\n        );\n      });\n\n      it('should retrieve data from Redis', async () => {\n        const testData = { id: 1, name: 'Redis Test' };\n        const cacheKey = 'redis:test:1';\n\n        mockRedis.get.mockResolvedValue(JSON.stringify(testData));\n\n        mockCacheService.get.mockResolvedValue(testData);\n        const result = await mockCacheService.get(cacheKey);\n\n        expect(mockCacheService.get).toHaveBeenCalledWith(cacheKey);\n        expect(result).toEqual(testData);\n      });\n\n      it('should handle Redis connection errors gracefully', async () => {\n        const testData = { id: 1, name: 'Error Test' };\n        const cacheKey = 'redis:error:1';\n\n        mockRedis.setex.mockRejectedValue(new Error('Redis connection failed'));\n\n        // Should not throw error, should fallback to memory cache\n        mockCacheService.set.mockResolvedValue(undefined);\n        await expect(mockCacheService.set(cacheKey, testData, 300)).resolves.not.toThrow();\n        expect(mockCacheService.set).toHaveBeenCalledWith(cacheKey, testData, 300);\n      });\n\n      it('should handle Redis get errors gracefully', async () => {\n        const cacheKey = 'redis:error:get';\n\n        mockRedis.get.mockRejectedValue(new Error('Redis get failed'));\n\n        mockCacheService.get.mockResolvedValue(null);\n        const result = await mockCacheService.get(cacheKey);\n\n        expect(result).toBeNull();\n        expect(mockCacheService.get).toHaveBeenCalledWith(cacheKey);\n      });\n    });\n\n    describe('Cache Invalidation', () => {\n      it('should delete specific cache keys', async () => {\n        const cacheKey = 'test:delete:1';\n\n        mockCacheService.delete.mockResolvedValue(undefined);\n        await mockCacheService.delete(cacheKey);\n\n        expect(mockCacheService.delete).toHaveBeenCalledWith(cacheKey);\n      });\n\n      it('should delete multiple cache keys by pattern', async () => {\n        const pattern = 'test:pattern:*';\n        const matchingKeys = ['test:pattern:1', 'test:pattern:2', 'test:pattern:3'];\n\n        mockCacheService.deletePattern.mockResolvedValue(undefined);\n        await mockCacheService.deletePattern(pattern);\n\n        expect(mockCacheService.deletePattern).toHaveBeenCalledWith(pattern);\n      });\n\n      it('should handle pattern deletion with no matches', async () => {\n        const pattern = 'test:nomatch:*';\n\n        mockCacheService.deletePattern.mockResolvedValue(undefined);\n        await mockCacheService.deletePattern(pattern);\n\n        expect(mockCacheService.deletePattern).toHaveBeenCalledWith(pattern);\n      });\n\n      it('should clear all cache data', async () => {\n        mockCacheService.clear.mockResolvedValue(undefined);\n        await mockCacheService.clear();\n\n        expect(mockCacheService.clear).toHaveBeenCalled();\n      });\n    });\n  });\n\n  describe('Inventory Cache Service', () => {\n    const mockInventoryData = {\n      items: [\n        { id: 1, productId: 1, shopId: 'shop1', quantity: 100 },\n        { id: 2, productId: 2, shopId: 'shop1', quantity: 50 },\n      ],\n      total: 2,\n      page: 1,\n      limit: 20,\n    };\n\n    const mockFilters = {\n      shopId: 'shop1',\n      page: 1,\n      limit: 20,\n      status: 'In Stock',\n    };\n\n    describe('Cache Key Generation', () => {\n      it('should generate consistent cache keys', () => {\n        const baseKey = 'inventory:summary';\n        const expectedKey = 'inventory:summary:shop:shop1:status:In Stock:page:1:limit:20';\n\n        mockInventoryCache.generateKey.mockReturnValue(expectedKey);\n\n        const result = mockInventoryCache.generateKey(baseKey, mockFilters);\n\n        expect(result).toBe(expectedKey);\n        expect(mockInventoryCache.generateKey).toHaveBeenCalledWith(baseKey, mockFilters);\n      });\n\n      it('should handle filters with special characters', () => {\n        const filtersWithSpecialChars = {\n          ...mockFilters,\n          search: 'test product & more',\n        };\n        const expectedKey = 'inventory:summary:shop:shop1:status:In Stock:search:test%20product%20%26%20more:page:1:limit:20';\n\n        mockInventoryCache.generateKey.mockReturnValue(expectedKey);\n\n        const result = mockInventoryCache.generateKey('inventory:summary', filtersWithSpecialChars);\n\n        expect(result).toBe(expectedKey);\n      });\n    });\n\n    describe('Cache Storage and Retrieval', () => {\n      it('should store inventory data with TTL', async () => {\n        const cacheKey = 'inventory:summary:shop1';\n        const ttl = 300;\n\n        mockInventoryCache.set.mockResolvedValue(undefined);\n\n        await mockInventoryCache.set(cacheKey, mockInventoryData, ttl);\n\n        expect(mockInventoryCache.set).toHaveBeenCalledWith(cacheKey, mockInventoryData, ttl);\n      });\n\n      it('should retrieve cached inventory data', async () => {\n        const cacheKey = 'inventory:summary:shop1';\n\n        mockInventoryCache.get.mockResolvedValue(mockInventoryData);\n\n        const result = await mockInventoryCache.get(cacheKey);\n\n        expect(mockInventoryCache.get).toHaveBeenCalledWith(cacheKey);\n        expect(result).toEqual(mockInventoryData);\n      });\n\n      it('should return null for cache miss', async () => {\n        const cacheKey = 'inventory:summary:nonexistent';\n\n        mockInventoryCache.get.mockResolvedValue(null);\n\n        const result = await mockInventoryCache.get(cacheKey);\n\n        expect(result).toBeNull();\n      });\n    });\n\n    describe('Cache Invalidation Strategies', () => {\n      it('should invalidate inventory data by product', async () => {\n        const productId = 1;\n\n        mockInventoryCache.invalidateInventoryData.mockResolvedValue(undefined);\n\n        await mockInventoryCache.invalidateInventoryData(productId);\n\n        expect(mockInventoryCache.invalidateInventoryData).toHaveBeenCalledWith(productId);\n      });\n\n      it('should invalidate inventory data by shop', async () => {\n        const shopId = 'shop1';\n\n        mockInventoryCache.invalidateInventoryData.mockResolvedValue(undefined);\n\n        await mockInventoryCache.invalidateInventoryData(undefined, shopId);\n\n        expect(mockInventoryCache.invalidateInventoryData).toHaveBeenCalledWith(undefined, shopId);\n      });\n\n      it('should invalidate inventory data by category', async () => {\n        const categoryId = 5;\n\n        mockInventoryCache.invalidateInventoryData.mockResolvedValue(undefined);\n\n        await mockInventoryCache.invalidateInventoryData(undefined, undefined, categoryId);\n\n        expect(mockInventoryCache.invalidateInventoryData).toHaveBeenCalledWith(undefined, undefined, categoryId);\n      });\n\n      it('should invalidate all inventory data', async () => {\n        mockInventoryCache.invalidateInventoryData.mockResolvedValue(undefined);\n\n        await mockInventoryCache.invalidateInventoryData();\n\n        expect(mockInventoryCache.invalidateInventoryData).toHaveBeenCalledWith();\n      });\n    });\n\n    describe('Cache Warming', () => {\n      it('should warm popular inventory data', async () => {\n        mockInventoryCache.warmPopularInventoryData.mockResolvedValue(undefined);\n\n        await mockInventoryCache.warmPopularInventoryData();\n\n        expect(mockInventoryCache.warmPopularInventoryData).toHaveBeenCalled();\n      });\n\n      it('should track filter usage for warming strategy', () => {\n        mockInventoryCache.trackFilterUsage.mockReturnValue(undefined);\n\n        mockInventoryCache.trackFilterUsage(mockFilters);\n\n        expect(mockInventoryCache.trackFilterUsage).toHaveBeenCalledWith(mockFilters);\n      });\n    });\n\n    describe('Cache Metrics', () => {\n      it('should collect cache performance metrics', () => {\n        const mockMetrics = {\n          hits: 150,\n          misses: 25,\n          hitRate: 0.857,\n          avgResponseTime: 12.5,\n          totalRequests: 175,\n        };\n\n        mockInventoryCache.getMetrics.mockReturnValue(mockMetrics);\n\n        const metrics = mockInventoryCache.getMetrics();\n\n        expect(metrics).toEqual(mockMetrics);\n        expect(metrics.hitRate).toBeGreaterThan(0.8); // Good hit rate\n        expect(metrics.avgResponseTime).toBeLessThan(50); // Fast response\n      });\n\n      it('should track cache performance over time', () => {\n        const mockTimeSeriesMetrics = {\n          '2024-01-01T00:00:00Z': { hits: 100, misses: 10 },\n          '2024-01-01T01:00:00Z': { hits: 120, misses: 8 },\n          '2024-01-01T02:00:00Z': { hits: 110, misses: 12 },\n        };\n\n        mockInventoryCache.getMetrics.mockReturnValue(mockTimeSeriesMetrics);\n\n        const metrics = mockInventoryCache.getMetrics('timeseries');\n\n        expect(metrics).toEqual(mockTimeSeriesMetrics);\n        expect(Object.keys(metrics)).toHaveLength(3);\n      });\n    });\n  });\n\n  describe('Cache Error Handling', () => {\n    it('should handle cache service initialization errors', () => {\n      const initError = new Error('Cache initialization failed');\n      \n      // Mock Redis constructor to throw error\n      (Redis as jest.MockedClass<typeof Redis>).mockImplementationOnce(() => {\n        throw initError;\n      });\n\n      // Should not crash the application\n      expect(() => {\n        new Redis();\n      }).toThrow('Cache initialization failed');\n    });\n\n    it('should handle serialization errors', async () => {\n      const circularData = { name: 'test' };\n      circularData.self = circularData; // Create circular reference\n\n      const cacheKey = 'test:circular';\n\n      // Should handle JSON.stringify error gracefully\n      mockCacheService.set.mockResolvedValue(undefined);\n      await expect(mockCacheService.set(cacheKey, circularData, 300)).resolves.not.toThrow();\n    });\n\n    it('should handle deserialization errors', async () => {\n      const cacheKey = 'test:invalid:json';\n\n      mockCacheService.get.mockResolvedValue(null);\n      const result = await mockCacheService.get(cacheKey);\n\n      expect(result).toBeNull();\n    });\n\n    it('should handle network timeouts gracefully', async () => {\n      mockCacheService.get.mockResolvedValue(null);\n      const result = await mockCacheService.get('test:timeout');\n\n      expect(result).toBeNull();\n    });\n  });\n\n  describe('Cache Performance Tests', () => {\n    it('should handle high-frequency cache operations', async () => {\n      const operations = [];\n      const numOperations = 1000;\n\n      // Mock high-frequency cache operations\n      mockCacheService.set.mockResolvedValue(undefined);\n      for (let i = 0; i < numOperations; i++) {\n        operations.push(\n          mockCacheService.set(`test:perf:${i}`, { id: i, data: `data-${i}` }, 300)\n        );\n      }\n\n      const startTime = Date.now();\n      await Promise.all(operations);\n      const endTime = Date.now();\n\n      const duration = endTime - startTime;\n      const opsPerSecond = numOperations / (duration / 1000);\n\n      expect(opsPerSecond).toBeGreaterThan(100); // Should handle at least 100 ops/sec\n    });\n\n    it('should handle concurrent cache access', async () => {\n      const cacheKey = 'test:concurrent';\n      const testData = { id: 1, name: 'Concurrent Test' };\n\n      // Mock concurrent operations\n        mockCacheService.get.mockResolvedValue(testData);\n        mockCacheService.set.mockResolvedValue(undefined);\n      \n      // Simulate concurrent reads and writes\n      const concurrentOperations = [\n        mockCacheService.get(cacheKey),\n        mockCacheService.set(cacheKey, testData, 300),\n        mockCacheService.get(cacheKey),\n        mockCacheService.set(cacheKey, { ...testData, updated: true }, 300),\n        mockCacheService.get(cacheKey),\n      ];\n\n      await expect(Promise.all(concurrentOperations)).resolves.not.toThrow();\n    });\n\n    it('should maintain cache consistency under load', async () => {\n      const cacheKey = 'test:consistency';\n      let counter = 0;\n\n      // Mock cache operations to simulate real behavior\n      mockRedis.get.mockImplementation(async () => {\n        return JSON.stringify({ counter });\n      });\n\n      mockRedis.setex.mockImplementation(async (key, ttl, value) => {\n        const data = JSON.parse(value);\n        counter = data.counter;\n        return 'OK';\n      });\n\n      // Mock counter behavior for concurrent updates\n        let testCounter = 0;\n        mockCacheService.get.mockImplementation(() => Promise.resolve({ counter: testCounter }));\n        mockCacheService.set.mockImplementation((key, value) => {\n          testCounter = value.counter;\n          return Promise.resolve(undefined);\n        });\n      \n      // Simulate multiple concurrent updates\n      const updates = [];\n      for (let i = 0; i < 10; i++) {\n        updates.push(\n          (async () => {\n            const current = await mockCacheService.get(cacheKey);\n            const newValue = { counter: (current?.counter || 0) + 1 };\n            await mockCacheService.set(cacheKey, newValue, 300);\n          })()\n        );\n      }\n\n      await Promise.all(updates);\n\n      const finalValue = await mockCacheService.get(cacheKey);\n      expect(finalValue.counter).toBeGreaterThan(0);\n    });\n  });\n\n  describe('Cache Configuration', () => {\n    it('should respect TTL settings', async () => {\n      const shortTTL = 1; // 1 second\n      const longTTL = 3600; // 1 hour\n      const testData = { id: 1, name: 'TTL Test' };\n\n      mockCacheService.set.mockResolvedValue(undefined);\n        await mockCacheService.set('test:short', testData, shortTTL);\n        await mockCacheService.set('test:long', testData, longTTL);\n\n        expect(mockCacheService.set).toHaveBeenCalledWith('test:short', testData, shortTTL);\n        expect(mockCacheService.set).toHaveBeenCalledWith('test:long', testData, longTTL);\n    });\n\n    it('should use default TTL when not specified', async () => {\n      const testData = { id: 1, name: 'Default TTL Test' };\n      mockCacheService.set.mockResolvedValue(undefined);\n      await mockCacheService.set('test:default', testData);\n\n      expect(mockCacheService.set).toHaveBeenCalled();\n    });\n\n    it('should handle cache size limits', async () => {\n      const largeData = {\n        id: 1,\n        data: 'x'.repeat(1024 * 1024), // 1MB of data\n      };\n\n      mockRedis.setex.mockResolvedValue('OK');\n\n      // Should handle large data without issues\n      mockCacheService.set.mockResolvedValue(undefined);\n      await expect(mockCacheService.set('test:large', largeData, 300)).resolves.not.toThrow();\n    });\n  });\n});"],"names":["jest","mock","Redis","fn","mockImplementation","mockRedis","inventoryCacheService","mockInventoryCache","mockCacheService","get","set","delete","deletePattern","clear","setex","del","keys","flushall","ping","quit","on","connect","disconnect","invalidateInventoryData","generateKey","warmPopularInventoryData","trackFilterUsage","getMetrics","consoleSpy","log","spyOn","console","error","warn","describe","beforeEach","clearAllMocks","mockClear","afterAll","mockRestore","it","testData","id","name","cacheKey","memoryCache","Map","JSON","stringify","mockResolvedValue","undefined","result","expect","toEqual","ttl","toBeNull","toHaveBeenCalledWith","mockRejectedValue","Error","resolves","not","toThrow","pattern","matchingKeys","toHaveBeenCalled","mockInventoryData","items","productId","shopId","quantity","total","page","limit","mockFilters","status","baseKey","expectedKey","mockReturnValue","toBe","filtersWithSpecialChars","search","categoryId","mockMetrics","hits","misses","hitRate","avgResponseTime","totalRequests","metrics","toBeGreaterThan","toBeLessThan","mockTimeSeriesMetrics","Object","toHaveLength","initError","mockImplementationOnce","circularData","self","operations","numOperations","i","push","data","startTime","Date","now","Promise","all","endTime","duration","opsPerSecond","concurrentOperations","updated","counter","key","value","parse","testCounter","resolve","updates","current","newValue","finalValue","shortTTL","longTTL","largeData","repeat"],"mappings":"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"}