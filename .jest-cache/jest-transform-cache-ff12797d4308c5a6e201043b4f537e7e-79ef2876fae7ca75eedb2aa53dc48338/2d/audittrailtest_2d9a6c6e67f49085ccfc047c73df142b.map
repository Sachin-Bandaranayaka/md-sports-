{"version":3,"sources":["/Users/sachin/Documents/md-sports-/src/__tests__/api/audit-trail.test.ts"],"sourcesContent":["import { describe, it, expect, beforeEach, afterEach, vi, Mock } from 'vitest';\nimport { NextRequest } from 'next/server';\nimport { GET } from '@/app/api/audit-trail/route';\nimport { verifyToken } from '@/lib/auth';\nimport { auditService } from '@/services/auditService';\n\n// Mock dependencies\nvi.mock('@/lib/auth');\nvi.mock('@/services/auditService');\n\nconst mockVerifyToken = verifyToken as Mock;\nconst mockAuditService = auditService as any;\n\ndescribe('/api/audit-trail', () => {\n  const mockToken = 'valid-jwt-token';\n  const mockDecodedToken = { sub: 'user123', email: 'test@example.com' };\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n    mockVerifyToken.mockResolvedValue(mockDecodedToken);\n  });\n\n  afterEach(() => {\n    vi.resetAllMocks();\n  });\n\n  describe('Authentication', () => {\n    it('should return 401 when no authorization header is provided', async () => {\n      const request = new NextRequest('http://localhost:3000/api/audit-trail');\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('No token provided');\n    });\n\n    it('should return 401 when token verification fails', async () => {\n      mockVerifyToken.mockResolvedValue(null);\n      \n      const request = new NextRequest('http://localhost:3000/api/audit-trail', {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('Invalid token');\n    });\n  });\n\n  describe('Recycle Bin Items (type=deleted)', () => {\n    const mockRecycleBinData = {\n      items: [\n        {\n          id: 1,\n          entity: 'product',\n          entityId: 123,\n          originalData: { name: 'Test Product' },\n          deletedAt: new Date('2024-01-15T10:00:00Z'),\n          deletedBy: 'user1',\n          canRecover: true,\n        },\n      ],\n      total: 1,\n    };\n\n    beforeEach(() => {\n      mockAuditService.getRecycleBinItems.mockResolvedValue(mockRecycleBinData);\n    });\n\n    it('should fetch recycle bin items without filters', async () => {\n      const url = 'http://localhost:3000/api/audit-trail?type=deleted&limit=20&offset=0';\n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual(mockRecycleBinData);\n      expect(mockAuditService.getRecycleBinItems).toHaveBeenCalledWith(\n        undefined,\n        20,\n        0,\n        null,\n        null\n      );\n    });\n\n    it('should fetch recycle bin items with entity filter', async () => {\n      const url = 'http://localhost:3000/api/audit-trail?type=deleted&entity=product&limit=20&offset=0';\n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual(mockRecycleBinData);\n      expect(mockAuditService.getRecycleBinItems).toHaveBeenCalledWith(\n        'product',\n        20,\n        0,\n        null,\n        null\n      );\n    });\n\n    it('should fetch recycle bin items with date filters', async () => {\n      const dateFrom = '2024-01-15T00:00:00Z';\n      const dateTo = '2024-01-15T23:59:59Z';\n      const url = `http://localhost:3000/api/audit-trail?type=deleted&dateFrom=${encodeURIComponent(dateFrom)}&dateTo=${encodeURIComponent(dateTo)}&limit=20&offset=0`;\n      \n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual(mockRecycleBinData);\n      expect(mockAuditService.getRecycleBinItems).toHaveBeenCalledWith(\n        undefined,\n        20,\n        0,\n        dateFrom,\n        dateTo\n      );\n    });\n\n    it('should fetch recycle bin items with entity and date filters combined', async () => {\n      const dateFrom = '2024-01-15T00:00:00Z';\n      const dateTo = '2024-01-16T23:59:59Z';\n      const url = `http://localhost:3000/api/audit-trail?type=deleted&entity=customer&dateFrom=${encodeURIComponent(dateFrom)}&dateTo=${encodeURIComponent(dateTo)}&limit=10&offset=5`;\n      \n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual(mockRecycleBinData);\n      expect(mockAuditService.getRecycleBinItems).toHaveBeenCalledWith(\n        'customer',\n        10,\n        5,\n        dateFrom,\n        dateTo\n      );\n    });\n  });\n\n  describe('Audit Entries (type=all)', () => {\n    const mockAuditData = {\n      items: [\n        {\n          id: 1,\n          entity: 'product',\n          entityId: 123,\n          action: 'CREATE',\n          userId: 'user1',\n          createdAt: new Date('2024-01-15T10:00:00Z'),\n          details: { name: 'Test Product' },\n        },\n      ],\n      total: 1,\n    };\n\n    beforeEach(() => {\n      mockAuditService.getAuditEntries.mockResolvedValue(mockAuditData);\n    });\n\n    it('should fetch audit entries without filters', async () => {\n      const url = 'http://localhost:3000/api/audit-trail?type=all&limit=20&offset=0';\n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual(mockAuditData);\n      expect(mockAuditService.getAuditEntries).toHaveBeenCalledWith(\n        undefined,\n        20,\n        0,\n        null,\n        null\n      );\n    });\n\n    it('should fetch audit entries with entity filter', async () => {\n      const url = 'http://localhost:3000/api/audit-trail?type=all&entity=invoice&limit=20&offset=0';\n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual(mockAuditData);\n      expect(mockAuditService.getAuditEntries).toHaveBeenCalledWith(\n        'invoice',\n        20,\n        0,\n        null,\n        null\n      );\n    });\n\n    it('should fetch audit entries with date filters', async () => {\n      const dateFrom = '2024-01-15T00:00:00Z';\n      const dateTo = '2024-01-15T23:59:59Z';\n      const url = `http://localhost:3000/api/audit-trail?type=all&dateFrom=${encodeURIComponent(dateFrom)}&dateTo=${encodeURIComponent(dateTo)}&limit=20&offset=0`;\n      \n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual(mockAuditData);\n      expect(mockAuditService.getAuditEntries).toHaveBeenCalledWith(\n        undefined,\n        20,\n        0,\n        dateFrom,\n        dateTo\n      );\n    });\n  });\n\n  describe('Entity History (type=history)', () => {\n    const mockHistoryData = [\n      {\n        id: 1,\n        entity: 'product',\n        entityId: 123,\n        action: 'CREATE',\n        userId: 'user1',\n        createdAt: new Date('2024-01-15T10:00:00Z'),\n        details: { name: 'Test Product' },\n      },\n      {\n        id: 2,\n        entity: 'product',\n        entityId: 123,\n        action: 'UPDATE',\n        userId: 'user2',\n        createdAt: new Date('2024-01-16T11:00:00Z'),\n        details: { name: 'Updated Product' },\n      },\n    ];\n\n    beforeEach(() => {\n      mockAuditService.getEntityHistory.mockResolvedValue(mockHistoryData);\n    });\n\n    it('should fetch entity history without date filters', async () => {\n      const url = 'http://localhost:3000/api/audit-trail?type=history&entity=product&entityId=123&limit=20';\n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual({ items: mockHistoryData, total: mockHistoryData.length });\n      expect(mockAuditService.getEntityHistory).toHaveBeenCalledWith(\n        'product',\n        123,\n        20,\n        null,\n        null\n      );\n    });\n\n    it('should fetch entity history with date filters', async () => {\n      const dateFrom = '2024-01-15T00:00:00Z';\n      const dateTo = '2024-01-16T23:59:59Z';\n      const url = `http://localhost:3000/api/audit-trail?type=history&entity=product&entityId=123&dateFrom=${encodeURIComponent(dateFrom)}&dateTo=${encodeURIComponent(dateTo)}&limit=10`;\n      \n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data).toEqual({ items: mockHistoryData, total: mockHistoryData.length });\n      expect(mockAuditService.getEntityHistory).toHaveBeenCalledWith(\n        'product',\n        123,\n        10,\n        dateFrom,\n        dateTo\n      );\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle service errors gracefully', async () => {\n      mockAuditService.getRecycleBinItems.mockRejectedValue(new Error('Database error'));\n      \n      const url = 'http://localhost:3000/api/audit-trail?type=deleted';\n      const request = new NextRequest(url, {\n        headers: { Authorization: `Bearer ${mockToken}` },\n      });\n      \n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.error).toBe('Failed to fetch audit trail');\n    });\n  });\n});"],"names":["vi","mock","mockVerifyToken","verifyToken","mockAuditService","auditService","describe","mockToken","mockDecodedToken","sub","email","beforeEach","clearAllMocks","mockResolvedValue","afterEach","resetAllMocks","it","request","NextRequest","response","GET","data","json","expect","status","toBe","error","headers","Authorization","mockRecycleBinData","items","id","entity","entityId","originalData","name","deletedAt","Date","deletedBy","canRecover","total","getRecycleBinItems","url","toEqual","toHaveBeenCalledWith","undefined","dateFrom","dateTo","encodeURIComponent","mockAuditData","action","userId","createdAt","details","getAuditEntries","mockHistoryData","getEntityHistory","length","mockRejectedValue","Error"],"mappings":"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"}