3c446ecf123c8084e8823245ce81e471
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _axios = /*#__PURE__*/ _interop_require_default(require("axios"));
const _chatbotService = require("../../src/services/chatbotService");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock axios
_globals.jest.mock("axios");
const mockAxios = {
    get: _globals.jest.fn(),
    post: _globals.jest.fn()
};
_axios.default.get = mockAxios.get;
_axios.default.post = mockAxios.post;
// Mock document.cookie for getCookie function
Object.defineProperty(global, "document", {
    value: {
        cookie: "",
        addEventListener: _globals.jest.fn(),
        removeEventListener: _globals.jest.fn()
    },
    writable: true
});
(0, _globals.describe)("ChatbotService", ()=>{
    (0, _globals.beforeEach)(()=>{
        _globals.jest.clearAllMocks();
        // Reset document.cookie
        global.document.cookie = "";
    });
    (0, _globals.afterEach)(()=>{
        _globals.jest.resetAllMocks();
    });
    (0, _globals.describe)("sendMessage", ()=>{
        const mockMessages = [
            {
                role: "user",
                content: "Hello, how can I help?"
            },
            {
                role: "assistant",
                content: "I can help you with your sports equipment needs."
            }
        ];
        const mockResponse = {
            role: "assistant",
            content: "Thank you for your message. How can I assist you today?"
        };
        (0, _globals.it)("should send message successfully when API key is configured", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: mockResponse
            });
            const result = await _chatbotService.chatbotService.sendMessage(mockMessages);
            (0, _globals.expect)(result).toEqual(mockResponse);
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings");
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: mockMessages
            }, {
                headers: {
                    "Content-Type": "application/json"
                }
            });
        });
        (0, _globals.it)("should include CSRF token when available", async ()=>{
            // Set CSRF token in cookie
            global.document.cookie = "csrfToken=test-csrf-token; other=value";
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: mockResponse
            });
            await _chatbotService.chatbotService.sendMessage(mockMessages);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: mockMessages
            }, {
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRF-Token": "test-csrf-token"
                }
            });
        });
        (0, _globals.it)("should throw error when API key is not configured", async ()=>{
            // Mock API key check failure
            mockAxios.get.mockResolvedValue({
                data: {
                    success: false,
                    isEmpty: true,
                    valueLength: 0
                }
            });
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Deepseek API key is not configured. Please set it in the AI Assistant settings page.");
            (0, _globals.expect)(mockAxios.post).not.toHaveBeenCalled();
        });
        (0, _globals.it)("should throw error when API key is empty", async ()=>{
            // Mock API key check with empty key
            mockAxios.get.mockResolvedValueOnce({
                data: {
                    success: true,
                    isEmpty: true,
                    valueLength: 0
                }
            });
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Deepseek API key is not configured. Please set it in the AI Assistant settings page.");
        });
        (0, _globals.it)("should handle API key check errors", async ()=>{
            // Mock API key check error
            const configError = new Error("Configuration check failed");
            mockAxios.get.mockRejectedValueOnce(configError);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Configuration check failed");
        });
        (0, _globals.it)("should handle axios error with response data", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock axios error with response
            const axiosError = {
                isAxiosError: true,
                response: {
                    status: 400,
                    data: {
                        error: "Invalid request format"
                    }
                },
                toJSON: ()=>({
                        message: "Request failed"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Invalid request format");
        });
        (0, _globals.it)("should handle 403 forbidden error", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock 403 error
            const axiosError = {
                isAxiosError: true,
                response: {
                    status: 403,
                    data: {}
                },
                toJSON: ()=>({
                        message: "Forbidden"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Access to the chatbot service was denied (403). Please check API key and configuration in AI Assistant settings, or a CSRF token issue might exist.");
        });
        (0, _globals.it)("should handle network errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock network error (no response)
            const axiosError = {
                isAxiosError: true,
                request: {},
                response: undefined,
                toJSON: ()=>({
                        message: "Network Error"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("No response received from the chatbot service. Please check your network connection and server status.");
        });
        (0, _globals.it)("should handle request setup errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock request setup error
            const axiosError = {
                isAxiosError: true,
                message: "Request setup failed",
                request: undefined,
                response: undefined,
                toJSON: ()=>({
                        message: "Request setup failed"
                    })
            };
            mockAxios.post.mockRejectedValueOnce(axiosError);
            mockAxios.isAxiosError.mockReturnValue(true);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Error setting up chatbot request: Request setup failed");
        });
        (0, _globals.it)("should handle non-axios errors", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock non-axios error
            const genericError = new Error("Generic error");
            mockAxios.post.mockRejectedValueOnce(genericError);
            mockAxios.isAxiosError.mockReturnValue(false);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Generic error");
        });
        (0, _globals.it)("should handle errors without message", async ()=>{
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock error without message
            const errorWithoutMessage = {};
            mockAxios.post.mockRejectedValueOnce(errorWithoutMessage);
            mockAxios.isAxiosError.mockReturnValue(false);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("An unexpected error occurred with the chatbot service.");
        });
        (0, _globals.it)("should handle API key check axios error with response data", async ()=>{
            // Mock API key check axios error
            const configAxiosError = {
                isAxiosError: true,
                response: {
                    data: {
                        message: "Settings API error"
                    }
                }
            };
            mockAxios.get.mockRejectedValueOnce(configAxiosError);
            await (0, _globals.expect)(_chatbotService.chatbotService.sendMessage(mockMessages)).rejects.toThrow("Settings API error");
        });
    });
    (0, _globals.describe)("getBusinessInfo", ()=>{
        (0, _globals.it)("should return business information", async ()=>{
            const businessInfo = await _chatbotService.chatbotService.getBusinessInfo();
            (0, _globals.expect)(businessInfo).toEqual({
                businessName: "MS Sports",
                inventoryCount: "Over 1,000 items",
                topSellingProducts: [
                    "Sports Shoes",
                    "Jerseys",
                    "Training Equipment"
                ],
                customerCount: "Over 500 registered customers",
                supplierCount: "50+ active suppliers"
            });
        });
        (0, _globals.it)("should return consistent data structure", async ()=>{
            const businessInfo = await _chatbotService.chatbotService.getBusinessInfo();
            (0, _globals.expect)(businessInfo).toHaveProperty("businessName");
            (0, _globals.expect)(businessInfo).toHaveProperty("inventoryCount");
            (0, _globals.expect)(businessInfo).toHaveProperty("topSellingProducts");
            (0, _globals.expect)(businessInfo).toHaveProperty("customerCount");
            (0, _globals.expect)(businessInfo).toHaveProperty("supplierCount");
            (0, _globals.expect)(Array.isArray(businessInfo.topSellingProducts)).toBe(true);
        });
    });
    (0, _globals.describe)("checkConfiguration", ()=>{
        (0, _globals.it)("should return configured when API key exists and is not empty", async ()=>{
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: false
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: true
            });
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings", {
                headers: {}
            });
        });
        (0, _globals.it)("should include CSRF token in configuration check", async ()=>{
            // Set CSRF token in cookie
            global.document.cookie = "csrfToken=config-csrf-token; other=value";
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: false
                }
            });
            await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(mockAxios.get).toHaveBeenCalledWith("/api/test-settings", {
                headers: {
                    "X-CSRF-Token": "config-csrf-token"
                }
            });
        });
        (0, _globals.it)("should return not configured when setting not found", async ()=>{
            mockAxios.get.mockResolvedValue({
                data: {
                    success: false,
                    exists: false
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "API key setting not found in database"
            });
        });
        (0, _globals.it)("should return not configured when API key is empty", async ()=>{
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    exists: true,
                    isEmpty: true
                }
            });
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "API key is empty. Please configure it in settings."
            });
        });
        (0, _globals.it)("should handle configuration check errors", async ()=>{
            const error = new Error("Network error");
            mockAxios.get.mockRejectedValueOnce(error);
            const consoleSpy = _globals.jest.spyOn(console, "error").mockImplementation();
            const result = await _chatbotService.chatbotService.checkConfiguration();
            (0, _globals.expect)(result).toEqual({
                isConfigured: false,
                message: "Failed to check configuration. Please try again."
            });
            (0, _globals.expect)(consoleSpy).toHaveBeenCalledWith("Error checking chatbot configuration:", error);
            consoleSpy.mockRestore();
        });
    });
    (0, _globals.describe)("getCookie function (via sendMessage)", ()=>{
        (0, _globals.it)("should extract CSRF token from cookie string", async ()=>{
            // Set multiple cookies including CSRF token
            global.document.cookie = "sessionId=abc123; csrfToken=test-token; userId=456";
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: {
                    role: "assistant",
                    content: "Response"
                }
            });
            await _chatbotService.chatbotService.sendMessage([
                {
                    role: "user",
                    content: "test"
                }
            ]);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: [
                    {
                        role: "user",
                        content: "test"
                    }
                ]
            }, {
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRF-Token": "test-token"
                }
            });
        });
        (0, _globals.it)("should handle missing CSRF token gracefully", async ()=>{
            // Set cookies without CSRF token
            global.document.cookie = "sessionId=abc123; userId=456";
            // Mock successful API key check
            mockAxios.get.mockResolvedValue({
                data: {
                    success: true,
                    isEmpty: false,
                    valueLength: 32
                }
            });
            // Mock successful chatbot response
            mockAxios.post.mockResolvedValue({
                data: {
                    role: "assistant",
                    content: "Response"
                }
            });
            await _chatbotService.chatbotService.sendMessage([
                {
                    role: "user",
                    content: "test"
                }
            ]);
            (0, _globals.expect)(mockAxios.post).toHaveBeenCalledWith("/api/chatbot", {
                messages: [
                    {
                        role: "user",
                        content: "test"
                    }
                ]
            }, {
                headers: {
                    "Content-Type": "application/json"
                }
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vRG9jdW1lbnRzL21kLXNwb3J0cy0vdGVzdHMvdW5pdC9jaGF0Ym90U2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBhZnRlckVhY2gsIGplc3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCBheGlvcywgeyBBeGlvc0Vycm9yIH0gZnJvbSAnYXhpb3MnO1xuaW1wb3J0IHsgY2hhdGJvdFNlcnZpY2UsIENoYXRNZXNzYWdlLCBDaGF0UmVzcG9uc2UgfSBmcm9tICdAL3NlcnZpY2VzL2NoYXRib3RTZXJ2aWNlJztcblxuLy8gTW9jayBheGlvc1xuamVzdC5tb2NrKCdheGlvcycpO1xuY29uc3QgbW9ja0F4aW9zID0ge1xuICBnZXQ6IGplc3QuZm4oKSxcbiAgcG9zdDogamVzdC5mbigpLFxufTtcbihheGlvcyBhcyBhbnkpLmdldCA9IG1vY2tBeGlvcy5nZXQ7XG4oYXhpb3MgYXMgYW55KS5wb3N0ID0gbW9ja0F4aW9zLnBvc3Q7XG5cbi8vIE1vY2sgZG9jdW1lbnQuY29va2llIGZvciBnZXRDb29raWUgZnVuY3Rpb25cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsICdkb2N1bWVudCcsIHtcbiAgdmFsdWU6IHtcbiAgICBjb29raWU6ICcnLFxuICAgIGFkZEV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcbiAgICByZW1vdmVFdmVudExpc3RlbmVyOiBqZXN0LmZuKCksXG4gIH0sXG4gIHdyaXRhYmxlOiB0cnVlLFxufSk7XG5cbmRlc2NyaWJlKCdDaGF0Ym90U2VydmljZScsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgLy8gUmVzZXQgZG9jdW1lbnQuY29va2llXG4gICAgKGdsb2JhbC5kb2N1bWVudCBhcyBhbnkpLmNvb2tpZSA9ICcnO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QucmVzZXRBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnc2VuZE1lc3NhZ2UnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja01lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdID0gW1xuICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICdIZWxsbywgaG93IGNhbiBJIGhlbHA/JyB9LFxuICAgICAgeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudDogJ0kgY2FuIGhlbHAgeW91IHdpdGggeW91ciBzcG9ydHMgZXF1aXBtZW50IG5lZWRzLicgfVxuICAgIF07XG5cbiAgICBjb25zdCBtb2NrUmVzcG9uc2U6IENoYXRSZXNwb25zZSA9IHtcbiAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgY29udGVudDogJ1RoYW5rIHlvdSBmb3IgeW91ciBtZXNzYWdlLiBIb3cgY2FuIEkgYXNzaXN0IHlvdSB0b2RheT8nXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgc2VuZCBtZXNzYWdlIHN1Y2Nlc3NmdWxseSB3aGVuIEFQSSBrZXkgaXMgY29uZmlndXJlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgY2hhdGJvdCByZXNwb25zZVxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBtb2NrUmVzcG9uc2VcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tSZXNwb25zZSk7XG4gICAgICBleHBlY3QobW9ja0F4aW9zLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hcGkvdGVzdC1zZXR0aW5ncycpO1xuICAgICAgZXhwZWN0KG1vY2tBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJy9hcGkvY2hhdGJvdCcsXG4gICAgICAgIHsgbWVzc2FnZXM6IG1vY2tNZXNzYWdlcyB9LFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgQ1NSRiB0b2tlbiB3aGVuIGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNldCBDU1JGIHRva2VuIGluIGNvb2tpZVxuICAgICAgKGdsb2JhbC5kb2N1bWVudCBhcyBhbnkpLmNvb2tpZSA9ICdjc3JmVG9rZW49dGVzdC1jc3JmLXRva2VuOyBvdGhlcj12YWx1ZSc7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgY2hhdGJvdCByZXNwb25zZVxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBtb2NrUmVzcG9uc2VcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpO1xuXG4gICAgICBleHBlY3QobW9ja0F4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnL2FwaS9jaGF0Ym90JyxcbiAgICAgICAgeyBtZXNzYWdlczogbW9ja01lc3NhZ2VzIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ1gtQ1NSRi1Ub2tlbic6ICd0ZXN0LWNzcmYtdG9rZW4nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIEFQSSBrZXkgaXMgbm90IGNvbmZpZ3VyZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIEFQSSBrZXkgY2hlY2sgZmFpbHVyZVxuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBpc0VtcHR5OiB0cnVlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAwXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0RlZXBzZWVrIEFQSSBrZXkgaXMgbm90IGNvbmZpZ3VyZWQuIFBsZWFzZSBzZXQgaXQgaW4gdGhlIEFJIEFzc2lzdGFudCBzZXR0aW5ncyBwYWdlLicpO1xuXG4gICAgICBleHBlY3QobW9ja0F4aW9zLnBvc3QpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gQVBJIGtleSBpcyBlbXB0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgQVBJIGtleSBjaGVjayB3aXRoIGVtcHR5IGtleVxuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiB0cnVlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAwXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0RlZXBzZWVrIEFQSSBrZXkgaXMgbm90IGNvbmZpZ3VyZWQuIFBsZWFzZSBzZXQgaXQgaW4gdGhlIEFJIEFzc2lzdGFudCBzZXR0aW5ncyBwYWdlLicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQVBJIGtleSBjaGVjayBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIEFQSSBrZXkgY2hlY2sgZXJyb3JcbiAgICAgIGNvbnN0IGNvbmZpZ0Vycm9yID0gbmV3IEVycm9yKCdDb25maWd1cmF0aW9uIGNoZWNrIGZhaWxlZCcpO1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UoY29uZmlnRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0NvbmZpZ3VyYXRpb24gY2hlY2sgZmFpbGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBheGlvcyBlcnJvciB3aXRoIHJlc3BvbnNlIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayBheGlvcyBlcnJvciB3aXRoIHJlc3BvbnNlXG4gICAgICBjb25zdCBheGlvc0Vycm9yID0ge1xuICAgICAgICBpc0F4aW9zRXJyb3I6IHRydWUsXG4gICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJlcXVlc3QgZm9ybWF0J1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdG9KU09OOiAoKSA9PiAoeyBtZXNzYWdlOiAnUmVxdWVzdCBmYWlsZWQnIH0pXG4gICAgICB9IGFzIEF4aW9zRXJyb3I7XG5cbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShheGlvc0Vycm9yKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKHRydWUpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0ludmFsaWQgcmVxdWVzdCBmb3JtYXQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIDQwMyBmb3JiaWRkZW4gZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayA0MDMgZXJyb3JcbiAgICAgIGNvbnN0IGF4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICBzdGF0dXM6IDQwMyxcbiAgICAgICAgICBkYXRhOiB7fVxuICAgICAgICB9LFxuICAgICAgICB0b0pTT046ICgpID0+ICh7IG1lc3NhZ2U6ICdGb3JiaWRkZW4nIH0pXG4gICAgICB9IGFzIEF4aW9zRXJyb3I7XG5cbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShheGlvc0Vycm9yKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKHRydWUpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0FjY2VzcyB0byB0aGUgY2hhdGJvdCBzZXJ2aWNlIHdhcyBkZW5pZWQgKDQwMykuIFBsZWFzZSBjaGVjayBBUEkga2V5IGFuZCBjb25maWd1cmF0aW9uIGluIEFJIEFzc2lzdGFudCBzZXR0aW5ncywgb3IgYSBDU1JGIHRva2VuIGlzc3VlIG1pZ2h0IGV4aXN0LicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayBuZXR3b3JrIGVycm9yIChubyByZXNwb25zZSlcbiAgICAgIGNvbnN0IGF4aW9zRXJyb3IgPSB7XG4gICAgICAgIGlzQXhpb3NFcnJvcjogdHJ1ZSxcbiAgICAgICAgcmVxdWVzdDoge30sXG4gICAgICAgIHJlc3BvbnNlOiB1bmRlZmluZWQsXG4gICAgICAgIHRvSlNPTjogKCkgPT4gKHsgbWVzc2FnZTogJ05ldHdvcmsgRXJyb3InIH0pXG4gICAgICB9IGFzIEF4aW9zRXJyb3I7XG5cbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShheGlvc0Vycm9yKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKHRydWUpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ05vIHJlc3BvbnNlIHJlY2VpdmVkIGZyb20gdGhlIGNoYXRib3Qgc2VydmljZS4gUGxlYXNlIGNoZWNrIHlvdXIgbmV0d29yayBjb25uZWN0aW9uIGFuZCBzZXJ2ZXIgc3RhdHVzLicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcmVxdWVzdCBzZXR1cCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIGtleSBjaGVja1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IGZhbHNlLFxuICAgICAgICAgIHZhbHVlTGVuZ3RoOiAzMlxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayByZXF1ZXN0IHNldHVwIGVycm9yXG4gICAgICBjb25zdCBheGlvc0Vycm9yID0ge1xuICAgICAgICBpc0F4aW9zRXJyb3I6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdSZXF1ZXN0IHNldHVwIGZhaWxlZCcsXG4gICAgICAgIHJlcXVlc3Q6IHVuZGVmaW5lZCxcbiAgICAgICAgcmVzcG9uc2U6IHVuZGVmaW5lZCxcbiAgICAgICAgdG9KU09OOiAoKSA9PiAoeyBtZXNzYWdlOiAnUmVxdWVzdCBzZXR1cCBmYWlsZWQnIH0pXG4gICAgICB9IGFzIEF4aW9zRXJyb3I7XG5cbiAgICAgIG1vY2tBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShheGlvc0Vycm9yKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKHRydWUpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ0Vycm9yIHNldHRpbmcgdXAgY2hhdGJvdCByZXF1ZXN0OiBSZXF1ZXN0IHNldHVwIGZhaWxlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbm9uLWF4aW9zIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIG5vbi1heGlvcyBlcnJvclxuICAgICAgY29uc3QgZ2VuZXJpY0Vycm9yID0gbmV3IEVycm9yKCdHZW5lcmljIGVycm9yJyk7XG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UoZ2VuZXJpY0Vycm9yKTtcbiAgICAgIG1vY2tBeGlvcy5pc0F4aW9zRXJyb3IubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKG1vY2tNZXNzYWdlcykpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCdHZW5lcmljIGVycm9yJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgd2l0aG91dCBtZXNzYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgZXJyb3Igd2l0aG91dCBtZXNzYWdlXG4gICAgICBjb25zdCBlcnJvcldpdGhvdXRNZXNzYWdlID0ge307XG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UoZXJyb3JXaXRob3V0TWVzc2FnZSk7XG4gICAgICBtb2NrQXhpb3MuaXNBeGlvc0Vycm9yLm1vY2tSZXR1cm5WYWx1ZShmYWxzZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShtb2NrTWVzc2FnZXMpKVxuICAgICAgICAucmVqZWN0c1xuICAgICAgICAudG9UaHJvdygnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCB3aXRoIHRoZSBjaGF0Ym90IHNlcnZpY2UuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBBUEkga2V5IGNoZWNrIGF4aW9zIGVycm9yIHdpdGggcmVzcG9uc2UgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgQVBJIGtleSBjaGVjayBheGlvcyBlcnJvclxuICAgICAgY29uc3QgY29uZmlnQXhpb3NFcnJvciA9IHtcbiAgICAgICAgaXNBeGlvc0Vycm9yOiB0cnVlLFxuICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdTZXR0aW5ncyBBUEkgZXJyb3InXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGFzIEF4aW9zRXJyb3I7XG5cbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1JlamVjdGVkVmFsdWVPbmNlKGNvbmZpZ0F4aW9zRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY2hhdGJvdFNlcnZpY2Uuc2VuZE1lc3NhZ2UobW9ja01lc3NhZ2VzKSlcbiAgICAgICAgLnJlamVjdHNcbiAgICAgICAgLnRvVGhyb3coJ1NldHRpbmdzIEFQSSBlcnJvcicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0QnVzaW5lc3NJbmZvJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGJ1c2luZXNzIGluZm9ybWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYnVzaW5lc3NJbmZvID0gYXdhaXQgY2hhdGJvdFNlcnZpY2UuZ2V0QnVzaW5lc3NJbmZvKCk7XG5cbiAgICAgIGV4cGVjdChidXNpbmVzc0luZm8pLnRvRXF1YWwoe1xuICAgICAgICBidXNpbmVzc05hbWU6ICdNUyBTcG9ydHMnLFxuICAgICAgICBpbnZlbnRvcnlDb3VudDogJ092ZXIgMSwwMDAgaXRlbXMnLFxuICAgICAgICB0b3BTZWxsaW5nUHJvZHVjdHM6IFsnU3BvcnRzIFNob2VzJywgJ0plcnNleXMnLCAnVHJhaW5pbmcgRXF1aXBtZW50J10sXG4gICAgICAgIGN1c3RvbWVyQ291bnQ6ICdPdmVyIDUwMCByZWdpc3RlcmVkIGN1c3RvbWVycycsXG4gICAgICAgIHN1cHBsaWVyQ291bnQ6ICc1MCsgYWN0aXZlIHN1cHBsaWVycycsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbnNpc3RlbnQgZGF0YSBzdHJ1Y3R1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBidXNpbmVzc0luZm8gPSBhd2FpdCBjaGF0Ym90U2VydmljZS5nZXRCdXNpbmVzc0luZm8oKTtcblxuICAgICAgZXhwZWN0KGJ1c2luZXNzSW5mbykudG9IYXZlUHJvcGVydHkoJ2J1c2luZXNzTmFtZScpO1xuICAgICAgZXhwZWN0KGJ1c2luZXNzSW5mbykudG9IYXZlUHJvcGVydHkoJ2ludmVudG9yeUNvdW50Jyk7XG4gICAgICBleHBlY3QoYnVzaW5lc3NJbmZvKS50b0hhdmVQcm9wZXJ0eSgndG9wU2VsbGluZ1Byb2R1Y3RzJyk7XG4gICAgICBleHBlY3QoYnVzaW5lc3NJbmZvKS50b0hhdmVQcm9wZXJ0eSgnY3VzdG9tZXJDb3VudCcpO1xuICAgICAgZXhwZWN0KGJ1c2luZXNzSW5mbykudG9IYXZlUHJvcGVydHkoJ3N1cHBsaWVyQ291bnQnKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGJ1c2luZXNzSW5mby50b3BTZWxsaW5nUHJvZHVjdHMpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY2hlY2tDb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbmZpZ3VyZWQgd2hlbiBBUEkga2V5IGV4aXN0cyBhbmQgaXMgbm90IGVtcHR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGV4aXN0czogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hhdGJvdFNlcnZpY2UuY2hlY2tDb25maWd1cmF0aW9uKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyBpc0NvbmZpZ3VyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QobW9ja0F4aW9zLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hcGkvdGVzdC1zZXR0aW5ncycsIHtcbiAgICAgICAgaGVhZGVyczoge31cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIENTUkYgdG9rZW4gaW4gY29uZmlndXJhdGlvbiBjaGVjaycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNldCBDU1JGIHRva2VuIGluIGNvb2tpZVxuICAgICAgKGdsb2JhbC5kb2N1bWVudCBhcyBhbnkpLmNvb2tpZSA9ICdjc3JmVG9rZW49Y29uZmlnLWNzcmYtdG9rZW47IG90aGVyPXZhbHVlJztcblxuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGV4aXN0czogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgY2hhdGJvdFNlcnZpY2UuY2hlY2tDb25maWd1cmF0aW9uKCk7XG5cbiAgICAgIGV4cGVjdChtb2NrQXhpb3MuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS90ZXN0LXNldHRpbmdzJywge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ1gtQ1NSRi1Ub2tlbic6ICdjb25maWctY3NyZi10b2tlbidcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBub3QgY29uZmlndXJlZCB3aGVuIHNldHRpbmcgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0F4aW9zLmdldC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBleGlzdHM6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGF0Ym90U2VydmljZS5jaGVja0NvbmZpZ3VyYXRpb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIGlzQ29uZmlndXJlZDogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdBUEkga2V5IHNldHRpbmcgbm90IGZvdW5kIGluIGRhdGFiYXNlJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBub3QgY29uZmlndXJlZCB3aGVuIEFQSSBrZXkgaXMgZW1wdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZXhpc3RzOiB0cnVlLFxuICAgICAgICAgIGlzRW1wdHk6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoYXRib3RTZXJ2aWNlLmNoZWNrQ29uZmlndXJhdGlvbigpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgaXNDb25maWd1cmVkOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogJ0FQSSBrZXkgaXMgZW1wdHkuIFBsZWFzZSBjb25maWd1cmUgaXQgaW4gc2V0dGluZ3MuJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25maWd1cmF0aW9uIGNoZWNrIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJyk7XG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZWplY3RlZFZhbHVlT25jZShlcnJvcik7XG4gICAgICBjb25zdCBjb25zb2xlU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hhdGJvdFNlcnZpY2UuY2hlY2tDb25maWd1cmF0aW9uKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBpc0NvbmZpZ3VyZWQ6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIGNoZWNrIGNvbmZpZ3VyYXRpb24uIFBsZWFzZSB0cnkgYWdhaW4uJ1xuICAgICAgfSk7XG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0Vycm9yIGNoZWNraW5nIGNoYXRib3QgY29uZmlndXJhdGlvbjonLCBlcnJvcik7XG5cbiAgICAgIGNvbnNvbGVTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldENvb2tpZSBmdW5jdGlvbiAodmlhIHNlbmRNZXNzYWdlKScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGV4dHJhY3QgQ1NSRiB0b2tlbiBmcm9tIGNvb2tpZSBzdHJpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBTZXQgbXVsdGlwbGUgY29va2llcyBpbmNsdWRpbmcgQ1NSRiB0b2tlblxuICAgICAgKGdsb2JhbC5kb2N1bWVudCBhcyBhbnkpLmNvb2tpZSA9ICdzZXNzaW9uSWQ9YWJjMTIzOyBjc3JmVG9rZW49dGVzdC10b2tlbjsgdXNlcklkPTQ1Nic7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBBUEkga2V5IGNoZWNrXG4gICAgICBtb2NrQXhpb3MuZ2V0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgaXNFbXB0eTogZmFsc2UsXG4gICAgICAgICAgdmFsdWVMZW5ndGg6IDMyXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgY2hhdGJvdCByZXNwb25zZVxuICAgICAgbW9ja0F4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAnUmVzcG9uc2UnIH1cbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBjaGF0Ym90U2VydmljZS5zZW5kTWVzc2FnZShbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICd0ZXN0JyB9XSk7XG5cbiAgICAgIGV4cGVjdChtb2NrQXhpb3MucG9zdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICcvYXBpL2NoYXRib3QnLFxuICAgICAgICB7IG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICd0ZXN0JyB9XSB9LFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdYLUNTUkYtVG9rZW4nOiAndGVzdC10b2tlbidcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIENTUkYgdG9rZW4gZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFNldCBjb29raWVzIHdpdGhvdXQgQ1NSRiB0b2tlblxuICAgICAgKGdsb2JhbC5kb2N1bWVudCBhcyBhbnkpLmNvb2tpZSA9ICdzZXNzaW9uSWQ9YWJjMTIzOyB1c2VySWQ9NDU2JztcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSBrZXkgY2hlY2tcbiAgICAgIG1vY2tBeGlvcy5nZXQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBpc0VtcHR5OiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZUxlbmd0aDogMzJcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjaGF0Ym90IHJlc3BvbnNlXG4gICAgICBtb2NrQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6ICdSZXNwb25zZScgfVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGNoYXRib3RTZXJ2aWNlLnNlbmRNZXNzYWdlKFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dKTtcblxuICAgICAgZXhwZWN0KG1vY2tBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJy9hcGkvY2hhdGJvdCcsXG4gICAgICAgIHsgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ3Rlc3QnIH1dIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsIm1vY2tBeGlvcyIsImdldCIsImZuIiwicG9zdCIsImF4aW9zIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnbG9iYWwiLCJ2YWx1ZSIsImNvb2tpZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid3JpdGFibGUiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiZG9jdW1lbnQiLCJhZnRlckVhY2giLCJyZXNldEFsbE1vY2tzIiwibW9ja01lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJtb2NrUmVzcG9uc2UiLCJpdCIsIm1vY2tSZXNvbHZlZFZhbHVlIiwiZGF0YSIsInN1Y2Nlc3MiLCJpc0VtcHR5IiwidmFsdWVMZW5ndGgiLCJyZXN1bHQiLCJjaGF0Ym90U2VydmljZSIsInNlbmRNZXNzYWdlIiwiZXhwZWN0IiwidG9FcXVhbCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwibWVzc2FnZXMiLCJoZWFkZXJzIiwicmVqZWN0cyIsInRvVGhyb3ciLCJub3QiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwibW9ja1Jlc29sdmVkVmFsdWVPbmNlIiwiY29uZmlnRXJyb3IiLCJFcnJvciIsIm1vY2tSZWplY3RlZFZhbHVlT25jZSIsImF4aW9zRXJyb3IiLCJpc0F4aW9zRXJyb3IiLCJyZXNwb25zZSIsInN0YXR1cyIsImVycm9yIiwidG9KU09OIiwibWVzc2FnZSIsIm1vY2tSZXR1cm5WYWx1ZSIsInJlcXVlc3QiLCJ1bmRlZmluZWQiLCJnZW5lcmljRXJyb3IiLCJlcnJvcldpdGhvdXRNZXNzYWdlIiwiY29uZmlnQXhpb3NFcnJvciIsImJ1c2luZXNzSW5mbyIsImdldEJ1c2luZXNzSW5mbyIsImJ1c2luZXNzTmFtZSIsImludmVudG9yeUNvdW50IiwidG9wU2VsbGluZ1Byb2R1Y3RzIiwiY3VzdG9tZXJDb3VudCIsInN1cHBsaWVyQ291bnQiLCJ0b0hhdmVQcm9wZXJ0eSIsIkFycmF5IiwiaXNBcnJheSIsInRvQmUiLCJleGlzdHMiLCJjaGVja0NvbmZpZ3VyYXRpb24iLCJpc0NvbmZpZ3VyZWQiLCJjb25zb2xlU3B5Iiwic3B5T24iLCJjb25zb2xlIiwibW9ja0ltcGxlbWVudGF0aW9uIiwibW9ja1Jlc3RvcmUiXSwibWFwcGluZ3MiOiI7Ozs7eUJBQWtFOzhEQUNoQztnQ0FDd0I7Ozs7OztBQUUxRCxhQUFhO0FBQ2JBLGFBQUksQ0FBQ0MsSUFBSSxDQUFDO0FBQ1YsTUFBTUMsWUFBWTtJQUNoQkMsS0FBS0gsYUFBSSxDQUFDSSxFQUFFO0lBQ1pDLE1BQU1MLGFBQUksQ0FBQ0ks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