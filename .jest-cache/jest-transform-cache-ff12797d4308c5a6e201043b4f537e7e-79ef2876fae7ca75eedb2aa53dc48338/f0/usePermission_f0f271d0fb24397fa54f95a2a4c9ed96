547aabad25011a89c1a2f9997c400e7e
"use client";
"use strict";

/* istanbul ignore next */
function cov_torxfj5iv() {
  var path = "/Users/sachin/Documents/md-sports-/src/hooks/usePermission.ts";
  var hash = "a0fcc2f0f7f4e74750970dc4c96940e155b54a19";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/sachin/Documents/md-sports-/src/hooks/usePermission.ts",
    statementMap: {
      "0": {
        start: {
          line: 3,
          column: 0
        },
        end: {
          line: 5,
          column: 3
        }
      },
      "1": {
        start: {
          line: 6,
          column: 0
        },
        end: {
          line: 11,
          column: 3
        }
      },
      "2": {
        start: {
          line: 9,
          column: 8
        },
        end: {
          line: 9,
          column: 29
        }
      },
      "3": {
        start: {
          line: 12,
          column: 20
        },
        end: {
          line: 12,
          column: 46
        }
      },
      "4": {
        start: {
          line: 13,
          column: 17
        },
        end: {
          line: 13,
          column: 37
        }
      },
      "5": {
        start: {
          line: 15,
          column: 25
        },
        end: {
          line: 29,
          column: 1
        }
      },
      "6": {
        start: {
          line: 31,
          column: 21
        },
        end: {
          line: 31,
          column: 44
        }
      },
      "7": {
        start: {
          line: 32,
          column: 20
        },
        end: {
          line: 32,
          column: 48
        }
      },
      "8": {
        start: {
          line: 33,
          column: 21
        },
        end: {
          line: 33,
          column: 51
        }
      },
      "9": {
        start: {
          line: 34,
          column: 26
        },
        end: {
          line: 42,
          column: 5
        }
      },
      "10": {
        start: {
          line: 35,
          column: 8
        },
        end: {
          line: 35,
          column: 37
        }
      },
      "11": {
        start: {
          line: 35,
          column: 25
        },
        end: {
          line: 35,
          column: 37
        }
      },
      "12": {
        start: {
          line: 36,
          column: 8
        },
        end: {
          line: 36,
          column: 73
        }
      },
      "13": {
        start: {
          line: 36,
          column: 60
        },
        end: {
          line: 36,
          column: 73
        }
      },
      "14": {
        start: {
          line: 38,
          column: 8
        },
        end: {
          line: 40,
          column: 9
        }
      },
      "15": {
        start: {
          line: 39,
          column: 12
        },
        end: {
          line: 39,
          column: 24
        }
      },
      "16": {
        start: {
          line: 41,
          column: 8
        },
        end: {
          line: 41,
          column: 53
        }
      },
      "17": {
        start: {
          line: 44,
          column: 33
        },
        end: {
          line: 62,
          column: 5
        }
      },
      "18": {
        start: {
          line: 46,
          column: 8
        },
        end: {
          line: 46,
          column: 42
        }
      },
      "19": {
        start: {
          line: 46,
          column: 30
        },
        end: {
          line: 46,
          column: 42
        }
      },
      "20": {
        start: {
          line: 48,
          column: 8
        },
        end: {
          line: 48,
          column: 47
        }
      },
      "21": {
        start: {
          line: 48,
          column: 35
        },
        end: {
          line: 48,
          column: 47
        }
      },
      "22": {
        start: {
          line: 50,
          column: 35
        },
        end: {
          line: 50,
          column: 61
        }
      },
      "23": {
        start: {
          line: 51,
          column: 8
        },
        end: {
          line: 53,
          column: 9
        }
      },
      "24": {
        start: {
          line: 52,
          column: 12
        },
        end: {
          line: 52,
          column: 53
        }
      },
      "25": {
        start: {
          line: 55,
          column: 8
        },
        end: {
          line: 59,
          column: 9
        }
      },
      "26": {
        start: {
          line: 56,
          column: 12
        },
        end: {
          line: 58,
          column: 13
        }
      },
      "27": {
        start: {
          line: 57,
          column: 16
        },
        end: {
          line: 57,
          column: 62
        }
      },
      "28": {
        start: {
          line: 61,
          column: 8
        },
        end: {
          line: 61,
          column: 20
        }
      },
      "29": {
        start: {
          line: 63,
          column: 4
        },
        end: {
          line: 66,
          column: 6
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 8,
            column: 9
          },
          end: {
            line: 8,
            column: 10
          }
        },
        loc: {
          start: {
            line: 8,
            column: 20
          },
          end: {
            line: 10,
            column: 5
          }
        },
        line: 8
      },
      "1": {
        name: "usePermission",
        decl: {
          start: {
            line: 30,
            column: 9
          },
          end: {
            line: 30,
            column: 22
          }
        },
        loc: {
          start: {
            line: 30,
            column: 25
          },
          end: {
            line: 67,
            column: 1
          }
        },
        line: 30
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 34,
            column: 26
          },
          end: {
            line: 34,
            column: 27
          }
        },
        loc: {
          start: {
            line: 34,
            column: 40
          },
          end: {
            line: 42,
            column: 5
          }
        },
        line: 34
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 44,
            column: 33
          },
          end: {
            line: 44,
            column: 34
          }
        },
        loc: {
          start: {
            line: 44,
            column: 37
          },
          end: {
            line: 62,
            column: 5
          }
        },
        line: 44
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 35,
            column: 8
          },
          end: {
            line: 35,
            column: 37
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 35,
            column: 8
          },
          end: {
            line: 35,
            column: 37
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 35
      },
      "1": {
        loc: {
          start: {
            line: 36,
            column: 8
          },
          end: {
            line: 36,
            column: 73
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 36,
            column: 8
          },
          end: {
            line: 36,
            column: 73
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 36
      },
      "2": {
        loc: {
          start: {
            line: 36,
            column: 12
          },
          end: {
            line: 36,
            column: 58
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 36,
            column: 12
          },
          end: {
            line: 36,
            column: 30
          }
        }, {
          start: {
            line: 36,
            column: 34
          },
          end: {
            line: 36,
            column: 58
          }
        }],
        line: 36
      },
      "3": {
        loc: {
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 40,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 40,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 38
      },
      "4": {
        loc: {
          start: {
            line: 38,
            column: 12
          },
          end: {
            line: 38,
            column: 84
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 38,
            column: 12
          },
          end: {
            line: 38,
            column: 42
          }
        }, {
          start: {
            line: 38,
            column: 46
          },
          end: {
            line: 38,
            column: 84
          }
        }],
        line: 38
      },
      "5": {
        loc: {
          start: {
            line: 46,
            column: 8
          },
          end: {
            line: 46,
            column: 42
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 46,
            column: 8
          },
          end: {
            line: 46,
            column: 42
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 46
      },
      "6": {
        loc: {
          start: {
            line: 48,
            column: 8
          },
          end: {
            line: 48,
            column: 47
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 48,
            column: 8
          },
          end: {
            line: 48,
            column: 47
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 48
      },
      "7": {
        loc: {
          start: {
            line: 51,
            column: 8
          },
          end: {
            line: 53,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 51,
            column: 8
          },
          end: {
            line: 53,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 51
      },
      "8": {
        loc: {
          start: {
            line: 56,
            column: 12
          },
          end: {
            line: 58,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 56,
            column: 12
          },
          end: {
            line: 58,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 56
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/Users/sachin/Documents/md-sports-/src/hooks/usePermission.ts"],
      sourcesContent: ["'use client';\n\n\nimport { useRouter, usePathname } from 'next/navigation';\nimport { useAuth } from './useAuth';\n\n// Map routes to required permissions\nconst routePermissions: Record<string, string> = {\n    '/dashboard': 'view_dashboard',  // Require dashboard permission\n    '/inventory': 'inventory:view',  // Full inventory access (blocked for shop staff)\n    '/inventory/transfers': 'inventory:transfer',\n    '/inventory/distribution': 'shop:distribution:view',  // Shop distribution access\n    '/suppliers': 'supplier:view',\n    '/purchases': 'purchase:view',\n    '/quotations': 'quotation:view',\n    '/shops': 'shop:view',\n    '/customers': 'customer:view',\n    '/invoices': 'invoice:view',\n    '/accounting': 'accounting:view',\n    '/reports': 'report:view',\n    '/settings': 'settings:manage',\n};\n\nexport function usePermission() {\n    const { user } = useAuth();\n    const _router = useRouter();\n    const pathname = usePathname();\n\n    const hasPermission = (permission: string): boolean => {\n        if (!permission) return true; // No permission required\n        if (!user?.permissions || !user.permissions.length) return false;\n        \n        // Check for admin permissions first\n        if (user.permissions.includes('*') || user.permissions.includes('admin:all')) {\n            return true;\n        }\n        \n        return user.permissions.includes(permission);\n    };\n\n    // Check if user has permission to access the current route\n    const checkRoutePermission = (): boolean => {\n        // Default to dashboard for root path\n        if (pathname === '/') return true;\n\n        // Login page is always accessible\n        if (pathname === '/login') return true;\n\n        // For exact route matches\n        const requiredPermission = routePermissions[pathname];\n        if (requiredPermission !== undefined) {\n            return hasPermission(requiredPermission);\n        }\n\n        // For routes that don't have an exact match, check parent routes\n        for (const route in routePermissions) {\n            if (pathname.startsWith(route + '/')) {\n                return hasPermission(routePermissions[route]);\n            }\n        }\n\n        // If no matching route found, allow access by default\n        return true;\n    };\n\n    return {\n        hasPermission,\n        checkRoutePermission\n    };\n}"],
      names: ["usePermission", "routePermissions", "user", "useAuth", "_router", "useRouter", "pathname", "usePathname", "hasPermission", "permission", "permissions", "length", "includes", "checkRoutePermission", "requiredPermission", "undefined", "route", "startsWith"],
      mappings: "AAAA;;;;;+BAuBgBA;;;eAAAA;;;4BApBuB;yBACf;AAExB,qCAAqC;AACrC,MAAMC,mBAA2C;IAC7C,cAAc;IACd,cAAc;IACd,wBAAwB;IACxB,2BAA2B;IAC3B,cAAc;IACd,cAAc;IACd,eAAe;IACf,UAAU;IACV,cAAc;IACd,aAAa;IACb,eAAe;IACf,YAAY;IACZ,aAAa;AACjB;AAEO,SAASD;IACZ,MAAM,EAAEE,IAAI,EAAE,GAAGC,IAAAA,gBAAO;IACxB,MAAMC,UAAUC,IAAAA,qBAAS;IACzB,MAAMC,WAAWC,IAAAA,uBAAW;IAE5B,MAAMC,gBAAgB,CAACC;QACnB,IAAI,CAACA,YAAY,OAAO,MAAM,yBAAyB;QACvD,IAAI,CAACP,MAAMQ,eAAe,CAACR,KAAKQ,WAAW,CAACC,MAAM,EAAE,OAAO;QAE3D,oCAAoC;QACpC,IAAIT,KAAKQ,WAAW,CAACE,QAAQ,CAAC,QAAQV,KAAKQ,WAAW,CAACE,QAAQ,CAAC,cAAc;YAC1E,OAAO;QACX;QAEA,OAAOV,KAAKQ,WAAW,CAACE,QAAQ,CAACH;IACrC;IAEA,2DAA2D;IAC3D,MAAMI,uBAAuB;QACzB,qCAAqC;QACrC,IAAIP,aAAa,KAAK,OAAO;QAE7B,kCAAkC;QAClC,IAAIA,aAAa,UAAU,OAAO;QAElC,0BAA0B;QAC1B,MAAMQ,qBAAqBb,gBAAgB,CAACK,SAAS;QACrD,IAAIQ,uBAAuBC,WAAW;YAClC,OAAOP,cAAcM;QACzB;QAEA,iEAAiE;QACjE,IAAK,MAAME,SAASf,iBAAkB;YAClC,IAAIK,SAASW,UAAU,CAACD,QAAQ,MAAM;gBAClC,OAAOR,cAAcP,gBAAgB,CAACe,MAAM;YAChD;QACJ;QAEA,sDAAsD;QACtD,OAAO;IACX;IAEA,OAAO;QACHR;QACAK;IACJ;AACJ"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "a0fcc2f0f7f4e74750970dc4c96940e155b54a19"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_torxfj5iv = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_torxfj5iv();
cov_torxfj5iv().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_torxfj5iv().s[1]++;
Object.defineProperty(exports, "usePermission", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_torxfj5iv().f[0]++;
    cov_torxfj5iv().s[2]++;
    return usePermission;
  }
});
const _navigation =
/* istanbul ignore next */
(cov_torxfj5iv().s[3]++, require("next/navigation"));
const _useAuth =
/* istanbul ignore next */
(cov_torxfj5iv().s[4]++, require("./useAuth"));
// Map routes to required permissions
const routePermissions =
/* istanbul ignore next */
(cov_torxfj5iv().s[5]++, {
  "/dashboard": "view_dashboard",
  "/inventory": "inventory:view",
  "/inventory/transfers": "inventory:transfer",
  "/inventory/distribution": "shop:distribution:view",
  "/suppliers": "supplier:view",
  "/purchases": "purchase:view",
  "/quotations": "quotation:view",
  "/shops": "shop:view",
  "/customers": "customer:view",
  "/invoices": "invoice:view",
  "/accounting": "accounting:view",
  "/reports": "report:view",
  "/settings": "settings:manage"
});
function usePermission() {
  /* istanbul ignore next */
  cov_torxfj5iv().f[1]++;
  const {
    user
  } =
  /* istanbul ignore next */
  (cov_torxfj5iv().s[6]++, (0, _useAuth.useAuth)());
  const _router =
  /* istanbul ignore next */
  (cov_torxfj5iv().s[7]++, (0, _navigation.useRouter)());
  const pathname =
  /* istanbul ignore next */
  (cov_torxfj5iv().s[8]++, (0, _navigation.usePathname)());
  /* istanbul ignore next */
  cov_torxfj5iv().s[9]++;
  const hasPermission = permission => {
    /* istanbul ignore next */
    cov_torxfj5iv().f[2]++;
    cov_torxfj5iv().s[10]++;
    if (!permission) {
      /* istanbul ignore next */
      cov_torxfj5iv().b[0][0]++;
      cov_torxfj5iv().s[11]++;
      return true;
    } else
    /* istanbul ignore next */
    {
      cov_torxfj5iv().b[0][1]++;
    } // No permission required
    cov_torxfj5iv().s[12]++;
    if (
    /* istanbul ignore next */
    (cov_torxfj5iv().b[2][0]++, !user?.permissions) ||
    /* istanbul ignore next */
    (cov_torxfj5iv().b[2][1]++, !user.permissions.length)) {
      /* istanbul ignore next */
      cov_torxfj5iv().b[1][0]++;
      cov_torxfj5iv().s[13]++;
      return false;
    } else
    /* istanbul ignore next */
    {
      cov_torxfj5iv().b[1][1]++;
    }
    // Check for admin permissions first
    cov_torxfj5iv().s[14]++;
    if (
    /* istanbul ignore next */
    (cov_torxfj5iv().b[4][0]++, user.permissions.includes("*")) ||
    /* istanbul ignore next */
    (cov_torxfj5iv().b[4][1]++, user.permissions.includes("admin:all"))) {
      /* istanbul ignore next */
      cov_torxfj5iv().b[3][0]++;
      cov_torxfj5iv().s[15]++;
      return true;
    } else
    /* istanbul ignore next */
    {
      cov_torxfj5iv().b[3][1]++;
    }
    cov_torxfj5iv().s[16]++;
    return user.permissions.includes(permission);
  };
  // Check if user has permission to access the current route
  /* istanbul ignore next */
  cov_torxfj5iv().s[17]++;
  const checkRoutePermission = () => {
    /* istanbul ignore next */
    cov_torxfj5iv().f[3]++;
    cov_torxfj5iv().s[18]++;
    // Default to dashboard for root path
    if (pathname === "/") {
      /* istanbul ignore next */
      cov_torxfj5iv().b[5][0]++;
      cov_torxfj5iv().s[19]++;
      return true;
    } else
    /* istanbul ignore next */
    {
      cov_torxfj5iv().b[5][1]++;
    }
    // Login page is always accessible
    cov_torxfj5iv().s[20]++;
    if (pathname === "/login") {
      /* istanbul ignore next */
      cov_torxfj5iv().b[6][0]++;
      cov_torxfj5iv().s[21]++;
      return true;
    } else
    /* istanbul ignore next */
    {
      cov_torxfj5iv().b[6][1]++;
    }
    // For exact route matches
    const requiredPermission =
    /* istanbul ignore next */
    (cov_torxfj5iv().s[22]++, routePermissions[pathname]);
    /* istanbul ignore next */
    cov_torxfj5iv().s[23]++;
    if (requiredPermission !== undefined) {
      /* istanbul ignore next */
      cov_torxfj5iv().b[7][0]++;
      cov_torxfj5iv().s[24]++;
      return hasPermission(requiredPermission);
    } else
    /* istanbul ignore next */
    {
      cov_torxfj5iv().b[7][1]++;
    }
    // For routes that don't have an exact match, check parent routes
    cov_torxfj5iv().s[25]++;
    for (const route in routePermissions) {
      /* istanbul ignore next */
      cov_torxfj5iv().s[26]++;
      if (pathname.startsWith(route + "/")) {
        /* istanbul ignore next */
        cov_torxfj5iv().b[8][0]++;
        cov_torxfj5iv().s[27]++;
        return hasPermission(routePermissions[route]);
      } else
      /* istanbul ignore next */
      {
        cov_torxfj5iv().b[8][1]++;
      }
    }
    // If no matching route found, allow access by default
    /* istanbul ignore next */
    cov_torxfj5iv().s[28]++;
    return true;
  };
  /* istanbul ignore next */
  cov_torxfj5iv().s[29]++;
  return {
    hasPermission,
    checkRoutePermission
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfdG9yeGZqNWl2IiwiYWN0dWFsQ292ZXJhZ2UiLCJzIiwidXNlUGVybWlzc2lvbiIsInJvdXRlUGVybWlzc2lvbnMiLCJmIiwidXNlciIsIl91c2VBdXRoIiwidXNlQXV0aCIsIl9yb3V0ZXIiLCJfbmF2aWdhdGlvbiIsInVzZVJvdXRlciIsInBhdGhuYW1lIiwidXNlUGF0aG5hbWUiLCJoYXNQZXJtaXNzaW9uIiwicGVybWlzc2lvbiIsImIiLCJwZXJtaXNzaW9ucyIsImxlbmd0aCIsImluY2x1ZGVzIiwiY2hlY2tSb3V0ZVBlcm1pc3Npb24iLCJyZXF1aXJlZFBlcm1pc3Npb24iLCJ1bmRlZmluZWQiLCJyb3V0ZSIsInN0YXJ0c1dpdGgiXSwic291cmNlcyI6WyIvVXNlcnMvc2FjaGluL0RvY3VtZW50cy9tZC1zcG9ydHMtL3NyYy9ob29rcy91c2VQZXJtaXNzaW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2UgY2xpZW50JztcblxuXG5pbXBvcnQgeyB1c2VSb3V0ZXIsIHVzZVBhdGhuYW1lIH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuL3VzZUF1dGgnO1xuXG4vLyBNYXAgcm91dGVzIHRvIHJlcXVpcmVkIHBlcm1pc3Npb25zXG5jb25zdCByb3V0ZVBlcm1pc3Npb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICcvZGFzaGJvYXJkJzogJ3ZpZXdfZGFzaGJvYXJkJywgIC8vIFJlcXVpcmUgZGFzaGJvYXJkIHBlcm1pc3Npb25cbiAgICAnL2ludmVudG9yeSc6ICdpbnZlbnRvcnk6dmlldycsICAvLyBGdWxsIGludmVudG9yeSBhY2Nlc3MgKGJsb2NrZWQgZm9yIHNob3Agc3RhZmYpXG4gICAgJy9pbnZlbnRvcnkvdHJhbnNmZXJzJzogJ2ludmVudG9yeTp0cmFuc2ZlcicsXG4gICAgJy9pbnZlbnRvcnkvZGlzdHJpYnV0aW9uJzogJ3Nob3A6ZGlzdHJpYnV0aW9uOnZpZXcnLCAgLy8gU2hvcCBkaXN0cmlidXRpb24gYWNjZXNzXG4gICAgJy9zdXBwbGllcnMnOiAnc3VwcGxpZXI6dmlldycsXG4gICAgJy9wdXJjaGFzZXMnOiAncHVyY2hhc2U6dmlldycsXG4gICAgJy9xdW90YXRpb25zJzogJ3F1b3RhdGlvbjp2aWV3JyxcbiAgICAnL3Nob3BzJzogJ3Nob3A6dmlldycsXG4gICAgJy9jdXN0b21lcnMnOiAnY3VzdG9tZXI6dmlldycsXG4gICAgJy9pbnZvaWNlcyc6ICdpbnZvaWNlOnZpZXcnLFxuICAgICcvYWNjb3VudGluZyc6ICdhY2NvdW50aW5nOnZpZXcnLFxuICAgICcvcmVwb3J0cyc6ICdyZXBvcnQ6dmlldycsXG4gICAgJy9zZXR0aW5ncyc6ICdzZXR0aW5nczptYW5hZ2UnLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVBlcm1pc3Npb24oKSB7XG4gICAgY29uc3QgeyB1c2VyIH0gPSB1c2VBdXRoKCk7XG4gICAgY29uc3QgX3JvdXRlciA9IHVzZVJvdXRlcigpO1xuICAgIGNvbnN0IHBhdGhuYW1lID0gdXNlUGF0aG5hbWUoKTtcblxuICAgIGNvbnN0IGhhc1Blcm1pc3Npb24gPSAocGVybWlzc2lvbjogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIGlmICghcGVybWlzc2lvbikgcmV0dXJuIHRydWU7IC8vIE5vIHBlcm1pc3Npb24gcmVxdWlyZWRcbiAgICAgICAgaWYgKCF1c2VyPy5wZXJtaXNzaW9ucyB8fCAhdXNlci5wZXJtaXNzaW9ucy5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGZvciBhZG1pbiBwZXJtaXNzaW9ucyBmaXJzdFxuICAgICAgICBpZiAodXNlci5wZXJtaXNzaW9ucy5pbmNsdWRlcygnKicpIHx8IHVzZXIucGVybWlzc2lvbnMuaW5jbHVkZXMoJ2FkbWluOmFsbCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHVzZXIucGVybWlzc2lvbnMuaW5jbHVkZXMocGVybWlzc2lvbik7XG4gICAgfTtcblxuICAgIC8vIENoZWNrIGlmIHVzZXIgaGFzIHBlcm1pc3Npb24gdG8gYWNjZXNzIHRoZSBjdXJyZW50IHJvdXRlXG4gICAgY29uc3QgY2hlY2tSb3V0ZVBlcm1pc3Npb24gPSAoKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIC8vIERlZmF1bHQgdG8gZGFzaGJvYXJkIGZvciByb290IHBhdGhcbiAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnLycpIHJldHVybiB0cnVlO1xuXG4gICAgICAgIC8vIExvZ2luIHBhZ2UgaXMgYWx3YXlzIGFjY2Vzc2libGVcbiAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnL2xvZ2luJykgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgLy8gRm9yIGV4YWN0IHJvdXRlIG1hdGNoZXNcbiAgICAgICAgY29uc3QgcmVxdWlyZWRQZXJtaXNzaW9uID0gcm91dGVQZXJtaXNzaW9uc1twYXRobmFtZV07XG4gICAgICAgIGlmIChyZXF1aXJlZFBlcm1pc3Npb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGhhc1Blcm1pc3Npb24ocmVxdWlyZWRQZXJtaXNzaW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciByb3V0ZXMgdGhhdCBkb24ndCBoYXZlIGFuIGV4YWN0IG1hdGNoLCBjaGVjayBwYXJlbnQgcm91dGVzXG4gICAgICAgIGZvciAoY29uc3Qgcm91dGUgaW4gcm91dGVQZXJtaXNzaW9ucykge1xuICAgICAgICAgICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgocm91dGUgKyAnLycpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhc1Blcm1pc3Npb24ocm91dGVQZXJtaXNzaW9uc1tyb3V0ZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgbm8gbWF0Y2hpbmcgcm91dGUgZm91bmQsIGFsbG93IGFjY2VzcyBieSBkZWZhdWx0XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBoYXNQZXJtaXNzaW9uLFxuICAgICAgICBjaGVja1JvdXRlUGVybWlzc2lvblxuICAgIH07XG59Il0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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