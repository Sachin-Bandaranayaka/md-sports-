d3bd1b580459412f6fc87ade8e825cf0
// Fixed Database connection and configuration tests
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _db = require("../../src/lib/db");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
// Mock Prisma operations
const mockPrismaOperations = {
    findMany: _globals.jest.fn(),
    findUnique: _globals.jest.fn(),
    findFirst: _globals.jest.fn(),
    create: _globals.jest.fn(),
    update: _globals.jest.fn(),
    delete: _globals.jest.fn(),
    count: _globals.jest.fn(),
    aggregate: _globals.jest.fn(),
    upsert: _globals.jest.fn(),
    deleteMany: _globals.jest.fn(),
    updateMany: _globals.jest.fn()
};
const mockPrisma = {
    user: {
        ...mockPrismaOperations
    },
    product: {
        ...mockPrismaOperations
    },
    customer: {
        ...mockPrismaOperations
    },
    invoice: {
        ...mockPrismaOperations
    },
    inventoryItem: {
        ...mockPrismaOperations
    },
    category: {
        ...mockPrismaOperations
    },
    supplier: {
        ...mockPrismaOperations
    },
    purchaseInvoice: {
        ...mockPrismaOperations
    },
    purchaseInvoiceItem: {
        ...mockPrismaOperations
    },
    salesInvoice: {
        ...mockPrismaOperations
    },
    salesInvoiceItem: {
        ...mockPrismaOperations
    },
    $connect: _globals.jest.fn(),
    $disconnect: _globals.jest.fn(),
    $transaction: _globals.jest.fn(),
    $executeRaw: _globals.jest.fn(),
    $queryRaw: _globals.jest.fn(),
    $on: _globals.jest.fn(),
    $use: _globals.jest.fn()
};
// Mock prisma module
_globals.jest.mock("@/lib/prisma", ()=>({
        __esModule: true,
        default: mockPrisma
    }));
// Mock the process.env for database configuration
const originalEnv = process.env;
beforeAll(()=>{
    process.env = {
        ...originalEnv,
        DATABASE_URL: "postgresql://test:test@localhost:5432/test_db",
        NODE_ENV: "test"
    };
});
afterAll(()=>{
    process.env = originalEnv;
});
describe("Database Library", ()=>{
    beforeEach(()=>{
        _globals.jest.clearAllMocks();
    });
    describe("db export", ()=>{
        it("should export db as the prisma client", ()=>{
            expect(_db.db).toBeDefined();
            expect(_db.db).toBe(mockPrisma);
        });
        it("should have user methods", ()=>{
            expect(_db.db.user).toBeDefined();
            expect(_db.db.user.findMany).toBeDefined();
            expect(_db.db.user.findUnique).toBeDefined();
            expect(_db.db.user.create).toBeDefined();
            expect(_db.db.user.update).toBeDefined();
            expect(_db.db.user.delete).toBeDefined();
        });
        it("should have product methods", ()=>{
            expect(_db.db.product).toBeDefined();
            expect(_db.db.product.findMany).toBeDefined();
            expect(_db.db.product.findUnique).toBeDefined();
            expect(_db.db.product.create).toBeDefined();
            expect(_db.db.product.update).toBeDefined();
            expect(_db.db.product.delete).toBeDefined();
        });
        it("should have connection methods", ()=>{
            expect(_db.db.$connect).toBeDefined();
            expect(_db.db.$disconnect).toBeDefined();
            expect(_db.db.$transaction).toBeDefined();
        });
    });
    describe("prisma export", ()=>{
        it("should export prisma as the same client", ()=>{
            expect(_db.prisma).toBeDefined();
            expect(_db.prisma).toBe(mockPrisma);
            expect(_db.prisma).toBe(_db.db);
        });
    });
    describe("default export", ()=>{
        it("should export db as default", async ()=>{
            const defaultExport = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("../../src/lib/db")));
            expect(defaultExport.default).toBeDefined();
            expect(defaultExport.default).toBe(_db.db);
            expect(defaultExport.default).toBe(mockPrisma);
        });
    });
    describe("database operations", ()=>{
        it("should allow user queries", async ()=>{
            const mockUser = {
                id: 1,
                name: "Test User",
                email: "test@example.com"
            };
            mockPrisma.user.findUnique.mockResolvedValue(mockUser);
            const result = await _db.db.user.findUnique({
                where: {
                    id: 1
                }
            });
            expect(result).toEqual(mockUser);
            expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({
                where: {
                    id: 1
                }
            });
        });
        it("should allow product queries", async ()=>{
            const mockProduct = {
                id: "product1",
                name: "Test Product"
            };
            mockPrisma.product.findUnique.mockResolvedValue(mockProduct);
            const result = await _db.db.product.findUnique({
                where: {
                    id: "product1"
                }
            });
            expect(result).toEqual(mockProduct);
            expect(mockPrisma.product.findUnique).toHaveBeenCalledWith({
                where: {
                    id: "product1"
                }
            });
        });
        it("should allow transactions", async ()=>{
            const mockResult = {
                success: true
            };
            mockPrisma.$transaction.mockResolvedValue(mockResult);
            const transactionFn = _globals.jest.fn().mockResolvedValue(mockResult);
            const result = await _db.db.$transaction(transactionFn);
            expect(result).toEqual(mockResult);
            expect(mockPrisma.$transaction).toHaveBeenCalledWith(transactionFn);
        });
        it("should handle connection operations", async ()=>{
            mockPrisma.$connect.mockResolvedValue(undefined);
            mockPrisma.$disconnect.mockResolvedValue(undefined);
            await _db.db.$connect();
            await _db.db.$disconnect();
            expect(mockPrisma.$connect).toHaveBeenCalled();
            expect(mockPrisma.$disconnect).toHaveBeenCalled();
        });
    });
    describe("error handling", ()=>{
        beforeEach(()=>{
            _globals.jest.clearAllMocks();
        });
        it("should handle connection errors", async ()=>{
            mockPrisma.$connect.mockRejectedValue(new Error("Database connection failed"));
            await expect(_db.db.$connect()).rejects.toThrow("Database connection failed");
        });
        it("should handle query errors", async ()=>{
            mockPrisma.user.findUnique.mockRejectedValue(new Error("Query failed"));
            await expect(_db.db.user.findUnique({
                where: {
                    id: "invalid"
                }
            })).rejects.toThrow("Query failed");
        });
        it("should propagate transaction errors", async ()=>{
            mockPrisma.$transaction.mockRejectedValue(new Error("Transaction failed"));
            const transactionFn = _globals.jest.fn();
            await expect(_db.db.$transaction(transactionFn)).rejects.toThrow("Transaction failed");
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWNoaW4vRG9jdW1lbnRzL21kLXNwb3J0cy0vdGVzdHMvdW5pdC9kYi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEZpeGVkIERhdGFiYXNlIGNvbm5lY3Rpb24gYW5kIGNvbmZpZ3VyYXRpb24gdGVzdHNcblxuaW1wb3J0IHsgamVzdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuXG4vLyBNb2NrIFByaXNtYSBvcGVyYXRpb25zXG5jb25zdCBtb2NrUHJpc21hT3BlcmF0aW9ucyA9IHtcbiAgZmluZE1hbnk6IGplc3QuZm4oKSxcbiAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICBmaW5kRmlyc3Q6IGplc3QuZm4oKSxcbiAgY3JlYXRlOiBqZXN0LmZuKCksXG4gIHVwZGF0ZTogamVzdC5mbigpLFxuICBkZWxldGU6IGplc3QuZm4oKSxcbiAgY291bnQ6IGplc3QuZm4oKSxcbiAgYWdncmVnYXRlOiBqZXN0LmZuKCksXG4gIHVwc2VydDogamVzdC5mbigpLFxuICBkZWxldGVNYW55OiBqZXN0LmZuKCksXG4gIHVwZGF0ZU1hbnk6IGplc3QuZm4oKSxcbn07XG5cbmNvbnN0IG1vY2tQcmlzbWEgPSB7XG4gIHVzZXI6IHsgLi4ubW9ja1ByaXNtYU9wZXJhdGlvbnMgfSxcbiAgcHJvZHVjdDogeyAuLi5tb2NrUHJpc21hT3BlcmF0aW9ucyB9LFxuICBjdXN0b21lcjogeyAuLi5tb2NrUHJpc21hT3BlcmF0aW9ucyB9LFxuICBpbnZvaWNlOiB7IC4uLm1vY2tQcmlzbWFPcGVyYXRpb25zIH0sXG4gIGludmVudG9yeUl0ZW06IHsgLi4ubW9ja1ByaXNtYU9wZXJhdGlvbnMgfSxcbiAgY2F0ZWdvcnk6IHsgLi4ubW9ja1ByaXNtYU9wZXJhdGlvbnMgfSxcbiAgc3VwcGxpZXI6IHsgLi4ubW9ja1ByaXNtYU9wZXJhdGlvbnMgfSxcbiAgcHVyY2hhc2VJbnZvaWNlOiB7IC4uLm1vY2tQcmlzbWFPcGVyYXRpb25zIH0sXG4gIHB1cmNoYXNlSW52b2ljZUl0ZW06IHsgLi4ubW9ja1ByaXNtYU9wZXJhdGlvbnMgfSxcbiAgc2FsZXNJbnZvaWNlOiB7IC4uLm1vY2tQcmlzbWFPcGVyYXRpb25zIH0sXG4gIHNhbGVzSW52b2ljZUl0ZW06IHsgLi4ubW9ja1ByaXNtYU9wZXJhdGlvbnMgfSxcbiAgJGNvbm5lY3Q6IGplc3QuZm4oKSxcbiAgJGRpc2Nvbm5lY3Q6IGplc3QuZm4oKSxcbiAgJHRyYW5zYWN0aW9uOiBqZXN0LmZuKCksXG4gICRleGVjdXRlUmF3OiBqZXN0LmZuKCksXG4gICRxdWVyeVJhdzogamVzdC5mbigpLFxuICAkb246IGplc3QuZm4oKSxcbiAgJHVzZTogamVzdC5mbigpLFxufTtcblxuLy8gTW9jayBwcmlzbWEgbW9kdWxlXG5qZXN0Lm1vY2soJ0AvbGliL3ByaXNtYScsICgpID0+ICh7XG4gIF9fZXNNb2R1bGU6IHRydWUsXG4gIGRlZmF1bHQ6IG1vY2tQcmlzbWEsXG59KSk7XG5cbi8vIE1vY2sgdGhlIHByb2Nlc3MuZW52IGZvciBkYXRhYmFzZSBjb25maWd1cmF0aW9uXG5jb25zdCBvcmlnaW5hbEVudiA9IHByb2Nlc3MuZW52O1xuYmVmb3JlQWxsKCgpID0+IHtcbiAgcHJvY2Vzcy5lbnYgPSB7XG4gICAgLi4ub3JpZ2luYWxFbnYsXG4gICAgREFUQUJBU0VfVVJMOiAncG9zdGdyZXNxbDovL3Rlc3Q6dGVzdEBsb2NhbGhvc3Q6NTQzMi90ZXN0X2RiJyxcbiAgICBOT0RFX0VOVjogJ3Rlc3QnLFxuICB9O1xufSk7XG5cbmFmdGVyQWxsKCgpID0+IHtcbiAgcHJvY2Vzcy5lbnYgPSBvcmlnaW5hbEVudjtcbn0pO1xuXG5pbXBvcnQgeyBkYiwgcHJpc21hIH0gZnJvbSAnQC9saWIvZGInO1xuXG5kZXNjcmliZSgnRGF0YWJhc2UgTGlicmFyeScsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkYiBleHBvcnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBleHBvcnQgZGIgYXMgdGhlIHByaXNtYSBjbGllbnQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZGIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIpLnRvQmUobW9ja1ByaXNtYSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgdXNlciBtZXRob2RzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGRiLnVzZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIudXNlci5maW5kTWFueSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChkYi51c2VyLmZpbmRVbmlxdWUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIudXNlci5jcmVhdGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIudXNlci51cGRhdGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIudXNlci5kZWxldGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvZHVjdCBtZXRob2RzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGRiLnByb2R1Y3QpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIucHJvZHVjdC5maW5kTWFueSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChkYi5wcm9kdWN0LmZpbmRVbmlxdWUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIucHJvZHVjdC5jcmVhdGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIucHJvZHVjdC51cGRhdGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGIucHJvZHVjdC5kZWxldGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgY29ubmVjdGlvbiBtZXRob2RzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGRiLiRjb25uZWN0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGRiLiRkaXNjb25uZWN0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGRiLiR0cmFuc2FjdGlvbikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3ByaXNtYSBleHBvcnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBleHBvcnQgcHJpc21hIGFzIHRoZSBzYW1lIGNsaWVudCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChwcmlzbWEpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocHJpc21hKS50b0JlKG1vY2tQcmlzbWEpO1xuICAgICAgZXhwZWN0KHByaXNtYSkudG9CZShkYik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkZWZhdWx0IGV4cG9ydCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGV4cG9ydCBkYiBhcyBkZWZhdWx0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVmYXVsdEV4cG9ydCA9IGF3YWl0IGltcG9ydCgnQC9saWIvZGInKTtcbiAgICAgIGV4cGVjdChkZWZhdWx0RXhwb3J0LmRlZmF1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGVmYXVsdEV4cG9ydC5kZWZhdWx0KS50b0JlKGRiKTtcbiAgICAgIGV4cGVjdChkZWZhdWx0RXhwb3J0LmRlZmF1bHQpLnRvQmUobW9ja1ByaXNtYSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkYXRhYmFzZSBvcGVyYXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgdXNlciBxdWVyaWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IGlkOiAxLCBuYW1lOiAnVGVzdCBVc2VyJywgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyB9O1xuICAgICAgbW9ja1ByaXNtYS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogMSB9IH0pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVc2VyKTtcbiAgICAgIGV4cGVjdChtb2NrUHJpc21hLnVzZXIuZmluZFVuaXF1ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyB3aGVyZTogeyBpZDogMSB9IH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBwcm9kdWN0IHF1ZXJpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZHVjdCA9IHsgaWQ6ICdwcm9kdWN0MScsIG5hbWU6ICdUZXN0IFByb2R1Y3QnIH07XG4gICAgICBtb2NrUHJpc21hLnByb2R1Y3QuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZHVjdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiAncHJvZHVjdDEnIH0gfSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Byb2R1Y3QpO1xuICAgICAgZXhwZWN0KG1vY2tQcmlzbWEucHJvZHVjdC5maW5kVW5pcXVlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IHdoZXJlOiB7IGlkOiAncHJvZHVjdDEnIH0gfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHRyYW5zYWN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICAgIG1vY2tQcmlzbWEuJHRyYW5zYWN0aW9uLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuXG4gICAgICBjb25zdCB0cmFuc2FjdGlvbkZuID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uRm4pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tSZXN1bHQpO1xuICAgICAgZXhwZWN0KG1vY2tQcmlzbWEuJHRyYW5zYWN0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh0cmFuc2FjdGlvbkZuKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbm5lY3Rpb24gb3BlcmF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tQcmlzbWEuJGNvbm5lY3QubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgIG1vY2tQcmlzbWEuJGRpc2Nvbm5lY3QubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgYXdhaXQgZGIuJGNvbm5lY3QoKTtcbiAgICAgIGF3YWl0IGRiLiRkaXNjb25uZWN0KCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtb2NrUHJpc21hLiRjb25uZWN0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1ByaXNtYS4kZGlzY29ubmVjdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZXJyb3IgaGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbm5lY3Rpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1ByaXNtYS4kY29ubmVjdC5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJykpO1xuICAgICAgXG4gICAgICBhd2FpdCBleHBlY3QoZGIuJGNvbm5lY3QoKSkucmVqZWN0cy50b1Rocm93KCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcXVlcnkgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1ByaXNtYS51c2VyLmZpbmRVbmlxdWUubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdRdWVyeSBmYWlsZWQnKSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChkYi51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogJ2ludmFsaWQnIH0gfSkpLnJlamVjdHMudG9UaHJvdygnUXVlcnkgZmFpbGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3BhZ2F0ZSB0cmFuc2FjdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUHJpc21hLiR0cmFuc2FjdGlvbi5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1RyYW5zYWN0aW9uIGZhaWxlZCcpKTtcblxuICAgICAgY29uc3QgdHJhbnNhY3Rpb25GbiA9IGplc3QuZm4oKTtcbiAgICAgIGF3YWl0IGV4cGVjdChkYi4kdHJhbnNhY3Rpb24odHJhbnNhY3Rpb25GbikpLnJlamVjdHMudG9UaHJvdygnVHJhbnNhY3Rpb24gZmFpbGVkJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm5hbWVzIjpbIm1vY2tQcmlzbWFPcGVyYXRpb25zIiwiZmluZE1hbnkiLCJqZXN0IiwiZm4iLCJmaW5kVW5pcXVlIiwiZmluZEZpcnN0IiwiY3JlYXRlIiwidXBkYXRlIiwiZGVsZXRlIiwiY291bnQiLCJhZ2dyZWdhdGUiLCJ1cHNlcnQiLCJkZWxldGVNYW55IiwidXBkYXRlTWFueSIsIm1vY2tQcmlzbWEiLCJ1c2VyIiwicHJvZHVjdCIsImN1c3RvbWVyIiwiaW52b2ljZSIsImludmVudG9yeUl0ZW0iLCJjYXRlZ29yeSIsInN1cHBsaWVyIiwicHVyY2hhc2VJbnZvaWNlIiwicHVyY2hhc2VJbnZvaWNlSXRlbSIsInNhbGVzSW52b2ljZSIsInNhbGVzSW52b2ljZUl0ZW0iLCIkY29ubmVjdCIsIiRkaXNjb25uZWN0IiwiJHRyYW5zYWN0aW9uIiwiJGV4ZWN1dGVSYXciLCIkcXVlcnlSYXciLCIkb24iLCIkdXNlIiwibW9jayIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0Iiwib3JpZ2luYWxFbnYiLCJwcm9jZXNzIiwiZW52IiwiYmVmb3JlQWxsIiwiREFUQUJBU0VfVVJMIiwiTk9ERV9FTlYiLCJhZnRlckFsbCIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsImV4cGVjdCIsImRiIiwidG9CZURlZmluZWQiLCJ0b0JlIiwicHJpc21hIiwiZGVmYXVsdEV4cG9ydCIsIm1vY2tVc2VyIiwiaWQiLCJuYW1lIiwiZW1haWwiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInJlc3VsdCIsIndoZXJlIiwidG9FcXVhbCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwibW9ja1Byb2R1Y3QiLCJtb2NrUmVzdWx0Iiwic3VjY2VzcyIsInRyYW5zYWN0aW9uRm4iLCJ1bmRlZmluZWQiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciIsInJlamVjdHMiLCJ0b1Rocm93Il0sIm1hcHBpbmdzIjoiQUFBQSxvREFBb0Q7Ozs7O3lCQUUvQjtvQkEwRE07Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXhEM0IseUJBQXlCO0FBQ3pCLE1BQU1BLHVCQUF1QjtJQUMzQkMsVUFBVUMsYUFBSSxDQUFDQyxFQUFFO0lBQ2pCQyxZQUFZRixhQUFJLENBQUNDLEVBQUU7SUFDbkJFLFdBQVdILGFBQUksQ0FBQ0MsRUFBRTtJQUNsQkcsUUFBUUosYUFBSSxDQUFDQyxFQUFFO0lBQ2ZJLFFBQVFMLGFBQUksQ0FBQ0MsRUFBRTtJQUNmSyxRQUFRTixhQUFJLENBQUNDLEVBQUU7SUFDZk0sT0FBT1AsYUFBSSxDQUFDQyxFQUFFO0lBQ2RPLFdBQVdSLGFBQUksQ0FBQ0MsRUFBRTtJQUNsQlEsUUFBUVQsYUFBSSxDQUFDQyxFQUFFO0lBQ2ZTLFlBQVlWLGFBQUksQ0FBQ0MsRUFB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