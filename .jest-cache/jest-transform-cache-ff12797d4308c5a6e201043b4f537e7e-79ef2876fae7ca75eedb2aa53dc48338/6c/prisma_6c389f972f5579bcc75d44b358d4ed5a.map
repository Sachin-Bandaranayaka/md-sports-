{"version":3,"names":["default","cov_27lr75ggfo","f","s","_default","prisma","safeQuery","globalForPrisma","global","prismaOptions","datasources","db","url","process","env","DATABASE_URL","b","log","NODE_ENV","errorFormat","console","substring","_client","PrismaClient","queryFn","fallback","logMessage","error"],"sources":["/Users/sachin/Documents/md-sports-/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\n// Use a single instance of Prisma Client across the entire app\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\n// Optimized connection options for Vercel serverless\nconst prismaOptions = {\n    datasources: {\n        db: {\n            url: process.env.DATABASE_URL ? \n                `${process.env.DATABASE_URL}?connection_limit=1&pool_timeout=900&connect_timeout=900&prepared_statement_cache_size=0` :\n                'postgresql://localhost:5432/mssport',\n        },\n    },\n    // Optimized logging for production\n    log: process.env.NODE_ENV === 'production' ? ['error'] : ['error', 'warn'],\n    errorFormat: 'minimal' as const,\n};\n\nconsole.log('Initializing Prisma client with DATABASE_URL:',\n    process.env.DATABASE_URL ?\n        `${process.env.DATABASE_URL.substring(0, 20)}...` :\n        'Not set (using default)'\n);\n\n// Create the Prisma client instance or reuse the existing one\nexport const prisma = globalForPrisma.prisma || new PrismaClient(prismaOptions);\n\n// For development, save the instance to avoid too many client instances\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n\n// Helper function to safely execute database operations with fallback\nexport async function safeQuery<T>(\n    queryFn: () => Promise<T>,\n    fallback: T,\n    logMessage = 'Database operation failed'\n): Promise<T> {\n    try {\n        return await queryFn();\n    } catch (error) {\n        console.error(`${logMessage}:`, error);\n        return fallback;\n    }\n}\n\nexport default prisma;"],"mappings":"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","ignoreList":[]}