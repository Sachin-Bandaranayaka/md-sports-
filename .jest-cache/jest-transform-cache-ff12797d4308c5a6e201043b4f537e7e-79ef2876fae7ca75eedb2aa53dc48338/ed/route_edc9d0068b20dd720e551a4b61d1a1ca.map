{"version":3,"names":["DELETE","cov_39x6d23tp","f","s","GET","PUT","request","params","id","purchaseId","parseInt","isNaN","b","_server","NextResponse","json","error","message","status","purchase","_prisma","default","purchaseInvoice","findUnique","where","include","supplier","items","product","console","details","Error","body","originalPurchase","newItemsData","distributions","newDistributionsData","invoiceData","_","createdAt","updatedAt","notes","dirtyData","cleanedInvoiceData","invoiceNumber","date","Date","dueDate","undefined","totalAmount","total","Number","supplierId","connect","disconnect","result","$transaction","tx","inventoryUpdates","length","oldItem","productToUpdate","productId","oldItemDistribution","Array","isArray","indexOf","Object","keys","shopIdStr","quantityInShop","entries","shopId","qtyToRemove","inventory","inventoryItem","findFirst","oldShopQuantity","quantity","newQuantity","Math","max","update","data","shopSpecificCost","push","oldQuantity","warn","existingInventoriesForOldItem","findMany","shopIdToReverseFrom","log","currentTotalProductQuantity","allInventoryForProductAfterReversal","reduce","sum","inv","remainingPurchaseItems","purchaseInvoiceItem","purchaseInvoiceId","not","totalRemainingQuantity","totalRemainingValue","forEach","purchaseItem","price","newWAC","weightedAverageCost","deleteMany","newTotalInvoiceAmount","item","updatedInvoice","i","newItem","create","newItemDistribution","itemQuantityTotal","qtyToAdd","finalQuantity","oldInvQty","newShopSpecificCostValue","itemPrice","oldShopTotalValue","valueOfThisBatch","existingInventoryItems","targetShopId","allPurchaseItems","totalPurchaseQuantity","totalPurchaseValue","newWeightedAverageCost","fullUpdatedInvoice","timeout","_cache1","cacheService","invalidateInventory","del","invalidatePattern","cacheError","_cache","revalidateTag","revalidatePath","revalidateError","String","purchaseIdStr","purchaseToDelete","quantityToRemoveForItemTotal","itemDistributionInfo","distributionsOnInvoice","distData","distributedQuantityStr","qtyInShopToRemove","newShopQuantity","updateData","existingInventoriesForItem","singleShopInventory","shopIdToDeductFrom","updateDataInferred","pItem","newCalculatedWAC","delete","deletedInvoiceId"],"sources":["/Users/sachin/Documents/md-sports-/src/app/api/purchases/[id]/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { revalidateTag, revalidatePath } from 'next/cache';\nimport prisma from '@/lib/prisma';\nimport { PrismaClientKnownRequestError } from '@prisma/client/runtime/library';\nimport { getToken } from 'next-auth/jwt';\nimport { cacheService } from '@/lib/cache';\n\n// GET /api/purchases/[id] - Get a specific purchase invoice\nexport async function GET(\n    request: NextRequest,\n    { params }: { params: { id: string } }\n) {\n    const id = params.id; // Store params.id early to avoid async issues\n    try {\n        const purchaseId = parseInt(id);\n\n        if (isNaN(purchaseId)) {\n            return NextResponse.json(\n                { error: { message: 'Invalid purchase ID format' } },\n                { status: 400 }\n            );\n        }\n\n        const purchase = await prisma.purchaseInvoice.findUnique({\n            where: {\n                id: purchaseId\n            },\n            include: {\n                supplier: true,\n                items: {\n                    include: {\n                        product: true\n                    }\n                }\n            }\n        });\n\n        if (!purchase) {\n            return NextResponse.json(\n                { error: { message: 'Purchase invoice not found' } },\n                { status: 404 }\n            );\n        }\n\n        return NextResponse.json(purchase);\n    } catch (error) {\n        console.error(`Error fetching purchase invoice ${id}:`, error);\n        const details = error instanceof Error ? error.message : 'An unknown error occurred';\n        return NextResponse.json(\n            { error: { message: 'Failed to fetch purchase invoice', details: details } },\n            { status: 500 }\n        );\n    }\n}\n\n// PUT /api/purchases/[id] - Update a purchase invoice\nexport async function PUT(\n    request: NextRequest,\n    { params }: { params: { id: string } }\n) {\n    const id = params.id;\n    try {\n        const purchaseId = parseInt(id);\n        if (isNaN(purchaseId)) {\n            return NextResponse.json(\n                { error: { message: 'Invalid purchase ID format' } },\n                { status: 400 });\n        }\n        const body = await request.json();\n        const originalPurchase = await prisma.purchaseInvoice.findUnique({\n            where: { id: purchaseId },\n            include: { items: { include: { product: true } } },\n        });\n        if (!originalPurchase) {\n            return NextResponse.json(\n                { error: { message: 'Purchase invoice not found to update' } },\n                { status: 404 });\n        }\n        const { items: newItemsData, distributions: newDistributionsData, ...invoiceData } = body;\n        const { id: _, createdAt, updatedAt, supplier, notes, ...dirtyData } = invoiceData;\n        const cleanedInvoiceData: any = {};\n        if (dirtyData.invoiceNumber) cleanedInvoiceData.invoiceNumber = dirtyData.invoiceNumber;\n        if (dirtyData.status) cleanedInvoiceData.status = dirtyData.status;\n        if (dirtyData.date) cleanedInvoiceData.date = new Date(dirtyData.date);\n        if (dirtyData.dueDate !== undefined) cleanedInvoiceData.dueDate = dirtyData.dueDate ? new Date(dirtyData.dueDate) : null;\n        if (dirtyData.totalAmount !== undefined) cleanedInvoiceData.total = Number(dirtyData.totalAmount);\n        else if (dirtyData.total !== undefined) cleanedInvoiceData.total = Number(dirtyData.total);\n        cleanedInvoiceData.distributions = newDistributionsData !== undefined ? newDistributionsData : originalPurchase.distributions;\n        if (dirtyData.supplierId) cleanedInvoiceData.supplier = { connect: { id: Number(dirtyData.supplierId) } };\n        else if (dirtyData.supplierId === null && originalPurchase.supplierId) cleanedInvoiceData.supplier = { disconnect: true };\n\n        const result = await prisma.$transaction(async (tx) => {\n            const inventoryUpdates: Array<{ productId: number, shopId: number, newQuantity: number, oldQuantity?: number }> = [];\n\n            if (originalPurchase.items && originalPurchase.items.length > 0) {\n                for (const oldItem of originalPurchase.items) {\n                    const productToUpdate = await tx.product.findUnique({ where: { id: oldItem.productId } });\n                    if (!productToUpdate) continue;\n\n                    const oldItemDistribution = originalPurchase.distributions && Array.isArray(originalPurchase.distributions) && originalPurchase.items.indexOf(oldItem) < originalPurchase.distributions.length\n                        ? originalPurchase.distributions[originalPurchase.items.indexOf(oldItem)]\n                        : (originalPurchase.distributions && typeof originalPurchase.distributions === 'object' && !Array.isArray(originalPurchase.distributions) ? originalPurchase.distributions : null);\n\n                    if (oldItemDistribution && Object.keys(oldItemDistribution).length > 0) {\n                        for (const [shopIdStr, quantityInShop] of Object.entries(oldItemDistribution as any)) {\n                            const shopId = shopIdStr;\n                            const qtyToRemove = Number(quantityInShop);\n                            if (qtyToRemove <= 0 || isNaN(qtyToRemove)) continue;\n                            const inventory = await tx.inventoryItem.findFirst({ where: { productId: oldItem.productId, shopId: shopId } });\n                            if (inventory) {\n                                const oldShopQuantity = inventory.quantity;\n                                const newQuantity = Math.max(0, inventory.quantity - qtyToRemove);\n                                await tx.inventoryItem.update({\n                                    where: { id: inventory.id },\n                                    data: {\n                                        quantity: newQuantity,\n                                        // If new quantity is 0, reset shopSpecificCost, else keep existing\n                                        shopSpecificCost: newQuantity === 0 ? 0 : inventory.shopSpecificCost\n                                    }\n                                });\n                                inventoryUpdates.push({ productId: oldItem.productId, shopId: Number(shopId), newQuantity, oldQuantity: oldShopQuantity });\n                            }\n                        }\n                    } else {\n                        // oldItemDistribution is missing. Attempt to infer shop for stock reversal.\n                        console.warn(`Old item ${oldItem.productId} in purchase ${purchaseId} has no distribution. Attempting to infer shop for stock reversal.`);\n                        const existingInventoriesForOldItem = await tx.inventoryItem.findMany({\n                            where: { productId: oldItem.productId }\n                        });\n                        if (existingInventoriesForOldItem.length === 1) {\n                            const shopIdToReverseFrom = existingInventoriesForOldItem[0].shopId;\n                            const inventory = existingInventoriesForOldItem[0]; // Already fetched\n                            const oldShopQuantity = inventory.quantity;\n                            const newQuantity = Math.max(0, inventory.quantity - oldItem.quantity); // Use total oldItem.quantity\n                            await tx.inventoryItem.update({\n                                where: { id: inventory.id },\n                                data: {\n                                    quantity: newQuantity,\n                                    // If new quantity is 0, reset shopSpecificCost, else keep existing\n                                    shopSpecificCost: newQuantity === 0 ? 0 : inventory.shopSpecificCost\n                                }\n                            });\n                            inventoryUpdates.push({ productId: oldItem.productId, shopId: Number(shopIdToReverseFrom), newQuantity, oldQuantity: oldShopQuantity });\n                            console.log(`Reversed ${oldItem.quantity} from product ${oldItem.productId} in inferred shop ${shopIdToReverseFrom}.`);\n                        } else if (existingInventoriesForOldItem.length === 0) {\n                            console.error(`Old item ${oldItem.productId} not found in any inventory. Cannot reverse stock for this item line from a specific shop.`);\n                        } else { // Multiple shops\n                            console.error(`Old item ${oldItem.productId} exists in multiple shops and no specific distribution for reversal. Ambiguous. Stock not reversed from a specific shop for this item line.`);\n                        }\n                    }\n\n                    let currentTotalProductQuantity = 0;\n                    const allInventoryForProductAfterReversal = await tx.inventoryItem.findMany({ where: { productId: oldItem.productId } });\n                    currentTotalProductQuantity = allInventoryForProductAfterReversal.reduce((sum, inv) => sum + inv.quantity, 0);\n\n                    // Recalculate WAC based on remaining purchase history after removing this item\n                    const remainingPurchaseItems = await tx.purchaseInvoiceItem.findMany({\n                        where: {\n                            productId: oldItem.productId,\n                            purchaseInvoiceId: { not: purchaseId } // Exclude current invoice being updated\n                        }\n                    });\n\n                    let totalRemainingQuantity = 0;\n                    let totalRemainingValue = 0;\n\n                    remainingPurchaseItems.forEach(purchaseItem => {\n                        totalRemainingQuantity += purchaseItem.quantity;\n                        totalRemainingValue += purchaseItem.quantity * purchaseItem.price;\n                    });\n\n                    let newWAC = 0;\n                    if (totalRemainingQuantity > 0) {\n                        newWAC = totalRemainingValue / totalRemainingQuantity;\n                    }\n\n                    await tx.product.update({\n                        where: { id: oldItem.productId },\n                        data: { weightedAverageCost: newWAC >= 0 ? newWAC : 0 }\n                    });\n                }\n            }\n\n            await tx.purchaseInvoiceItem.deleteMany({ where: { purchaseInvoiceId: purchaseId } });\n\n            // Recalculate totalAmount for the invoice based on new/updated items\n            let newTotalInvoiceAmount = 0;\n            if (newItemsData && Array.isArray(newItemsData)) {\n                newItemsData.forEach(item => {\n                    newTotalInvoiceAmount += Number(item.quantity) * Number(item.price || 0);\n                });\n            }\n            cleanedInvoiceData.total = newTotalInvoiceAmount; // Ensure this is assigned to the correct field for DB update\n\n            const updatedInvoice = await tx.purchaseInvoice.update({ where: { id: purchaseId }, data: cleanedInvoiceData });\n\n            if (newItemsData && Array.isArray(newItemsData)) {\n                for (let i = 0; i < newItemsData.length; i++) {\n                    const newItem = newItemsData[i];\n                    if (!newItem.productId || !newItem.quantity || newItem.quantity <= 0) continue;\n                    await tx.purchaseInvoiceItem.create({\n                        data: {\n                            purchaseInvoiceId: purchaseId, productId: Number(newItem.productId),\n                            quantity: Number(newItem.quantity), price: Number(newItem.price || 0),\n                            total: Number(newItem.quantity) * Number(newItem.price || 0)\n                        }\n                    });\n                    const productToUpdate = await tx.product.findUnique({ where: { id: Number(newItem.productId) } });\n                    if (!productToUpdate) continue;\n\n                    const newItemDistribution = newDistributionsData && Array.isArray(newDistributionsData) && newDistributionsData[i]\n                        ? newDistributionsData[i]\n                        : (newDistributionsData && typeof newDistributionsData === 'object' && !Array.isArray(newDistributionsData) ? newDistributionsData : null);\n\n                    const itemQuantityTotal = Number(newItem.quantity);\n\n                    if (newItemDistribution && Object.keys(newItemDistribution).length > 0) {\n                        for (const [shopIdStr, quantityInShop] of Object.entries(newItemDistribution as any)) {\n                            const shopId = shopIdStr;\n                            const qtyToAdd = Number(quantityInShop);\n                            if (qtyToAdd <= 0 || isNaN(qtyToAdd)) continue;\n\n                            const inventory = await tx.inventoryItem.findFirst({ where: { productId: Number(newItem.productId), shopId: shopId } });\n                            let finalQuantity = 0;\n                            const oldInvQty = inventory?.quantity || 0;\n                            let newShopSpecificCostValue = 0;\n                            const itemPrice = Number(newItem.price || 0);\n\n                            if (inventory) {\n                                finalQuantity = inventory.quantity + qtyToAdd;\n                                const oldShopTotalValue = (inventory.quantity || 0) * (inventory.shopSpecificCost || 0);\n                                const valueOfThisBatch = qtyToAdd * itemPrice;\n                                if (finalQuantity > 0) {\n                                    newShopSpecificCostValue = (oldShopTotalValue + valueOfThisBatch) / finalQuantity;\n                                } else {\n                                    newShopSpecificCostValue = 0;\n                                }\n                                await tx.inventoryItem.update({\n                                    where: { id: inventory.id },\n                                    data: { quantity: finalQuantity, shopSpecificCost: newShopSpecificCostValue >= 0 ? newShopSpecificCostValue : 0 }\n                                });\n                            } else {\n                                finalQuantity = qtyToAdd;\n                                newShopSpecificCostValue = itemPrice;\n                                await tx.inventoryItem.create({\n                                    data: {\n                                        productId: Number(newItem.productId),\n                                        shopId: shopId,\n                                        quantity: finalQuantity,\n                                        shopSpecificCost: newShopSpecificCostValue >= 0 ? newShopSpecificCostValue : 0\n                                    }\n                                });\n                            }\n                            inventoryUpdates.push({ productId: Number(newItem.productId), shopId: Number(shopId), newQuantity: finalQuantity, oldQuantity: oldInvQty });\n                        }\n                    } else {\n                        // newItemDistribution is missing or empty. Try to infer shop or log error.\n                        console.warn(`Purchase item with productId ${newItem.productId} in invoice ${purchaseId} does not have explicit shop distribution data. Attempting to infer target shop.`);\n                        const existingInventoryItems = await tx.inventoryItem.findMany({\n                            where: { productId: Number(newItem.productId) }\n                        });\n\n                        let targetShopId: string | null = null;\n\n                        if (existingInventoryItems.length === 1) {\n                            targetShopId = existingInventoryItems[0].shopId;\n                            console.log(`Product ${newItem.productId} exists in one shop (${targetShopId}). Attributing new stock there.`);\n                        } else if (existingInventoryItems.length === 0) {\n                            console.error(`Product ${newItem.productId} is new to inventory and no shop distribution provided. Cannot automatically assign to a shop. Inventory not updated for this item.`);\n                        } else { // existingInventoryItems.length > 1\n                            console.error(`Product ${newItem.productId} exists in multiple shops and no specific distribution provided. Ambiguous. Inventory not updated for this item.`);\n                        }\n\n                        if (targetShopId) {\n                            const qtyToAdd = itemQuantityTotal; // The total quantity for this newItem.\n                            if (qtyToAdd > 0) {\n                                const inventory = await tx.inventoryItem.findFirst({ where: { productId: Number(newItem.productId), shopId: targetShopId } });\n                                let finalQuantity = 0;\n                                const oldInvQty = inventory?.quantity || 0;\n                                let newShopSpecificCostValue = 0;\n                                const itemPrice = Number(newItem.price || 0);\n\n                                if (inventory) {\n                                    finalQuantity = inventory.quantity + qtyToAdd;\n                                    const oldShopTotalValue = (inventory.quantity || 0) * (inventory.shopSpecificCost || 0);\n                                    const valueOfThisBatch = qtyToAdd * itemPrice;\n                                    if (finalQuantity > 0) {\n                                        newShopSpecificCostValue = (oldShopTotalValue + valueOfThisBatch) / finalQuantity;\n                                    } else {\n                                        newShopSpecificCostValue = 0;\n                                    }\n                                    await tx.inventoryItem.update({\n                                        where: { id: inventory.id },\n                                        data: { quantity: finalQuantity, shopSpecificCost: newShopSpecificCostValue >= 0 ? newShopSpecificCostValue : 0 }\n                                    });\n                                } else {\n                                    finalQuantity = qtyToAdd;\n                                    newShopSpecificCostValue = itemPrice;\n                                    console.warn(`InventoryItem for product ${newItem.productId} in targetShopId ${targetShopId} not found during update, attempting create.`);\n                                    await tx.inventoryItem.create({\n                                        data: {\n                                            productId: Number(newItem.productId),\n                                            shopId: targetShopId,\n                                            quantity: finalQuantity,\n                                            shopSpecificCost: newShopSpecificCostValue >= 0 ? newShopSpecificCostValue : 0\n                                        }\n                                    });\n                                }\n                                inventoryUpdates.push({ productId: Number(newItem.productId), shopId: Number(targetShopId), newQuantity: finalQuantity, oldQuantity: oldInvQty });\n                            } else {\n                                console.warn(`Quantity for product ${newItem.productId} is zero or negative. No inventory update performed for this item.`);\n                            }\n                        }\n                    }\n\n                    // Recalculate WAC based on all purchase history for this product\n                    // This ensures accuracy regardless of update order\n                    const allPurchaseItems = await tx.purchaseInvoiceItem.findMany({\n                        where: { productId: Number(newItem.productId) }\n                    });\n\n                    let totalPurchaseQuantity = 0;\n                    let totalPurchaseValue = 0;\n\n                    allPurchaseItems.forEach(purchaseItem => {\n                        totalPurchaseQuantity += purchaseItem.quantity;\n                        totalPurchaseValue += purchaseItem.quantity * purchaseItem.price;\n                    });\n\n                    let newWeightedAverageCost = 0;\n                    if (totalPurchaseQuantity > 0) {\n                        newWeightedAverageCost = totalPurchaseValue / totalPurchaseQuantity;\n                    }\n\n                    // Ensure WAC is valid\n                    if (newWeightedAverageCost <= 0 || isNaN(newWeightedAverageCost)) {\n                        newWeightedAverageCost = Number(newItem.price);\n                    }\n\n                    await tx.product.update({\n                        where: { id: Number(newItem.productId) },\n                        data: { weightedAverageCost: newWeightedAverageCost }\n                    });\n                }\n            }\n            const fullUpdatedInvoice = await tx.purchaseInvoice.findUnique({\n                where: { id: purchaseId },\n                include: { supplier: true, items: { include: { product: true } } }\n            });\n            return { fullUpdatedInvoice, inventoryUpdates };\n        }, { timeout: 30000 });\n\n        // Real-time updates now handled by polling system\n        if (result && result.fullUpdatedInvoice) {\n            console.log('Purchase invoice updated successfully');\n        }\n\n        // After successful transaction, invalidate relevant caches\n        try {\n            await cacheService.invalidateInventory(); // Handles 'inventory:summary:*' and 'products:*'\n            await cacheService.del('dashboard:inventory');\n            await cacheService.del('dashboard:inventory-value');\n            await cacheService.del('dashboard:shops');\n            await cacheService.del('dashboard:all');\n            await cacheService.del('dashboard:summary');\n            // Invalidate purchases-specific caches\n            await cacheService.invalidatePattern('purchases-optimized*');\n            await cacheService.invalidatePattern('purchase-stats*');\n            console.log('Relevant caches invalidated after purchase update.');\n        } catch (cacheError) {\n            console.error('Error invalidating caches after purchase update:', cacheError);\n            // Do not let cache invalidation error fail the main operation\n        }\n\n        // Revalidate Next.js cached pages\n        try {\n            revalidateTag('purchase-invoices');\n            revalidateTag(`purchase-${purchaseId}`);\n            revalidatePath(`/purchases/${purchaseId}`);\n            revalidatePath(`/purchases/${purchaseId}/edit`);\n            revalidatePath('/purchases');\n            console.log('Next.js pages revalidated after purchase update.');\n        } catch (revalidateError) {\n            console.error('Error revalidating Next.js pages after purchase update:', revalidateError);\n        }\n\n        return NextResponse.json({\n            message: 'Purchase invoice updated successfully',\n            data: result.fullUpdatedInvoice\n        });\n    } catch (error) {\n        console.error(`Error updating purchase invoice ${id}:`, error);\n        const details = error instanceof Error ? error.message : String(error);\n        return NextResponse.json(\n            { error: { message: 'Failed to update purchase invoice', details: details } },\n            { status: 500 });\n    }\n}\n\n// DELETE /api/purchases/[id] - Delete a purchase invoice\nexport async function DELETE(\n    request: NextRequest,\n    { params }: { params: { id: string } }\n) {\n    const purchaseIdStr = params.id;\n    try {\n        const purchaseId = parseInt(purchaseIdStr);\n        if (isNaN(purchaseId)) {\n            return NextResponse.json(\n                { error: { message: 'Invalid purchase ID format' } },\n                { status: 400 });\n        }\n\n        const purchaseToDelete = await prisma.purchaseInvoice.findUnique({\n            where: { id: purchaseId },\n            include: {\n                items: { include: { product: true } },\n                // Ensure 'distributions' is included if it's a relation,\n                // or directly accessible if it's a JSON field on PurchaseInvoice\n            },\n        });\n\n        if (!purchaseToDelete) {\n            return NextResponse.json(\n                { error: { message: 'Purchase invoice not found to delete' } },\n                { status: 404 });\n        }\n\n        const result = await prisma.$transaction(async (tx) => {\n            const inventoryUpdates: Array<{ productId: number, shopId: number, newQuantity: number, oldQuantity?: number }> = [];\n\n            if (purchaseToDelete.items && purchaseToDelete.items.length > 0) {\n                for (const item of purchaseToDelete.items) {\n                    if (!item.product) {\n                        console.warn(`Item ${item.id} for purchase ${purchaseId} is missing product data. Skipping stock adjustment.`);\n                        continue;\n                    }\n\n                    const productId = item.productId;\n                    const quantityToRemoveForItemTotal = item.quantity; // Total quantity for this item line\n\n                    let itemDistributionInfo: { [shopId: string]: number } | null = null;\n                    const distributionsOnInvoice = (purchaseToDelete as any).distributions;\n\n                    // Attempt to get specific distribution for this item\n                    if (\n                        distributionsOnInvoice &&\n                        Array.isArray(distributionsOnInvoice) &&\n                        purchaseToDelete.items.indexOf(item) < distributionsOnInvoice.length\n                    ) {\n                        const distData = distributionsOnInvoice[purchaseToDelete.items.indexOf(item)];\n                        if (distData && typeof distData === 'object' && Object.keys(distData).length > 0) {\n                            itemDistributionInfo = distData as { [shopId: string]: number };\n                        }\n                    }\n\n                    if (itemDistributionInfo) {\n                        // Case 1: Explicit distribution data found for the item\n                        console.log(`Reversing item-specific distribution for product ${productId}, purchase ${purchaseId}`);\n                        for (const [shopIdStr, distributedQuantityStr] of Object.entries(itemDistributionInfo)) {\n                            const shopId = shopIdStr;\n                            const qtyInShopToRemove = Number(distributedQuantityStr);\n\n                            if (isNaN(qtyInShopToRemove) || qtyInShopToRemove <= 0) continue;\n\n                            const inventoryItem = await tx.inventoryItem.findFirst({ where: { productId, shopId: shopId } });\n                            if (inventoryItem) {\n                                const oldShopQuantity = inventoryItem.quantity;\n                                const newShopQuantity = Math.max(0, inventoryItem.quantity - qtyInShopToRemove);\n                                const updateData = {\n                                    quantity: newShopQuantity,\n                                    shopSpecificCost: newShopQuantity === 0 ? 0 : inventoryItem.shopSpecificCost\n                                };\n                                await tx.inventoryItem.update({\n                                    where: { id: inventoryItem.id },\n                                    data: updateData,\n                                });\n                                inventoryUpdates.push({ productId, shopId: Number(shopId), newQuantity: newShopQuantity, oldQuantity: oldShopQuantity });\n                                console.log(`  - Reduced inventory for product ${productId} in shop ${shopId} by ${qtyInShopToRemove}. Old: ${oldShopQuantity}, New: ${newShopQuantity}`);\n                            } else {\n                                console.warn(`  - Inventory item not found for product ${productId} in shop ${shopId} during purchase deletion with explicit distribution. Stock may be inaccurate.`);\n                            }\n                        }\n                    } else {\n                        // Case 2: No explicit distribution for this item. Attempt to infer.\n                        console.warn(`No specific distribution found for item ${productId} in deleted purchase ${purchaseId}. Attempting to infer shop(s) for stock reversal of total quantity ${quantityToRemoveForItemTotal}.`);\n                        const existingInventoriesForItem = await tx.inventoryItem.findMany({\n                            where: { productId: productId }\n                        });\n\n                        if (existingInventoriesForItem.length === 1) {\n                            const singleShopInventory = existingInventoriesForItem[0];\n                            const shopIdToDeductFrom = singleShopInventory.shopId;\n\n                            console.log(`Product ${productId} found in single shop ${shopIdToDeductFrom}. Deducting total item quantity ${quantityToRemoveForItemTotal}.`);\n                            const oldShopQuantity = singleShopInventory.quantity;\n                            const newShopQuantity = Math.max(0, singleShopInventory.quantity - quantityToRemoveForItemTotal);\n                            const updateDataInferred = {\n                                quantity: newShopQuantity,\n                                shopSpecificCost: newShopQuantity === 0 ? 0 : singleShopInventory.shopSpecificCost\n                            };\n                            await tx.inventoryItem.update({\n                                where: { id: singleShopInventory.id },\n                                data: updateDataInferred,\n                            });\n                            inventoryUpdates.push({ productId, shopId: Number(shopIdToDeductFrom), newQuantity: newShopQuantity, oldQuantity: oldShopQuantity });\n                            console.log(`  - Reduced inventory for product ${productId} in inferred shop ${shopIdToDeductFrom} by ${quantityToRemoveForItemTotal}. Old: ${oldShopQuantity}, New: ${newShopQuantity}`);\n                        } else if (existingInventoriesForItem.length === 0) {\n                            console.error(`Product ${productId} (from deleted purchase ${purchaseId}) not found in any inventory. Cannot reverse stock for this item.`);\n                        } else { // Product exists in multiple shops\n                            console.error(`Product ${productId} (from deleted purchase ${purchaseId}) exists in multiple shops, but no specific distribution data was found on the invoice for reversal. Ambiguous. Stock not automatically reversed for this item. Manual adjustment may be needed.`);\n                        }\n                    }\n\n                    // ---- BEGIN WAC Recalculation for the deleted item ----\n                    const remainingPurchaseItems = await tx.purchaseInvoiceItem.findMany({\n                        where: {\n                            productId: productId,\n                            purchaseInvoiceId: { not: purchaseId }\n                        }\n                    });\n\n                    let totalRemainingQuantity = 0;\n                    let totalRemainingValue = 0;\n                    remainingPurchaseItems.forEach(pItem => {\n                        totalRemainingQuantity += pItem.quantity;\n                        totalRemainingValue += pItem.quantity * pItem.price;\n                    });\n\n                    let newCalculatedWAC = 0;\n                    if (totalRemainingQuantity > 0) {\n                        newCalculatedWAC = totalRemainingValue / totalRemainingQuantity;\n                    }\n                    await tx.product.update({\n                        where: { id: productId },\n                        data: { weightedAverageCost: newCalculatedWAC >= 0 ? newCalculatedWAC : 0 }\n                    });\n                    // ---- END WAC Recalculation ----\n                }\n            }\n\n            await tx.purchaseInvoiceItem.deleteMany({ where: { purchaseInvoiceId: purchaseId } });\n            await tx.purchaseInvoice.delete({ where: { id: purchaseId } });\n\n            return { deletedInvoiceId: purchaseId, inventoryUpdates };\n        });\n\n        // Real-time updates now handled by polling system\n        if (result && result.deletedInvoiceId) {\n            console.log(`Purchase invoice ${result.deletedInvoiceId} deleted successfully`);\n        }\n\n        // After successful transaction, invalidate relevant caches\n        try {\n            await cacheService.invalidateInventory(); // Handles 'inventory:summary:*' and 'products:*'\n            await cacheService.del('dashboard:inventory');\n            await cacheService.del('dashboard:inventory-value');\n            await cacheService.del('dashboard:shops');\n            await cacheService.del('dashboard:all');\n            await cacheService.del('dashboard:summary');\n            // Invalidate purchases-specific caches\n            await cacheService.invalidatePattern('purchases-optimized*');\n            await cacheService.invalidatePattern('purchase-stats*');\n            console.log('Relevant caches invalidated after purchase deletion.');\n        } catch (cacheError) {\n            console.error('Error invalidating caches after purchase deletion:', cacheError);\n            // Do not let cache invalidation error fail the main operation\n        }\n\n        // Revalidate Next.js cached pages\n        try {\n            revalidateTag('purchase-invoices');\n            revalidateTag(`purchase-${purchaseId}`);\n            revalidatePath(`/purchases/${purchaseId}`);\n            revalidatePath(`/purchases/${purchaseId}/edit`);\n            revalidatePath('/purchases');\n            console.log('Next.js pages revalidated after purchase deletion.');\n        } catch (revalidateError) {\n            console.error('Error revalidating Next.js pages after purchase deletion:', revalidateError);\n        }\n\n        return NextResponse.json({ message: 'Purchase invoice deleted successfully' });\n\n    } catch (error) {\n        console.error(`Error deleting purchase invoice ${purchaseIdStr}:`, error);\n        const details = error instanceof Error ? error.message : 'An unknown error occurred';\n        return NextResponse.json(\n            { error: { message: 'Failed to delete purchase invoice', details: details } },\n            { status: 500 });\n    }\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}